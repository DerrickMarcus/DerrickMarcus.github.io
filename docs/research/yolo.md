# YOLO

Official Site: <https://docs.ultralytics.com>

YOLOï¼ˆYou Only Look Onceï¼‰æ˜¯ç›®æ ‡æ£€æµ‹é¢†åŸŸæœ€æµè¡Œçš„æ¨¡å‹ç³»åˆ—ã€‚YOLO ç³»åˆ—çš„æ¨¡å‹æ˜¯åŸºäº CNN çš„ï¼Œä½†å®ƒåœ¨ CNN çš„æœ«ç«¯æ·»åŠ äº†ç‰¹å®šçš„æ£€æµ‹å¤´ï¼ˆDetection Headï¼‰æ¥è¾“å‡ºè¾¹ç•Œæ¡†ã€ç±»åˆ«å’Œç½®ä¿¡åº¦ï¼Œè€Œæ™®é€šçš„ CNN é€šå¸¸åªè¾“å‡ºåˆ†ç±»æ¦‚ç‡æˆ–åˆ†å‰²å›¾ã€‚ä¸åŒç‰ˆæœ¬çš„ YOLO åœ¨ç½‘ç»œç»“æ„ä¸Šå„æœ‰ä¸åŒï¼Œä½†æ˜¯éƒ½ç»§æ‰¿äº†ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š

1. å•é˜¶æ®µï¼ˆOne-Stageï¼‰ï¼šå®šä½å’Œåˆ†ç±»åŒæ­¥å®Œæˆã€‚å®ƒç›´æ¥åœ¨ç‰¹å¾å›¾ä¸Šå›å½’è¾¹ç•Œæ¡†ã€ç›®æ ‡ç½®ä¿¡åº¦å’Œç±»åˆ«æ¦‚ç‡ï¼Œæ¨ç†é€Ÿåº¦æå¿«ã€‚
2. åˆ’åˆ†ç½‘æ ¼ï¼šå°†è¾“å…¥å›¾åƒåˆ’åˆ†ä¸º $S \times S$ çš„ç½‘æ ¼ã€‚å¦‚æœä¸€ä¸ªç›®æ ‡çš„ä¸­å¿ƒè½å…¥æŸä¸ªç½‘æ ¼ï¼Œè¯¥ç½‘æ ¼å°±è´Ÿè´£é¢„æµ‹è¯¥ç›®æ ‡ã€‚
3. ç«¯åˆ°ç«¯ï¼ˆEnd-to-Endï¼‰ã€‚æ•´ä¸ªç½‘ç»œä½œä¸ºä¸€ä¸ªå•ä¸€çš„å®ä½“è¿›è¡Œè®­ç»ƒï¼Œç›´æ¥ä¼˜åŒ–æœ€ç»ˆçš„æ£€æµ‹æ€§èƒ½ã€‚

| ç‰¹æ€§     | æ™®é€š CNN                                 | YOLO                                                         |
| -------- | ---------------------------------------- | ------------------------------------------------------------ |
| ç›®æ ‡     | åˆ†ç±»                                     | ç›®æ ‡æ£€æµ‹                                                     |
| è¾“å‡º     | æœ€ç»ˆè¾“å‡ºæ˜¯ä¸€ä¸ªå›ºå®šé•¿åº¦çš„å‘é‡ï¼ˆç±»åˆ«æ¦‚ç‡ï¼‰ | æœ€ç»ˆè¾“å‡ºæ˜¯ä¸€ä¸ªé«˜ç»´å¼ é‡ï¼ŒåŒ…å«è¾¹ç•Œæ¡†åæ ‡ $(x, y, w, h)$ ã€ç½®ä¿¡åº¦åˆ†æ•°å’Œç±»åˆ«æ¦‚ç‡ã€‚ |
| ç©ºé—´ä¿¡æ¯ | åœ¨å…¨è¿æ¥å±‚ä¸­ä¸¢å¤±äº†å¤§éƒ¨åˆ†ç©ºé—´ä¿¡æ¯         | å¿…é¡»ä¿ç•™ç©ºé—´ä¿¡æ¯ï¼Œåˆ©ç”¨ç‰¹å¾å›¾ä¸Šçš„æ¯ä¸ªåƒç´ ï¼ˆæˆ–ç½‘æ ¼ï¼‰æ¥é¢„æµ‹ç›®æ ‡ã€‚ |
| æŸå¤±å‡½æ•° | äº¤å‰ç†µæŸå¤±ï¼ˆCross-Entropy Lossï¼‰         | å¤æ‚çš„å¤šä»»åŠ¡æŸå¤±ï¼ˆMulti-task Lossï¼‰ï¼šåŒ…å«åˆ†ç±»æŸå¤±ã€å®šä½æŸå¤±ï¼ˆå¦‚ IoU Loss, G-IoUï¼‰å’Œç½®ä¿¡åº¦æŸå¤±ã€‚ |

ç®€å•æ¥è¯´ï¼ŒYOLO å°±æ˜¯åœ¨ CNN Backbone çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡å¤æ‚çš„ Neck ç»“æ„è¿›è¡Œå¤šå°ºåº¦ç‰¹å¾èåˆï¼Œå¹¶ä½¿ç”¨ç‹¬ç‰¹çš„ Head ç»“æ„å’Œå¤šä»»åŠ¡æŸå¤±å‡½æ•°ï¼Œå°† CNN ä»ä¸€ä¸ªåˆ†ç±»å™¨è½¬å˜ä¸ºä¸€ä¸ªé«˜æ•ˆã€ç«¯åˆ°ç«¯çš„ç›®æ ‡æ£€æµ‹å™¨ã€‚

---

YOLO çš„æ•´ä½“ç»“æ„åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š

1. Backbone ä»è¾“å…¥å›¾åƒä¸­æå–å…³é”®ç‰¹å¾ã€‚
2. Neck èåˆå’Œèšåˆæ¥è‡ª Backbone çš„ä¸åŒå±‚çº§çš„ç‰¹å¾ã€‚
3. Head å¯¹èåˆåçš„ç‰¹å¾è¿›è¡Œæœ€ç»ˆçš„è¾¹ç•Œæ¡†å’Œç±»åˆ«é¢„æµ‹ã€‚

YOLOv7

(1)è®¾è®¡å¤šç§å¯è®­ç»ƒçš„æ— ä»£ä»·æå‡æ–¹æ³•ï¼Œåœ¨ä¸å¢åŠ æ¨ç†æˆæœ¬å‰æä¸‹æ˜¾è‘—æå‡å®æ—¶ç›®æ ‡æ£€æµ‹ç²¾åº¦ï¼›

(2)é’ˆå¯¹ç›®æ ‡æ£€æµ‹æ–¹æ³•æ¼”è¿›ï¼Œå‘ç°ä¸¤ä¸ªæ–°é—®é¢˜â€”â€”é‡å‚æ•°åŒ–æ¨¡å—å¦‚ä½•æ›¿ä»£åŸå§‹æ¨¡å—ï¼Œä»¥åŠåŠ¨æ€æ ‡ç­¾åˆ†é…ç­–ç•¥å¦‚ä½•å¤„ç†ä¸åŒè¾“å‡ºå±‚çš„åˆ†é…é—®é¢˜ï¼Œå¹¶æå‡ºç›¸åº”è§£å†³æ–¹æ¡ˆï¼›

(3)ä¸ºå®æ—¶ç›®æ ‡æ£€æµ‹å™¨æå‡º"æ‰©å±•"ä¸"å¤åˆç¼©æ”¾"æ–¹æ³•ï¼Œèƒ½æœ‰æ•ˆåˆ©ç”¨å‚æ•°ä¸è®¡ç®—èµ„æºï¼›

(4)æ‰€ææ–¹æ³•å¯å‡å°‘é¡¶å°–å®æ—¶ç›®æ ‡æ£€æµ‹å™¨çº¦40%å‚æ•°é‡ä¸50%è®¡ç®—é‡ï¼ŒåŒæ—¶è·å¾—æ›´å¿«çš„æ¨ç†é€Ÿåº¦ä¸æ›´é«˜çš„æ£€æµ‹ç²¾åº¦ã€‚

## Traing on Custom Dataset

ç›®æ ‡ï¼šä½¿ç”¨å®˜æ–¹æä¾›çš„ yolo12n.pt ï¼ˆåœ¨ MS COCO æ•°æ®é›†ä¸Šè®­ç»ƒï¼‰é¢„è®­ç»ƒæƒé‡ï¼Œåœ¨ä»¥ä¸‹å‡ ä¸ªæ•°æ®é›†ä¸Šåšå¾®è°ƒï¼ŒæœŸæœ›èƒ½å¤Ÿåœ¨æš—é»‘ç¯å¢ƒä¸­å®ç°æ›´å¥½çš„æ£€æµ‹æ•ˆæœï¼š

1. å¤œé—´è¡Œäººï¼š<https://www.nightowls-dataset.org/>
2. æ¬§æ´²åŸå¸‚è¡Œäººï¼š<https://eurocity-dataset.tudelft.nl/> ï¼Œå…·æœ‰ day/night æ ‡è®°ã€‚
3. UC Berkeley çš„ BDD100Kï¼š<http://bdd-data.berkeley.edu/download.html> ï¼Œå¯è¿‡æ»¤å‡ºå« person å›¾ç‰‡å’Œå¤œé—´å›¾ç‰‡ã€‚

é¦–å…ˆï¼Œéœ€è¦ä¸‹è½½æ•°æ®é›†ï¼Œå¹¶æŒ‰ç…§ YOLO æ ¼å¼è¿›è¡Œæ ‡æ³¨ã€‚

### YOLO Dataset Format

å…ˆè¯´å¸¸è§çš„ MS COCO æ ¼å¼ï¼ŒCOCO æ ¼å¼æ˜¯å°†æ‰€æœ‰å›¾ç‰‡å’Œæ ‡æ³¨ä¿¡æ¯å­˜å‚¨åœ¨ä¸€ä¸ª JSON æ–‡ä»¶ä¸­ï¼Œå›¾ç‰‡æ–‡ä»¶å­˜æ”¾åœ¨å•ç‹¬çš„ç›®å½•ä¸­ï¼Œä¾‹å¦‚ï¼š

```json
{
    "info": {
        "description": "My Custom Dataset",
        "url": "http://example.com",
        "version": "1.0",
        "year": 2025,
        "contributor": "Gemini",
        "date_created": "2025/11/19"
    },
    "licenses": [
        {
            "url": "http://creativecommons.org/licenses/by/2.0/",
            "id": 1,
            "name": "Attribution-NonCommercial-ShareAlike License"
        }
    ],
    "images": [
        {
            "id": 1,
            "license": 1,
            "file_name": "000001.jpg",
            "height": 480,
            "width": 640,
            "date_captured": "2025-11-19 12:00:00"
        },
        {
            "id": 2,
            "license": 1,
            "file_name": "000002.jpg",
            "height": 720,
            "width": 1280,
            "date_captured": "2025-11-19 12:05:00"
        }
    ],
    "categories": [
        {
            "supercategory": "animal",
            "id": 1,
            "name": "cat"
        },
        {
            "supercategory": "animal",
            "id": 2,
            "name": "dog"
        }
    ],
    "annotations": [
        {
            "id": 101,
            "image_id": 1,
            "category_id": 1,
            "segmentation": [
                [100.0, 100.0, 150.0, 100.0, 150.0, 150.0, 100.0, 150.0]
            ],
            "area": 2500.0,
            "bbox": [100.0, 100.0, 50.0, 50.0],
            "iscrowd": 0
        },
        {
            "id": 102,
            "image_id": 1,
            "category_id": 2,
            "segmentation": [
                [200.0, 200.0, 250.0, 200.0, 250.0, 250.0, 200.0, 250.0]
            ],
            "area": 2500.0,
            "bbox": [200.0, 200.0, 50.0, 50.0],
            "iscrowd": 0
        }
    ]
}
```

ä¸ COCO æ ¼å¼ä¸åŒï¼ŒYOLO æ ¼å¼æ˜¯å°†æ¯å¼ å›¾ç‰‡çš„æ ‡æ³¨ä¿¡æ¯å­˜å‚¨åœ¨ä¸€ä¸ªåŒåçš„ `.txt` æ–‡ä»¶ä¸­ï¼Œæœ€åé€šè¿‡ä¸€ä¸ª YAML æ–‡ä»¶æè¿°ç±»åˆ«ã€è®­ç»ƒé›†æµ‹è¯•é›†è·¯å¾„ç­‰ä¿¡æ¯ã€‚

å›¾ç‰‡ä¸æ ‡æ³¨æ–‡ä»¶ä¸€ä¸€å¯¹åº”ï¼Œä¾‹å¦‚ï¼š

1. `images/train/0001.jpg`
2. `labels/train/0001.txt`

æ ‡æ³¨æ–‡ä»¶ä¸­ï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªè¾¹ç•Œæ¡†ï¼Œæ ¼å¼ä¸º `class_id, x_center, y_center, width, height` ï¼Œå…¶ä¸­åæ ‡å‡ä¸ºç›¸å¯¹äºå›¾ç‰‡å®½é«˜çš„å½’ä¸€åŒ–å€¼ï¼Œæµ®ç‚¹æ•°ï¼Œå–å€¼èŒƒå›´ä¸º `[0, 1]` ã€‚ä¾‹å¦‚ï¼š

```text
0 0.512 0.433 0.300 0.400
2 0.215 0.600 0.100 0.150
```

YAML æ–‡ä»¶ä¸­ï¼Œå®šä¹‰ç±»åˆ«åç§°å’Œæ•°æ®é›†è·¯å¾„ï¼Œä¾‹å¦‚ï¼š

```yaml
# Ultralytics ğŸš€ AGPL-3.0 License - https://ultralytics.com/license

# COCO8 dataset (first 8 images from COCO train2017) by Ultralytics
# Documentation: https://docs.ultralytics.com/datasets/detect/coco8/
# Example usage: yolo train data=coco8.yaml
# parent
# â”œâ”€â”€ ultralytics
# â””â”€â”€ datasets
#     â””â”€â”€ coco8 â† downloads here (1 MB)

# Train/val/test sets as 1) dir: path/to/imgs, 2) file: path/to/imgs.txt, or 3) list: [path/to/imgs1, path/to/imgs2, ..]
path: coco8 # dataset root dir
train: images/train # train images (relative to 'path') 4 images
val: images/val # val images (relative to 'path') 4 images
test: # test images (optional)

# Classes
names:
  0: person
  1: bicycle
  2: car
  ......

# Download script/URL (optional)
download: https://github.com/ultralytics/assets/releases/download/v0.0.0/coco8.zip
```

YOLO çº¦å®šï¼Œå›¾ç‰‡å­˜æ”¾çš„ç›®å½• `images/` å’Œæ ‡æ³¨æ–‡ä»¶å­˜æ”¾çš„ç›®å½• `labels/` åœ¨åŒä¸€çº§ç›®å½•ä¸­ï¼Œå› æ­¤åœ¨ YAML æ–‡ä»¶ä¸­åªéœ€æŒ‡å®šå›¾ç‰‡ç›®å½• `images/train` å’Œ `images/val` å³å¯ï¼ŒYOLO ä¼šè‡ªåŠ¨å¯»æ‰¾å¯¹åº”çš„ `labels/train` å’Œ `labels/val` ç›®å½•ã€‚

![20251117165712](https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251117165712.png)
