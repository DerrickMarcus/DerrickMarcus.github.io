# 第四章 频域图像增强

图像变换：

(1) 可分离变换：傅里叶变换 FT，快速傅里叶变换 FFT，沃尔什(Walsh)变换，哈达玛(Hadamard)变换，离散余弦变换 DCT，哈尔(Haar)变换。

(2) 统计变换：霍特林变换，特征值变换，离散 KL 变换。

滤除高频、保留低频：消除噪声、平滑。

滤除低频、保留高频：获得边缘、增强。

频域增强与空域增强的关系：

1. 图像频谱给出图像全局的特性，所以频域增强不是对逐个像素进行。
2. 空域增强中无论使用点操作还是模板操作，每次都只是基于图像中部分像素进行的。
3. 在硬件实现上，如果两个域内滤波器具有相同尺寸，借助快速傅里叶变换在频域进行滤波一般效率更高。但是，在空域常可以使用较小的滤波器来取得与在频域使用较大滤波器相似的滤波效果，计算量也有可能反而小。

频域增强主要步骤：

1. 计算所需增强图像的傅里叶变换。
2. 与一个根据需要设计的滤波器函数相乘。
3. 将获得的结果进行傅里叶反变换，得到增强的图像。

## 4.1 傅里叶变换

对于 $M\times N$ 二维图像：

$$
F(u,v)=\frac{1}{MN}\sum_{x=0}^{M-1}\sum_{y=0}^{N-1}f(x,y)\exp\left[-\mathrm{j} 2\pi (\frac{ux}{M}+\frac{vy}{N})\right]
$$

对于 $N\times N$ 二维图像：

$$
F(u,v)=\frac{1}{N}\sum_{x=0}^{N-1}\sum_{y=0}^{N-1}f(x,y)\exp\left(-\mathrm{j} 2\pi \frac{ux+vy}{N}\right)
$$

1个 2-D 变换核可分解成2个 1-D 变换核，对应 x 和 y 两个方向：

$$
\frac{1}{N} \exp\left(-\mathrm{j} 2\pi \frac{ux+vy}{N}\right) = \frac{1}{\sqrt{N}} \exp\left(-\mathrm{j} 2\pi \frac{ux}{N}\right) \cdot \frac{1}{\sqrt{N}} \exp\left(-\mathrm{j} 2\pi \frac{vy}{N}\right)
$$

平移定理： $f(x-a,y-b)\iff F(u,v)\exp(-\mathrm{j}2\pi \dfrac{au+bv}{N})$ 。

旋转定理：$f(x,y)$ 旋转角度 $\theta_0$ ，$F(u,v)$ 也转过相同角度。$F(u,v)$ 旋转角度 $\theta_0$ ，$f(x,y)$ 也转过相同角度。

尺度定理：$f(ax,by)\iff \dfrac{1}{|ab|}F(\dfrac{u}{a},\dfrac{v}{b})$ 。

卷积定理：$f(x,y)*g(x,y)\iff F(u,v)G(u,v),f(x,y)g(x,y)\iff F(u,v)*G(u,v)$ 。

普通 FT 的计算复杂度为 $N^2$ ，FFT 的复杂度为 $N\log_2 N$ ，当 $N$ 较大时，FFT 可节省可观的计算量。

!!! example
    大圆经 FT 之后，其圆环小；而小圆经 FT 之后，其圆环反而大。因为越尖锐变换越剧烈的信号总包含着更多的频率成分。可类比《信号与系统》中傅里叶变换，时域缩小则频域扩展，时域扩展则频域缩小。

## 4.2 低通和高通滤波

低通滤波：模糊图像中的边缘，滤除高频噪声，平滑图像。

理想低通滤波器硬件无法实现，但是对于软件层面的图像处理可以实现。截止频率越低，滤除噪声越彻底，高频分量损失越严重，图像越模糊。

理想低通滤波器存在**振铃效应**。2-D 图像上表现为一系列同心圆环，圆环半径反比于截断频率。

物理可实现的低通滤波器：巴特沃斯滤波器、切比雪夫滤波器等。令 $d$ 为到中心点坐标的距离，$D_0$ 为截止频率：

对于 n 阶巴特沃斯低通滤波器，表达式为：

$$
H(d)=\frac{1}{1+\left(\dfrac{d}{D_0}\right)^{2n}}
$$

也称为“最大平坦滤波器”。1阶巴特沃斯低通滤波器，高频低频间的过渡较光滑(高低频之间没有明显的截止点)，可以有效减少振铃效应。但是巴特沃斯滤波器阶数很高时仍然会出现振铃效应。

对于 n 阶Ⅰ型切比雪夫低通滤波器，表达式为：

$$
H(d)=\frac{1}{\sqrt{1+\varepsilon^2T_n^2\left(\dfrac{d}{D_0}\right)}}
$$

其中， $T_n(\Omega)$ 为 n 阶切比雪夫多项式：

$$
T_n(\Omega) =
\begin{cases}
\cos(n\arccos\Omega), & 0\le \Omega \le 1 \\
\cosh(n\operatorname{arccosh}\Omega), & \Omega >1
\end{cases}
$$

Ⅰ型切比雪夫低通滤波器通带有波纹，阻带平坦。Ⅱ型切比雪夫低通滤波器通带平坦，阻带有波纹。

---

高通滤波：可锐化图像，提取边缘信息，增强。

理想高通滤波器**也有振铃效应**，同样硬件无法实现。可以使用巴特沃斯高通滤波器、切比雪夫高通滤波器等消除。

n 阶巴特沃斯高通滤波器、n 阶切比雪夫高通滤波器，只需将对应的低通滤波器中的 $\dfrac{d}{D_0}$ 改为 $\dfrac{D_0}{d}$ 即可。

---

高通滤波之后图像背景的平均强度减小到接近黑色，因为大多数图像中高频分量都是很弱的。解决办法是把一定比例的原始图像加到过滤后的结果中去。

高频加强：在高通滤波器函数前乘以一个常数，再加一个偏移，使零频率不被滤掉，传递函数为 $H_{hfe}(u,v)=a+bH_{hp}(u,v)$ ，其中 $b>a\geqslant 0$ ，a 一般取 $0.25\sim0.5$ ，b 一般取 $1.5\sim2.0$ 。

## 4.3 带通和带阻滤波

带阻滤波器：可消除周期性噪声。可用 N 阶巴特沃斯带阻滤波器实现， $W$ 为带宽， $D_0$ 为截止频率：

$$
H(u,v) = \frac{1}{1 + \left( \dfrac{D(u,v)W}{D^2(u,v) - D_0^2} \right)^{2n}}
$$

带通滤波器：可提取周期性噪声。直接用“1减去一个带阻滤波器”： $H_{bp}(u,v)=1-H_{br}(u,v)$ 。

## 4.4 同态滤波

基于亮度成像模型： $f(x,y)=i(x,y)\cdot r(x,y)$ 。 $i(x,y)$ 为照度成分，特点是变化缓慢，对应低频分量； $r(x,y)$ 为反射成分，高频成分丰富。同态滤波同时压缩亮度范围和增强对比度。

算法步骤：利用频域增强思路将乘性转换为加性，处理后再转换回来。

1. 两边取对数： $\ln f(x, y) = \ln i(x, y) + \ln r(x, y)$
2. 两边取傅氏变换： $F(u, v) = I(u, v) + R(u, v)$
3. 用一个频域函数 $H(u, v)$ 处理 $F(u, v)$ ： $H(u, v)F(u, v) = H(u, v)I(u, v) + H(u, v)R(u, v)$ 。其中滤波器 $H(u,v)$ 为一个**高通滤波器**，但是不能完全滤除低频成分，而是适当压制。
4. 反变换到空域： $h_f(x, y) = h_i(x, y) + h_r(x, y)$
5. 两边取指数： $g(x, y) = \exp|h_f(x, y)| = \exp|h_i(x, y)| \cdot \exp|h_r(x, y)|$

特点：可<span style="color:red">消除乘性噪声</span>，还能同时压缩图像的整体动态范围和增加图像中相邻区域间的对比度。
