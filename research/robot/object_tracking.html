<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="This is the website of Derrick Marcus for recording learning and blogs."><meta name=author content="Yanxu Chen"><link rel=canonical href=https://blog.yanxuchen.com/research/robot/object_tracking.html><link rel=prev href=object_detection.html><link rel=next href=gaussian_splatting.html><link rel=icon href=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/2001.jpg><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.9"><title>Object Tracking - Derrick Marcus</title><link rel=stylesheet href=../../assets/stylesheets/main.4af4bdda.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><script src=https://unpkg.com/iframe-worker/shim></script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lxgw-wenkai-screen-web@latest/style.css><link rel=stylesheet href=../../stylesheets/custom.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-GRKG9RVNHS"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-GRKG9RVNHS",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-GRKG9RVNHS",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script> <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#object-tracking class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> <button class="md-banner__button md-icon" aria-label="Don't show this again"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> Follow me: <a href=https://github.com/DerrickMarcus> <strong>@DerrickMarcus</strong> </a> on <span class="twemoji github"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </span> <strong>Github</strong> and <a href=https://space.bilibili.com/627449965> <strong>@64光年外</strong> </a> on <span class="twemoji bilibili"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M488.6 104.1c16.7 18.1 24.4 39.7 23.3 65.7v202.4c-.4 26.4-9.2 48.1-26.5 65.1-17.2 17-39.1 25.9-65.5 26.7H92.02c-26.45-.8-48.21-9.8-65.28-27.2C9.682 419.4.767 396.5 0 368.2V169.8c.767-26 9.682-47.6 26.74-65.7C43.81 87.75 65.57 78.77 92.02 78h29.38L96.05 52.19c-5.75-5.73-8.63-13-8.63-21.79 0-8.8 2.88-16.06 8.63-21.797C101.8 2.868 109.1 0 117.9 0q13.2 0 21.9 8.603L213.1 78h88l74.5-69.397C381.7 2.868 389.2 0 398 0q13.2 0 21.9 8.603c5.7 5.737 8.6 12.997 8.6 21.797 0 8.79-2.9 16.06-8.6 21.79L394.6 78h29.3c26.4.77 48 9.75 64.7 26.1m-38.8 69.7c-.4-9.6-3.7-17.4-10.7-23.5-5.2-6.1-14-9.4-22.7-9.8H96.05c-9.59.4-17.45 3.7-23.58 9.8-6.14 6.1-9.4 13.9-9.78 23.5v194.4c0 9.2 3.26 17 9.78 23.5s14.38 9.8 23.58 9.8H416.4c9.2 0 17-3.3 23.3-9.8s9.7-14.3 10.1-23.5zm-264.3 42.7c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2-6.2 6.3-14 9.5-23.6 9.5s-17.5-3.2-23.6-9.5-9.4-14-9.8-23.2v-33.3c.4-9.1 3.8-16.9 10.1-23.2s13.2-9.6 23.3-10c9.2.4 17 3.7 23.3 10m191.5 0c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2s-14 9.5-23.6 9.5-17.4-3.2-23.6-9.5c-7-6.3-9.4-14-9.7-23.2v-33.3c.3-9.1 3.7-16.9 10-23.2s14.1-9.6 23.3-10c9.2.4 17 3.7 23.3 10"/></svg> </span> <strong>Bilibili</strong> </div> <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script> </aside> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../index.html title="Derrick Marcus" class="md-header__button md-logo" aria-label="Derrick Marcus" data-md-component=logo> <img src=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/2001.jpg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Derrick Marcus </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Object Tracking </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M7.5 2c-1.79 1.15-3 3.18-3 5.5s1.21 4.35 3.03 5.5C4.46 13 2 10.54 2 7.5A5.5 5.5 0 0 1 7.5 2m11.57 1.5 1.43 1.43L4.93 20.5 3.5 19.07zm-6.18 2.43L11.41 5 9.97 6l.42-1.7L9 3.24l1.75-.12.58-1.65L12 3.1l1.73.03-1.35 1.13zm-3.3 3.61-1.16-.73-1.12.78.34-1.32-1.09-.83 1.36-.09.45-1.29.51 1.27 1.36.03-1.05.87zM19 13.5a5.5 5.5 0 0 1-5.5 5.5c-1.22 0-2.35-.4-3.26-1.07l7.69-7.69c.67.91 1.07 2.04 1.07 3.26m-4.4 6.58 2.77-1.15-.24 3.35zm4.33-2.7 1.15-2.77 2.2 2.54zm1.15-4.96-1.14-2.78 3.34.24zM9.63 18.93l2.77 1.15-2.53 2.19z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=black data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=indigo aria-label="Switch to system preference" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to system preference" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/DerrickMarcus/DerrickMarcus.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> DerrickMarcus.github.io </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../index.html class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../blog/index.html class=md-tabs__link> Blog </a> </li> <li class=md-tabs__item> <a href=../../course_notes/index.html class=md-tabs__link> Course Notes </a> </li> <li class=md-tabs__item> <a href=../../course_labs/index.html class=md-tabs__link> Course Labs </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../index.html class=md-tabs__link> Research </a> </li> <li class=md-tabs__item> <a href=../../dev_tools/index.html class=md-tabs__link> Development Tools </a> </li> <li class=md-tabs__item> <a href=../../else/index.html class=md-tabs__link> Else </a> </li> <li class=md-tabs__item> <a href=../../about/index.html class=md-tabs__link> About </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../index.html title="Derrick Marcus" class="md-nav__button md-logo" aria-label="Derrick Marcus" data-md-component=logo> <img src=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/2001.jpg alt=logo> </a> Derrick Marcus </label> <div class=md-nav__source> <a href=https://github.com/DerrickMarcus/DerrickMarcus.github.io title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> DerrickMarcus.github.io </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../index.html class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <div class="md-nav__link md-nav__container"> <a href=../../blog/index.html class="md-nav__link "> <span class=md-ellipsis> Blog </span> </a> <label class="md-nav__link " for=__nav_2 id=__nav_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Blog </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> <span class=md-ellipsis> Archive </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Archive </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../blog/archive/2025.html class=md-nav__link> <span class=md-ellipsis> 2025 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> <span class=md-ellipsis> Categories </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Categories </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../blog/category/environment.html class=md-nav__link> <span class=md-ellipsis> environment </span> </a> </li> <li class=md-nav__item> <a href=../../blog/category/railway.html class=md-nav__link> <span class=md-ellipsis> railway </span> </a> </li> <li class=md-nav__item> <a href=../../blog/category/research.html class=md-nav__link> <span class=md-ellipsis> research </span> </a> </li> <li class=md-nav__item> <a href=../../blog/category/robot.html class=md-nav__link> <span class=md-ellipsis> robot </span> </a> </li> <li class=md-nav__item> <a href=../../blog/category/sport.html class=md-nav__link> <span class=md-ellipsis> sport </span> </a> </li> <li class=md-nav__item> <a href=../../blog/category/technology.html class=md-nav__link> <span class=md-ellipsis> technology </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <div class="md-nav__link md-nav__container"> <a href=../../course_notes/index.html class="md-nav__link "> <span class=md-ellipsis> Course Notes </span> </a> <label class="md-nav__link " for=__nav_3 id=__nav_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Course Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <div class="md-nav__link md-nav__container"> <a href=../../course_notes/signal_system/index.html class="md-nav__link "> <span class=md-ellipsis> Signals and Systems </span> </a> <label class="md-nav__link " for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Signals and Systems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../course_notes/signal_system/chapter5.html class=md-nav__link> <span class=md-ellipsis> 05 傅里叶变换应用于通信系统 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/signal_system/chapter6.html class=md-nav__link> <span class=md-ellipsis> 06 信号的矢量空间 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/signal_system/chapter7.html class=md-nav__link> <span class=md-ellipsis> 07 离散时间系统的时域分析 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/signal_system/chapter8.html class=md-nav__link> <span class=md-ellipsis> 08 z变换与离散时间系统z域分析 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/signal_system/chapter11.html class=md-nav__link> <span class=md-ellipsis> 11 反馈系统 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/signal_system/chapter12.html class=md-nav__link> <span class=md-ellipsis> 12 系统的状态变量分析 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3> <div class="md-nav__link md-nav__container"> <a href=../../course_notes/probability/index.html class="md-nav__link "> <span class=md-ellipsis> Probability and Stochastic Process </span> </a> <label class="md-nav__link " for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Probability and Stochastic Process </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../course_notes/probability/chapter1.html class=md-nav__link> <span class=md-ellipsis> 1 Probability Theory Basics </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/probability/chapter2.html class=md-nav__link> <span class=md-ellipsis> 2 Univariate Random Variable </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/probability/chapter3.html class=md-nav__link> <span class=md-ellipsis> 3 Multivariate Random Variable </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/probability/chapter4.html class=md-nav__link> <span class=md-ellipsis> 4 Second-order Process and Spectral Analysis </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/probability/chapter5.html class=md-nav__link> <span class=md-ellipsis> 5 Gaussian Process </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/probability/chapter6.html class=md-nav__link> <span class=md-ellipsis> 6 Markov Chain </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/probability/chapter7.html class=md-nav__link> <span class=md-ellipsis> 7 Poisson Process </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4> <div class="md-nav__link md-nav__container"> <a href=../../course_notes/communication_network/index.html class="md-nav__link "> <span class=md-ellipsis> Communication and Network </span> </a> <label class="md-nav__link " for=__nav_3_4 id=__nav_3_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Communication and Network </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../course_notes/communication_network/chapter1.html class=md-nav__link> <span class=md-ellipsis> 1 信息论基础 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/communication_network/chapter2.html class=md-nav__link> <span class=md-ellipsis> 2 模拟信源的数字化 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/communication_network/chapter3.html class=md-nav__link> <span class=md-ellipsis> 3 电平信道 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/communication_network/chapter4.html class=md-nav__link> <span class=md-ellipsis> 4 波形信道 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/communication_network/chapter5.html class=md-nav__link> <span class=md-ellipsis> 5 差错控制 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_5> <div class="md-nav__link md-nav__container"> <a href=../../course_notes/media_cognition/index.html class="md-nav__link "> <span class=md-ellipsis> Media and Cognition </span> </a> <label class="md-nav__link " for=__nav_3_5 id=__nav_3_5_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_5_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Media and Cognition </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../course_notes/media_cognition/chapter1.html class=md-nav__link> <span class=md-ellipsis> 1 Artificial Intelligence </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/media_cognition/chapter2.html class=md-nav__link> <span class=md-ellipsis> 2 Cognition </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/media_cognition/chapter3.html class=md-nav__link> <span class=md-ellipsis> 3 Machine Learing </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/media_cognition/chapter4.html class=md-nav__link> <span class=md-ellipsis> 4 Deep Learing </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/media_cognition/chapter5.html class=md-nav__link> <span class=md-ellipsis> 5 CNN </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/media_cognition/chapter6.html class=md-nav__link> <span class=md-ellipsis> 6 RNN </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/media_cognition/chapter7.html class=md-nav__link> <span class=md-ellipsis> 7 Transformer </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/media_cognition/chapter8.html class=md-nav__link> <span class=md-ellipsis> 8 Bayes Decision </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_6> <div class="md-nav__link md-nav__container"> <a href=../../course_notes/solid_physics/index.html class="md-nav__link "> <span class=md-ellipsis> Foundation of Solid State Physics </span> </a> <label class="md-nav__link " for=__nav_3_6 id=__nav_3_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_6_label aria-expanded=false> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Foundation of Solid State Physics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../course_notes/solid_physics/chapter1.html class=md-nav__link> <span class=md-ellipsis> 1 晶体的结构 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/solid_physics/chapter2.html class=md-nav__link> <span class=md-ellipsis> 2 固体的结合 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/solid_physics/chapter3.html class=md-nav__link> <span class=md-ellipsis> 3 固体电子论 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/solid_physics/chapter4.html class=md-nav__link> <span class=md-ellipsis> 4 固体的电特性 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/solid_physics/chapter5.html class=md-nav__link> <span class=md-ellipsis> 5 固体间接触的电特性 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/solid_physics/chapter6.html class=md-nav__link> <span class=md-ellipsis> 6 固体的磁特性 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/solid_physics/chapter7.html class=md-nav__link> <span class=md-ellipsis> 7 晶格振动和固体的热性质 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/solid_physics/chapter8.html class=md-nav__link> <span class=md-ellipsis> 8 超导 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/solid_physics/chapter9.html class=md-nav__link> <span class=md-ellipsis> 9 场与物质的相互作用 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/solid_physics/test.html class=md-nav__link> <span class=md-ellipsis> 课后测试题 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_7> <div class="md-nav__link md-nav__container"> <a href=../../course_notes/digital_image/index.html class="md-nav__link "> <span class=md-ellipsis> Digital Image Processing </span> </a> <label class="md-nav__link " for=__nav_3_7 id=__nav_3_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_7_label aria-expanded=false> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Digital Image Processing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../course_notes/digital_image/chapter1.html class=md-nav__link> <span class=md-ellipsis> 1 图像处理概述 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/digital_image/chapter2.html class=md-nav__link> <span class=md-ellipsis> 2 图像信息与视觉感知 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/digital_image/chapter3.html class=md-nav__link> <span class=md-ellipsis> 3 空域图像增强 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/digital_image/chapter4.html class=md-nav__link> <span class=md-ellipsis> 4 频域图像增强 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/digital_image/chapter5.html class=md-nav__link> <span class=md-ellipsis> 5 图像分割 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/digital_image/chapter6.html class=md-nav__link> <span class=md-ellipsis> 6 图像复原 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/digital_image/chapter7.html class=md-nav__link> <span class=md-ellipsis> 7 图像校正和修补 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/digital_image/chapter8.html class=md-nav__link> <span class=md-ellipsis> 8 图像压缩编码 </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/digital_image/chapter9.html class=md-nav__link> <span class=md-ellipsis> 9 图像3D成像 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_8> <div class="md-nav__link md-nav__container"> <a href=../../course_notes/operating_system/index.html class="md-nav__link "> <span class=md-ellipsis> Operating System </span> </a> <label class="md-nav__link " for=__nav_3_8 id=__nav_3_8_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_8_label aria-expanded=false> <label class=md-nav__title for=__nav_3_8> <span class="md-nav__icon md-icon"></span> Operating System </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../course_notes/operating_system/chapter1.html class=md-nav__link> <span class=md-ellipsis> 01 Introduction(1) </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/operating_system/chapter2.html class=md-nav__link> <span class=md-ellipsis> 02 Introduction(2) </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/operating_system/chapter3.html class=md-nav__link> <span class=md-ellipsis> 03 Process </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/operating_system/chapter4.html class=md-nav__link> <span class=md-ellipsis> 04 Thread </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/operating_system/chapter5.html class=md-nav__link> <span class=md-ellipsis> 05 Mutual Exclusion and Synchronization(1) </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/operating_system/chapter6.html class=md-nav__link> <span class=md-ellipsis> 06 Mutual Exclusion and Synchronization(2) </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/operating_system/chapter7.html class=md-nav__link> <span class=md-ellipsis> 07 Processor Scheduling and Deadlock </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/operating_system/chapter8.html class=md-nav__link> <span class=md-ellipsis> 08 Memory Management(1) </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/operating_system/chapter9.html class=md-nav__link> <span class=md-ellipsis> 09 Memory Management(2) </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/operating_system/chapter10.html class=md-nav__link> <span class=md-ellipsis> 10 Memory Management(3) </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/operating_system/chapter11.html class=md-nav__link> <span class=md-ellipsis> 11 Device Management(1) </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/operating_system/chapter12.html class=md-nav__link> <span class=md-ellipsis> 12 Device Management(2) </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/operating_system/chapter13.html class=md-nav__link> <span class=md-ellipsis> 13 File Systems(1) </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/operating_system/chapter14.html class=md-nav__link> <span class=md-ellipsis> 14 File Systems(2) </span> </a> </li> <li class=md-nav__item> <a href=../../course_notes/operating_system/chapter15.html class=md-nav__link> <span class=md-ellipsis> 15 Course Summary </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <div class="md-nav__link md-nav__container"> <a href=../../course_labs/index.html class="md-nav__link "> <span class=md-ellipsis> Course Labs </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Course Labs </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_2> <div class="md-nav__link md-nav__container"> <a href=../../course_labs/data_algorithm/index.html class="md-nav__link "> <span class=md-ellipsis> Data and Algorithm </span> </a> <label class="md-nav__link " for=__nav_4_2 id=__nav_4_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_2_label aria-expanded=false> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Data and Algorithm </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../course_labs/data_algorithm/oj1.html class=md-nav__link> <span class=md-ellipsis> OJ-1 丢失的练习册 </span> </a> </li> <li class=md-nav__item> <a href=../../course_labs/data_algorithm/oj2.html class=md-nav__link> <span class=md-ellipsis> OJ-2 军训排队 </span> </a> </li> <li class=md-nav__item> <a href=../../course_labs/data_algorithm/oj3.html class=md-nav__link> <span class=md-ellipsis> OJ-3 比武 </span> </a> </li> <li class=md-nav__item> <a href=../../course_labs/data_algorithm/oj4.html class=md-nav__link> <span class=md-ellipsis> OJ-4 缺损二叉树 </span> </a> </li> <li class=md-nav__item> <a href=../../course_labs/data_algorithm/oj5.html class=md-nav__link> <span class=md-ellipsis> OJ-5 信息传递 </span> </a> </li> <li class=md-nav__item> <a href=../../course_labs/data_algorithm/oj6.html class=md-nav__link> <span class=md-ellipsis> OJ-6 跳跳乐 </span> </a> </li> <li class=md-nav__item> <a href=../../course_labs/data_algorithm/oj7.html class=md-nav__link> <span class=md-ellipsis> OJ-7 带限矩阵方程组求解 </span> </a> </li> <li class=md-nav__item> <a href=../../course_labs/data_algorithm/oj8.html class=md-nav__link> <span class=md-ellipsis> OJ-8 缺失数据恢复 </span> </a> </li> <li class=md-nav__item> <a href=../../course_labs/data_algorithm/oj9.html class=md-nav__link> <span class=md-ellipsis> OJ-9 小明的火车旅行计划 </span> </a> </li> <li class=md-nav__item> <a href=../../course_labs/data_algorithm/oj10.html class=md-nav__link> <span class=md-ellipsis> OJ-10 张量相乘的最小开销问题 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_3> <div class="md-nav__link md-nav__container"> <a href=../../course_labs/digital_image/index.html class="md-nav__link "> <span class=md-ellipsis> Digital Image Processing </span> </a> <label class="md-nav__link " for=__nav_4_3 id=__nav_4_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_3_label aria-expanded=false> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Digital Image Processing </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../course_labs/digital_image/lab1.html class=md-nav__link> <span class=md-ellipsis> Lab-1 课程概述 </span> </a> </li> <li class=md-nav__item> <a href=../../course_labs/digital_image/lab2.html class=md-nav__link> <span class=md-ellipsis> Lab-2 彩色分量分解 </span> </a> </li> <li class=md-nav__item> <a href=../../course_labs/digital_image/lab3.html class=md-nav__link> <span class=md-ellipsis> Lab-3 人脸蒙版提取 </span> </a> </li> <li class=md-nav__item> <a href=../../course_labs/digital_image/lab4.html class=md-nav__link> <span class=md-ellipsis> Lab-4 灰度伽马变换 </span> </a> </li> <li class=md-nav__item> <a href=../../course_labs/digital_image/lab5.html class=md-nav__link> <span class=md-ellipsis> Lab-5 直方图均衡化/规定化 </span> </a> </li> <li class=md-nav__item> <a href=../../course_labs/digital_image/lab6.html class=md-nav__link> <span class=md-ellipsis> Lab-6 滤波去噪 </span> </a> </li> <li class=md-nav__item> <a href=../../course_labs/digital_image/lab7.html class=md-nav__link> <span class=md-ellipsis> Lab-7 频域滤波 </span> </a> </li> <li class=md-nav__item> <a href=../../course_labs/digital_image/lab8.html class=md-nav__link> <span class=md-ellipsis> Lab-8 边缘检测 </span> </a> </li> <li class=md-nav__item> <a href=../../course_labs/digital_image/lab9.html class=md-nav__link> <span class=md-ellipsis> Lab-9 阈值分割&伪彩色增强 </span> </a> </li> <li class=md-nav__item> <a href=../../course_labs/digital_image/lab12.html class=md-nav__link> <span class=md-ellipsis> Lab-12 图像复原 </span> </a> </li> <li class=md-nav__item> <a href=../../course_labs/digital_image/lab13.html class=md-nav__link> <span class=md-ellipsis> Lab-13 图像仿射变换 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5 checked> <div class="md-nav__link md-nav__container"> <a href=../index.html class="md-nav__link "> <span class=md-ellipsis> Research </span> </a> <label class="md-nav__link " for=__nav_5 id=__nav_5_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=true> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Research </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2 checked> <div class="md-nav__link md-nav__container"> <a href=index.html class="md-nav__link "> <span class=md-ellipsis> Robot </span> </a> <label class="md-nav__link " for=__nav_5_2 id=__nav_5_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_5_2_label aria-expanded=true> <label class=md-nav__title for=__nav_5_2> <span class="md-nav__icon md-icon"></span> Robot </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=ros_basic.html class=md-nav__link> <span class=md-ellipsis> ROS basic </span> </a> </li> <li class=md-nav__item> <a href=gazebo.html class=md-nav__link> <span class=md-ellipsis> Gazebo </span> </a> </li> <li class=md-nav__item> <a href=catkin.html class=md-nav__link> <span class=md-ellipsis> Catkin Tool </span> </a> </li> <li class=md-nav__item> <a href=geometric_transformation.html class=md-nav__link> <span class=md-ellipsis> Geometric Transformation </span> </a> </li> <li class=md-nav__item> <a href=camera_calibration.html class=md-nav__link> <span class=md-ellipsis> Camera Calibration </span> </a> </li> <li class=md-nav__item> <a href=kalman_filter.html class=md-nav__link> <span class=md-ellipsis> Kalman Filter </span> </a> </li> <li class=md-nav__item> <a href=kdtree.html class=md-nav__link> <span class=md-ellipsis> Kd-Tree </span> </a> </li> <li class=md-nav__item> <a href=object_detection.html class=md-nav__link> <span class=md-ellipsis> Object Detection </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Object Tracking </span> <span class="md-nav__icon md-icon"></span> </label> <a href=object_tracking.html class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Object Tracking </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#mot-basic class=md-nav__link> <span class=md-ellipsis> MOT Basic </span> </a> </li> <li class=md-nav__item> <a href=#kuhn-algorithm-unweighted-hungarian class=md-nav__link> <span class=md-ellipsis> Kuhn Algorithm (unweighted Hungarian) </span> </a> <nav class=md-nav aria-label="Kuhn Algorithm (unweighted Hungarian)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#definition class=md-nav__link> <span class=md-ellipsis> Definition </span> </a> </li> <li class=md-nav__item> <a href=#algorithm class=md-nav__link> <span class=md-ellipsis> Algorithm </span> </a> </li> <li class=md-nav__item> <a href=#code class=md-nav__link> <span class=md-ellipsis> Code </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#kuhn-munkres-algorithm-weighted-hungarian class=md-nav__link> <span class=md-ellipsis> Kuhn-Munkres Algorithm (weighted Hungarian) </span> </a> <nav class=md-nav aria-label="Kuhn-Munkres Algorithm (weighted Hungarian)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#definition_1 class=md-nav__link> <span class=md-ellipsis> Definition </span> </a> </li> <li class=md-nav__item> <a href=#algorithm_1 class=md-nav__link> <span class=md-ellipsis> Algorithm </span> </a> </li> <li class=md-nav__item> <a href=#code_1 class=md-nav__link> <span class=md-ellipsis> Code </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#munkres-algorithm-assignment-problem class=md-nav__link> <span class=md-ellipsis> Munkres Algorithm (Assignment Problem) </span> </a> <nav class=md-nav aria-label="Munkres Algorithm (Assignment Problem)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#description class=md-nav__link> <span class=md-ellipsis> Description </span> </a> </li> <li class=md-nav__item> <a href=#algorithm_2 class=md-nav__link> <span class=md-ellipsis> Algorithm </span> </a> </li> <li class=md-nav__item> <a href=#follow-up-problems class=md-nav__link> <span class=md-ellipsis> Follow-up problems </span> </a> </li> <li class=md-nav__item> <a href=#code_2 class=md-nav__link> <span class=md-ellipsis> Code </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sort class=md-nav__link> <span class=md-ellipsis> SORT </span> </a> <nav class=md-nav aria-label=SORT> <ul class=md-nav__list> <li class=md-nav__item> <a href=#estimantion-model class=md-nav__link> <span class=md-ellipsis> Estimantion Model </span> </a> </li> <li class=md-nav__item> <a href=#data-association class=md-nav__link> <span class=md-ellipsis> Data Association </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#deepsort class=md-nav__link> <span class=md-ellipsis> DeepSORT </span> </a> <nav class=md-nav aria-label=DeepSORT> <ul class=md-nav__list> <li class=md-nav__item> <a href=#track-handling-and-state-estimation class=md-nav__link> <span class=md-ellipsis> Track Handling and State Estimation </span> </a> </li> <li class=md-nav__item> <a href=#assignment-problem class=md-nav__link> <span class=md-ellipsis> Assignment Problem </span> </a> </li> <li class=md-nav__item> <a href=#matching-cascade class=md-nav__link> <span class=md-ellipsis> Matching Cascade </span> </a> </li> <li class=md-nav__item> <a href=#deep-appearance-descriptor class=md-nav__link> <span class=md-ellipsis> Deep Appearance Descriptor </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bytetrack class=md-nav__link> <span class=md-ellipsis> ByteTrack </span> </a> <nav class=md-nav aria-label=ByteTrack> <ul class=md-nav__list> <li class=md-nav__item> <a href=#byte class=md-nav__link> <span class=md-ellipsis> BYTE </span> </a> </li> <li class=md-nav__item> <a href=#bounding-box-annotations class=md-nav__link> <span class=md-ellipsis> Bounding Box Annotations </span> </a> </li> <li class=md-nav__item> <a href=#tracklet-interpolation class=md-nav__link> <span class=md-ellipsis> Tracklet Interpolation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bot-sort class=md-nav__link> <span class=md-ellipsis> BoT-SORT </span> </a> <nav class=md-nav aria-label=BoT-SORT> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kalman-filter class=md-nav__link> <span class=md-ellipsis> Kalman Filter </span> </a> </li> <li class=md-nav__item> <a href=#camera-motion-compensation class=md-nav__link> <span class=md-ellipsis> Camera Motion Compensation </span> </a> </li> <li class=md-nav__item> <a href=#iou-reid-fusion class=md-nav__link> <span class=md-ellipsis> IoU-ReID Fusion </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#jde class=md-nav__link> <span class=md-ellipsis> JDE </span> </a> </li> <li class=md-nav__item> <a href=#fairmot class=md-nav__link> <span class=md-ellipsis> FairMOT </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=gaussian_splatting.html class=md-nav__link> <span class=md-ellipsis> Gaussian Splatting </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5_2_12> <div class="md-nav__link md-nav__container"> <a href=slam/index.html class="md-nav__link "> <span class=md-ellipsis> SLAM </span> </a> <label class="md-nav__link " for=__nav_5_2_12 id=__nav_5_2_12_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_5_2_12_label aria-expanded=false> <label class=md-nav__title for=__nav_5_2_12> <span class="md-nav__icon md-icon"></span> SLAM </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=slam/liosam.html class=md-nav__link> <span class=md-ellipsis> LIO-SAM </span> </a> </li> <li class=md-nav__item> <a href=slam/graph_optimization.html class=md-nav__link> <span class=md-ellipsis> Graph Optimization </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6> <div class="md-nav__link md-nav__container"> <a href=../../dev_tools/index.html class="md-nav__link "> <span class=md-ellipsis> Development Tools </span> </a> <label class="md-nav__link " for=__nav_6 id=__nav_6_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_6_label aria-expanded=false> <label class=md-nav__title for=__nav_6> <span class="md-nav__icon md-icon"></span> Development Tools </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_6_2> <div class="md-nav__link md-nav__container"> <a href=../../dev_tools/environment/index.html class="md-nav__link "> <span class=md-ellipsis> Environment Configuration </span> </a> <label class="md-nav__link " for=__nav_6_2 id=__nav_6_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_6_2_label aria-expanded=false> <label class=md-nav__title for=__nav_6_2> <span class="md-nav__icon md-icon"></span> Environment Configuration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../dev_tools/environment/ubuntu.html class=md-nav__link> <span class=md-ellipsis> Ubuntu </span> </a> </li> <li class=md-nav__item> <a href=../../dev_tools/environment/python.html class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> <li class=md-nav__item> <a href=../../dev_tools/environment/javascript.html class=md-nav__link> <span class=md-ellipsis> JavaScript </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../dev_tools/git.html class=md-nav__link> <span class=md-ellipsis> Git </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7> <div class="md-nav__link md-nav__container"> <a href=../../else/index.html class="md-nav__link "> <span class=md-ellipsis> Else </span> </a> <label class="md-nav__link " for=__nav_7 id=__nav_7_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_7_label aria-expanded=false> <label class=md-nav__title for=__nav_7> <span class="md-nav__icon md-icon"></span> Else </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_2> <div class="md-nav__link md-nav__container"> <a href=../../else/railway/index.html class="md-nav__link "> <span class=md-ellipsis> Railway </span> </a> <label class="md-nav__link " for=__nav_7_2 id=__nav_7_2_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_2_label aria-expanded=false> <label class=md-nav__title for=__nav_7_2> <span class="md-nav__icon md-icon"></span> Railway </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../else/railway/cr.html class=md-nav__link> <span class=md-ellipsis> CR (Fuxing Train) </span> </a> </li> <li class=md-nav__item> <a href=../../else/railway/crh.html class=md-nav__link> <span class=md-ellipsis> CRH (Hexie Train) </span> </a> </li> <li class=md-nav__item> <a href=../../else/railway/group.html class=md-nav__link> <span class=md-ellipsis> Railway Group </span> </a> </li> <li class=md-nav__item> <a href=../../else/railway/station.html class=md-nav__link> <span class=md-ellipsis> Railway Station </span> </a> </li> <li class=md-nav__item> <a href=../../else/railway/line.html class=md-nav__link> <span class=md-ellipsis> Railway Line </span> </a> </li> <li class=md-nav__item> <a href=../../else/railway/train_number.html class=md-nav__link> <span class=md-ellipsis> Train Number </span> </a> </li> <li class=md-nav__item> <a href=../../else/railway/journey.html class=md-nav__link> <span class=md-ellipsis> Journey Record </span> </a> </li> <li class=md-nav__item> <a href=../../else/railway/diary.html class=md-nav__link> <span class=md-ellipsis> Diary </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_7_3> <div class="md-nav__link md-nav__container"> <a href=../../else/readings/index.html class="md-nav__link "> <span class=md-ellipsis> Readings </span> </a> <label class="md-nav__link " for=__nav_7_3 id=__nav_7_3_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_7_3_label aria-expanded=false> <label class=md-nav__title for=__nav_7_3> <span class="md-nav__icon md-icon"></span> Readings </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../else/readings/read1.html class=md-nav__link> <span class=md-ellipsis> 你是勇士 </span> </a> </li> <li class=md-nav__item> <a href=../../else/readings/read2.html class=md-nav__link> <span class=md-ellipsis> 一组诗 </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_8> <div class="md-nav__link md-nav__container"> <a href=../../about/index.html class="md-nav__link "> <span class=md-ellipsis> About </span> </a> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_8_label aria-expanded=false> <label class=md-nav__title for=__nav_8> <span class="md-nav__icon md-icon"></span> About </label> <ul class=md-nav__list data-md-scrollfix> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#mot-basic class=md-nav__link> <span class=md-ellipsis> MOT Basic </span> </a> </li> <li class=md-nav__item> <a href=#kuhn-algorithm-unweighted-hungarian class=md-nav__link> <span class=md-ellipsis> Kuhn Algorithm (unweighted Hungarian) </span> </a> <nav class=md-nav aria-label="Kuhn Algorithm (unweighted Hungarian)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#definition class=md-nav__link> <span class=md-ellipsis> Definition </span> </a> </li> <li class=md-nav__item> <a href=#algorithm class=md-nav__link> <span class=md-ellipsis> Algorithm </span> </a> </li> <li class=md-nav__item> <a href=#code class=md-nav__link> <span class=md-ellipsis> Code </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#kuhn-munkres-algorithm-weighted-hungarian class=md-nav__link> <span class=md-ellipsis> Kuhn-Munkres Algorithm (weighted Hungarian) </span> </a> <nav class=md-nav aria-label="Kuhn-Munkres Algorithm (weighted Hungarian)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#definition_1 class=md-nav__link> <span class=md-ellipsis> Definition </span> </a> </li> <li class=md-nav__item> <a href=#algorithm_1 class=md-nav__link> <span class=md-ellipsis> Algorithm </span> </a> </li> <li class=md-nav__item> <a href=#code_1 class=md-nav__link> <span class=md-ellipsis> Code </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#munkres-algorithm-assignment-problem class=md-nav__link> <span class=md-ellipsis> Munkres Algorithm (Assignment Problem) </span> </a> <nav class=md-nav aria-label="Munkres Algorithm (Assignment Problem)"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#description class=md-nav__link> <span class=md-ellipsis> Description </span> </a> </li> <li class=md-nav__item> <a href=#algorithm_2 class=md-nav__link> <span class=md-ellipsis> Algorithm </span> </a> </li> <li class=md-nav__item> <a href=#follow-up-problems class=md-nav__link> <span class=md-ellipsis> Follow-up problems </span> </a> </li> <li class=md-nav__item> <a href=#code_2 class=md-nav__link> <span class=md-ellipsis> Code </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#sort class=md-nav__link> <span class=md-ellipsis> SORT </span> </a> <nav class=md-nav aria-label=SORT> <ul class=md-nav__list> <li class=md-nav__item> <a href=#estimantion-model class=md-nav__link> <span class=md-ellipsis> Estimantion Model </span> </a> </li> <li class=md-nav__item> <a href=#data-association class=md-nav__link> <span class=md-ellipsis> Data Association </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#deepsort class=md-nav__link> <span class=md-ellipsis> DeepSORT </span> </a> <nav class=md-nav aria-label=DeepSORT> <ul class=md-nav__list> <li class=md-nav__item> <a href=#track-handling-and-state-estimation class=md-nav__link> <span class=md-ellipsis> Track Handling and State Estimation </span> </a> </li> <li class=md-nav__item> <a href=#assignment-problem class=md-nav__link> <span class=md-ellipsis> Assignment Problem </span> </a> </li> <li class=md-nav__item> <a href=#matching-cascade class=md-nav__link> <span class=md-ellipsis> Matching Cascade </span> </a> </li> <li class=md-nav__item> <a href=#deep-appearance-descriptor class=md-nav__link> <span class=md-ellipsis> Deep Appearance Descriptor </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bytetrack class=md-nav__link> <span class=md-ellipsis> ByteTrack </span> </a> <nav class=md-nav aria-label=ByteTrack> <ul class=md-nav__list> <li class=md-nav__item> <a href=#byte class=md-nav__link> <span class=md-ellipsis> BYTE </span> </a> </li> <li class=md-nav__item> <a href=#bounding-box-annotations class=md-nav__link> <span class=md-ellipsis> Bounding Box Annotations </span> </a> </li> <li class=md-nav__item> <a href=#tracklet-interpolation class=md-nav__link> <span class=md-ellipsis> Tracklet Interpolation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bot-sort class=md-nav__link> <span class=md-ellipsis> BoT-SORT </span> </a> <nav class=md-nav aria-label=BoT-SORT> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kalman-filter class=md-nav__link> <span class=md-ellipsis> Kalman Filter </span> </a> </li> <li class=md-nav__item> <a href=#camera-motion-compensation class=md-nav__link> <span class=md-ellipsis> Camera Motion Compensation </span> </a> </li> <li class=md-nav__item> <a href=#iou-reid-fusion class=md-nav__link> <span class=md-ellipsis> IoU-ReID Fusion </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#jde class=md-nav__link> <span class=md-ellipsis> JDE </span> </a> </li> <li class=md-nav__item> <a href=#fairmot class=md-nav__link> <span class=md-ellipsis> FairMOT </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/DerrickMarcus/DerrickMarcus.github.io/edit/main/docs/research/robot/object_tracking.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg> </a> <a href=https://github.com/DerrickMarcus/DerrickMarcus.github.io/raw/main/docs/research/robot/object_tracking.md title="View source of this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5"/></svg> </a> <h1 id=object-tracking>Object Tracking 目标跟踪<a class=headerlink href=#object-tracking title="Permanent link">&para;</a></h1> <p>在 <a href=object_detection.html>Research - Object Detection</a> 中，我们限定 YOLO 只从图像中识别一个 person 类的目标进行定位，限制条件太多，显然无法应对实际的多目标场景，这也体现了单纯目标检测的局限性。目标检测通常只能检测出图片或者视频流中的目标具体属于哪一类别，并不能直接长时间的追踪这个目标，此时就需要使用<strong>目标跟踪</strong>算法来实现这一目的。</p> <p>例如 YOLO 只能从图中检测出目标类别、边界框、置信度等帧间独立的信息，但是无法得知目标的特征信息，也就无法从连续的图像中得知是否为某一具体的目标。也就是说，从结果上来看，YOLO 能持续识别到多个目标，但是它本身不知道这是同一个目标、同一个物体。</p> <details class=note> <summary>Track Mode in Ultralytics YOLO</summary> <p>在早期的 YOLOv3–YOLOv5，YOLO 只负责目标检测（Detection），也就是输出边界框。从 YOLOv8 开始，官方 CLI 和 API 内置了多目标跟踪模块，也就是 Task 中的 Track Mode，参考 <a href=https://docs.ultralytics.com/modes/track/ >Multi-Object Tracking with Ultralytics YOLO</a>。但是 YOLO 自身仍然只负责检测部分，而 “Track” 功能其实是集成了外部 MOT 算法，如 ByteTrack、BoT-SORT、StrongSORT 等，整体上是 Tracking-by-Detection 架构。YOLO 负责输出检测框，Tracker 负责将同一目标在不同帧关联起来。</p> <div class="language-bash highlight"><span class=filename>Bash</span><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1></a><a href=#__codelineno-0-1><span class=linenos data-linenos="1 "></span></a>yolo<span class=w> </span>track<span class=w> </span><span class=nv>model</span><span class=o>=</span>yolov8s.pt<span class=w> </span><span class=nv>source</span><span class=o>=</span>video.mp4<span class=w> </span><span class=nv>tracker</span><span class=o>=</span>bytetrack.yaml
</span></code></pre></div> <p>可一次完成“检测 + 跟踪 + ID 分配 + 输出轨迹”的任务。</p> <p>目前 YOLO Track 的局限性在于，使用的 Tracking-by-Detection 架构中检测与跟踪分离，非联合优化，无法端到端学习。</p> </details> <p>目标跟踪（Object Tracking）是自动驾驶中的常见任务，根据跟踪目标数量的不同，目标跟踪可分为：</p> <ul> <li>单目标跟踪（Single Object Tracking，SOT）</li> <li>多目标跟踪（Multi-Objects Tracking，MOT）</li> </ul> <h2 id=mot-basic>MOT Basic<a class=headerlink href=#mot-basic title="Permanent link">&para;</a></h2> <p>由于单目标跟踪相对较为简单，且可以看作是多目标跟踪的特殊情况，因此这里主要讨论的都是<strong>多目标跟踪</strong>算法。多目标跟踪算以分为两类，分别是基于检测的跟踪（TBD，Tracking-by-Detection）和联合检测跟踪（JDT，Joint Detection &amp; Tracking）。基于检测的跟踪结构简单，跟踪效果与检测效果联系紧密，而联合检测跟踪类算法通常融合了多模块联合学习，在多项跟踪评价指标中表现出色。<sup id=fnref:1><a class=footnote-ref href=#fn:1>1</a></sup></p> <p>典型的多目标跟踪系统框架如下所示：</p> <p><a class=glightbox href=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251029122825.png data-type=image data-width=80% data-height=auto data-desc-position=bottom><img alt=20251029122825 src=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251029122825.png></a></p> <p>目标跟踪所要做的是根据传感器测量序列确定真实目标的数量以及每个目标的对应状态（位置、速度、航向等），具体实现可大体分为三部分：</p> <ul> <li>状态估计</li> <li>数据关联</li> <li>航迹管理</li> </ul> <p>其中，数据关联（Data Association）是目标跟踪中最具挑战的任务之一。对于单目标跟踪而言，数据关联要解决的是传感器测量能否与跟踪目标关联上；对于多目标跟踪而言，数据关联要解决的是哪个传感器测量能与哪个跟踪目标关联上，即跟踪目标与传感器测量的一一对应关系。目前，数据关联已发展出多种理论与算法，包括但不限于：</p> <ul> <li>最近邻（Nearest Neighbor，NN）</li> <li>概率数据关联（Probability Data Association，PDA）</li> <li>联合概率数据关联（Joint Probability Data Association，JPDA）</li> <li>多假设跟踪（Multiple Hypothesis Tracking，MHT）</li> <li>随机有限集（Random Finite Set，RFS）</li> <li>匈牙利算法（Hungarian Algorithm）</li> </ul> <blockquote> <p>The following contents are generated by ChatGPT.</p> </blockquote> <p>多目标跟踪的三大路线：</p> <table> <thead> <tr> <th>路线</th> <th>核心思想</th> <th>代表算法</th> </tr> </thead> <tbody> <tr> <td>1️⃣ Tracking-by-Detection</td> <td>先检测再关联（最主流）</td> <td>SORT、DeepSORT、ByteTrack、OC-SORT、BoT-SORT</td> </tr> <tr> <td>2️⃣ Joint Detection &amp; Tracking（端到端）</td> <td>检测与跟踪联合训练</td> <td>JDE、FairMOT、CenterTrack、TransTrack</td> </tr> <tr> <td>3️⃣ Tracking-by-Embedding（ReID 特征匹配）</td> <td>把目标 ID 嵌入特征空间，通过 embedding 相似性跟踪</td> <td>DeepSORT、BoT-SORT、StrongSORT、DeepMOT</td> </tr> </tbody> </table> <p>按照类型可以归纳为：</p> <table> <thead> <tr> <th>类别</th> <th>算法</th> <th>使用 ReID</th> <th>速度</th> <th>鲁棒性</th> <th>优势场景</th> </tr> </thead> <tbody> <tr> <td>传统几何型</td> <td>SORT</td> <td>❌</td> <td>⭐⭐⭐⭐</td> <td>⭐</td> <td>静态、无遮挡场景</td> </tr> <tr> <td></td> <td>OC-SORT</td> <td>❌</td> <td>⭐⭐⭐⭐</td> <td>⭐⭐⭐</td> <td>稍复杂场景</td> </tr> <tr> <td>外观增强型</td> <td>DeepSORT</td> <td>✅</td> <td>⭐⭐⭐</td> <td>⭐⭐⭐⭐</td> <td>遮挡、行人</td> </tr> <tr> <td></td> <td>BoT-SORT</td> <td>✅</td> <td>⭐⭐</td> <td>⭐⭐⭐⭐⭐</td> <td>相机运动场景</td> </tr> <tr> <td></td> <td>StrongSORT</td> <td>✅</td> <td>⭐⭐</td> <td>⭐⭐⭐⭐⭐</td> <td>大遮挡场景</td> </tr> <tr> <td>检测联合型</td> <td>JDE</td> <td>✅</td> <td>⭐⭐⭐</td> <td>⭐⭐⭐</td> <td>实时端到端</td> </tr> <tr> <td></td> <td>FairMOT</td> <td>✅</td> <td>⭐⭐⭐</td> <td>⭐⭐⭐⭐</td> <td>行人跟踪标准</td> </tr> <tr> <td></td> <td>ByteTrack</td> <td>❌</td> <td>⭐⭐⭐⭐</td> <td>⭐⭐⭐⭐</td> <td>各类目标、通用</td> </tr> <tr> <td>Transformer 型</td> <td>CenterTrack</td> <td>❌</td> <td>⭐⭐⭐</td> <td>⭐⭐⭐</td> <td>中等复杂场景</td> </tr> <tr> <td></td> <td>TransTrack / MOTR</td> <td>✅</td> <td>⭐</td> <td>⭐⭐⭐⭐</td> <td>高精度、研究级</td> </tr> </tbody> </table> <p>常用评价指标：</p> <table> <thead> <tr> <th>符号</th> <th>全称</th> <th>含义</th> <th>举例</th> </tr> </thead> <tbody> <tr> <td><strong>TP (True Positive)</strong></td> <td>真阳性</td> <td>检测框与真值框匹配成功（IoU &gt; 阈值）</td> <td>检测到一个人，而且框得很准</td> </tr> <tr> <td><strong>FP (False Positive)</strong></td> <td>假阳性</td> <td>检测出了不存在的目标</td> <td>没有人却输出了框，或同一人重复输出多个框</td> </tr> <tr> <td><strong>FN (False Negative)</strong></td> <td>假阴性</td> <td>真值中有目标却没检测出来</td> <td>有人但被漏检</td> </tr> <tr> <td><strong>IDSW (ID Switch)</strong></td> <td>ID 切换</td> <td>同一个人被赋予不同 ID、或不同人被错误合并</td> <td>跟踪过程中 ID 更换、或两人 ID 互换</td> </tr> </tbody> </table> <table> <thead> <tr> <th>指标</th> <th>全称</th> <th>衡量对象</th> <th>优点</th> <th>缺点</th> </tr> </thead> <tbody> <tr> <td><strong>MOTA</strong></td> <td>Multi-Object Tracking Accuracy</td> <td>综合精度</td> <td>简单直观</td> <td>对 ID 敏感性弱</td> </tr> <tr> <td><strong>MOTP</strong></td> <td>Multi-Object Tracking Precision</td> <td>定位误差</td> <td>定位精度好解释</td> <td>无法反映 ID</td> </tr> <tr> <td><strong>IDF1</strong></td> <td>ID-based F1 Score</td> <td>ID 一致性</td> <td>衡量身份连贯性</td> <td>对检测弱敏感</td> </tr> <tr> <td><strong>HOTA</strong></td> <td>Higher Order Tracking Accuracy</td> <td>检测+关联平衡</td> <td>反映全面</td> <td>计算复杂</td> </tr> <tr> <td><strong>MT/ML</strong></td> <td>Mostly Tracked / Lost</td> <td>轨迹覆盖率</td> <td>直观易懂</td> <td>粗略</td> </tr> <tr> <td><strong>Frag/IDSW</strong></td> <td>Fragment / ID Switch</td> <td>轨迹连续性</td> <td>补充指标</td> <td>粗粒度</td> </tr> </tbody> </table> <p>常用公开数据集：</p> <table> <thead> <tr> <th>数据集</th> <th>场景</th> <th>特点</th> <th>标注类别</th> </tr> </thead> <tbody> <tr> <td><strong>MOT15 / 16 / 17 / 20</strong></td> <td>行人跟踪</td> <td>最经典的 MOTChallenge 系列</td> <td>person</td> </tr> <tr> <td><strong>DanceTrack (2022)</strong></td> <td>群舞场景</td> <td>同外观高遮挡</td> <td>person</td> </tr> <tr> <td><strong>KITTI MOT</strong></td> <td>车载</td> <td>自动驾驶视角</td> <td>car, pedestrian</td> </tr> <tr> <td><strong>BDD100K MOT</strong></td> <td>大规模城市道路</td> <td>多类别、多天气</td> <td>car, person, rider…</td> </tr> <tr> <td><strong>TAO / TAO-MOT</strong></td> <td>通用场景跟踪</td> <td>类别多，尺度变化大</td> <td>多类目标</td> </tr> <tr> <td><strong>VisDrone / UAVDT</strong></td> <td>航拍</td> <td>目标小、运动剧烈</td> <td>person, car</td> </tr> <tr> <td><strong>CrowdHuman</strong></td> <td>行人密集</td> <td>行人检测与 ReID 联合</td> <td>person</td> </tr> </tbody> </table> <hr> <p>在介绍具体的工程算法之前，我们先介绍常用的数学理论算法——匈牙利算法。</p> <h2 id=kuhn-algorithm-unweighted-hungarian>Kuhn Algorithm (unweighted Hungarian)<a class=headerlink href=#kuhn-algorithm-unweighted-hungarian title="Permanent link">&para;</a></h2> <blockquote> <p>以下部分内容参考<a href=https://blog.csdn.net/u013384984/article/details/90718287>匈牙利算法-看这篇绝对就够了！-CSDN博客</a>。</p> </blockquote> <p>匈牙利算法（Hungarian Algorithm）一种求解最优匹配问题的经典算法，用于在代价矩阵中找到任务与工人之间的最优一对一分配，使总代价最小（或收益最大）。其核心思想是通过矩阵行列变换和零元素匹配，逐步寻找完美匹配并调整未匹配元素的权值，从而得到最优解。</p> <p>匈牙利算法一般使用的是<strong>带权无向图</strong>，我们可以先从特殊情况——无权无向图开始讨论，此时退化为 Kuhn Algorithm。接下来，我们需要回顾一些离散数学中的知识（以下内容摘自艾颖华老师《离散数学讲义》）：</p> <h3 id=definition>Definition<a class=headerlink href=#definition title="Permanent link">&para;</a></h3> <ul> <li>称 <span class=arithmatex>\(G\)</span> 是<strong>二部分图</strong>（二部图），如果可以将 <span class=arithmatex>\(V(G)\)</span> 表示为两个子集的不交并 <span class=arithmatex>\(G=A\cup B\)</span> ，使得 <span class=arithmatex>\(A\)</span> 中的顶点彼此不相邻、 <span class=arithmatex>\(B\)</span> 中的顶点彼此不相邻，记为二部图 <span class=arithmatex>\(G=(A,B,E)\)</span> .</li> <li>二部图 <span class=arithmatex>\(G=(A,B,E)\)</span> 的一个<strong>匹配</strong>，是指边集 <span class=arithmatex>\(E\)</span> 的一个子集 <span class=arithmatex>\(M\)</span> ，要求 <span class=arithmatex>\(M\)</span> 的成员没有公共顶点。</li> <li>称匹配 <span class=arithmatex>\(M\)</span> 是从 <span class=arithmatex>\(A\)</span> 到 <span class=arithmatex>\(B\)</span> 的一个<strong>完全匹配</strong>，如果对 <span class=arithmatex>\(A\)</span> 中每一个顶点 <span class=arithmatex>\(a\in A\)</span> ，满足 <span class=arithmatex>\(M\)</span> 中都有以 <span class=arithmatex>\(a\)</span> 为顶点的边。进一步地，称 <span class=arithmatex>\(M\)</span> 为<strong>完美匹配</strong>（perfect matching），如果每个顶点都是 <span class=arithmatex>\(M\)</span> 中某个边的端点。</li> <li>设 <span class=arithmatex>\(M\)</span> 是二部图 <span class=arithmatex>\(G = (A \cup B, E)\)</span> 的一个匹配，称 <span class=arithmatex>\(G\)</span> 的顶点 <span class=arithmatex>\(v\)</span> 是<strong>自由顶点</strong>，如果 <span class=arithmatex>\(M\)</span> 中没有以 <span class=arithmatex>\(v\)</span> 为顶点的边。</li> <li>称简单路 <span class=arithmatex>\(P\)</span> 是相对于匹配 <span class=arithmatex>\(M\)</span> 的<strong>增广路</strong>（augmenting path），如果 <span class=arithmatex>\(P\)</span> 的起点 <span class=arithmatex>\(u\)</span> 是 <span class=arithmatex>\(A\)</span> 的自由顶点，终点是 <span class=arithmatex>\(B\)</span> 的自由顶点，且 <span class=arithmatex>\(P\)</span> 的第偶数条边都属于 <span class=arithmatex>\(M\)</span>，其余边属于 <span class=arithmatex>\(E - M\)</span>。换句话说，简单路 <span class=arithmatex>\(P\)</span> 是增广路，如果它的端点都是自由顶点，且属于 <span class=arithmatex>\(M\)</span> 的边与不属于 <span class=arithmatex>\(M\)</span> 的边在 <span class=arithmatex>\(P\)</span> 上交替出现。</li> </ul> <p>上面的数学语言略显抽象，我们使用更加通俗易懂的语言重新描述一遍：</p> <ul> <li>二部图 <span class=arithmatex>\(G=(A\cup B, E)\)</span> ：顶点划分为左右两部分 <span class=arithmatex>\(A,B\)</span> ，只存在连接 <span class=arithmatex>\(A,B\)</span> 之间的边，不存在 <span class=arithmatex>\(A,B\)</span> 内部的边。</li> <li>匹配 <span class=arithmatex>\(M\)</span> ：边集的一个子集，任意两条边无公共端点，相当于给工人一一分配任务。</li> <li>完全匹配/最大匹配：边数最多的匹配，再加任何一条就会冲突，且不一定覆盖所有顶点。</li> <li>完美匹配：图中每个点都被匹配到。这要求图的顶点数一定为偶数。</li> <li>自由顶点：匹配 <span class=arithmatex>\(M\)</span> 中没有边连接的顶点。</li> <li>简单路：没有重复顶点的道路。</li> <li>增广路：起点和终点都是自由顶点，沿着路径走，属于 <span class=arithmatex>\(M\)</span> 的边和不属于 <span class=arithmatex>\(E-M\)</span> 的边交替出现。由于首尾边都不属于 <span class=arithmatex>\(M\)</span> ，因此整条路的边数一定为奇数。</li> </ul> <p>另外，完美匹配就像是一个定义到 <span class=arithmatex>\(A\)</span> 和 <span class=arithmatex>\(B\)</span> 之间的双射，两个集合中的元素一一对应，就像是 <span class=arithmatex>\(n\)</span> 个男人和 <span class=arithmatex>\(n\)</span> 个女人，他们之间可能互有好感（一个男人可能对多个女人有好感，一个女人可能对多个男人有好感，及每个顶点都可能有多条连接其他顶点的边），完美匹配就是找到一种配偶方式，使得每一对配偶都是互有好感的。但实际中，我们通常很难做到完美匹配，但是可以做到完全匹配。完全匹配相当于，撮合任何一对互有好感的男女，最多能成全多少对情侣。那么如何找到完全匹配？关键就是找到增广路径。</p> <h3 id=algorithm>Algorithm<a class=headerlink href=#algorithm title="Permanent link">&para;</a></h3> <blockquote> <p>Berge's lemma: <span class=arithmatex>\(M\)</span> 是 <span class=arithmatex>\(G\)</span> 的完全匹配的充要条件是，不存在相对于 <span class=arithmatex>\(M\)</span> 的增广路径。</p> <p>Hall's marriage theorem: 二部分图 <span class=arithmatex>\(G=(A\cup B,E)\)</span> 存在 <span class=arithmatex>\(A\to B\)</span> 完全匹配的充要条件是， <span class=arithmatex>\(\forall S\subseteq A\)</span> 都有 <span class=arithmatex>\(|N(S)|\geqslant |S|\)</span> 。其中 <span class=arithmatex>\(N(S)\)</span> 是 <span class=arithmatex>\(S\)</span> 集中所有点的邻点的集合。</p> </blockquote> <p><a class=glightbox href=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251027214022.png data-type=image data-width=80% data-height=auto data-desc-position=bottom><img alt=20251027214022 src=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251027214022.png></a></p> <p>例如上面的图，边集“2，4”是一个匹配，但同时边集“1，3，5”也是一个匹配，而且边数更多。如果我们从边“2，4”出发，会发现“1，2，3，4，5”是一个增广路径，而去除“2，4”之后就得到了一个更大的匹配。因此自然地，寻找完全匹配就是在已有匹配的情况下，不断寻找增广路径，因为出现一条增广路径，就意味着匹配中可以增加一条边。</p> <p>我们来看一个例子：</p> <p><a class=glightbox href=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251027215023.png data-type=image data-width=80% data-height=auto data-desc-position=bottom><img alt=20251027215023 src=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251027215023.png></a></p> <p>对于这样一个二部图，我们从左向右寻找完全匹配，我们的目标是尽可能给 <span class=arithmatex>\(X\)</span> 中最多的点找到到配对。注意，完全匹配是互相的，如果我们给 <span class=arithmatex>\(X\)</span> 找到了最多的 <span class=arithmatex>\(Y\)</span> 中的对应点，同样， <span class=arithmatex>\(Y\)</span> 中也不可能有更多的点得到匹配。</p> <p>初始时，我们选择 <span class=arithmatex>\((x_1,y_1)\)</span> 边构建匹配，已配对的边加粗。</p> <p><a class=glightbox href=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251027215527.png data-type=image data-width=80% data-height=auto data-desc-position=bottom><img alt=20251027215527 src=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251027215527.png></a></p> <p>接下来给 <span class=arithmatex>\(x_2\)</span> 添加匹配 <span class=arithmatex>\((x_2,y_2)\)</span> ：</p> <p><a class=glightbox href=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251027215611.png data-type=image data-width=80% data-height=auto data-desc-position=bottom><img alt=20251027215611 src=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251027215611.png></a></p> <p>接下来，给 <span class=arithmatex>\(x_3\)</span> 添加匹配的时候，发现它的第一条边的另一端 <span class=arithmatex>\(y_1\)</span> 已经被 <span class=arithmatex>\(x_1\)</span> 占用，于是抢走了 <span class=arithmatex>\(y_1\)</span> ，而 <span class=arithmatex>\(x_1\)</span> 重新寻找匹配，发现第二条边的另一端 <span class=arithmatex>\(y_2\)</span> 已经被 <span class=arithmatex>\(x_2\)</span> 占用，于是抢走了 <span class=arithmatex>\(y_2\)</span> ，而 <span class=arithmatex>\(x_2\)</span> 重新寻找匹配，直接匹配到 <span class=arithmatex>\(y_5\)</span> 。这样的“发现冲突-抢占-重新寻找匹配”的操作也是一个递归的过程。</p> <p><a class=glightbox href=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251027220304.png data-type=image data-width=80% data-height=auto data-desc-position=bottom><img alt=20251027220304 src=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251027220304.png></a></p> <p>在上述过程中涉及到的顶点，依次为 <span class=arithmatex>\(P=(x_3,y_1,x_1,y_2,x_2,y_5)\)</span> ，我们发现组成的这条路径竟然是匹配 <span class=arithmatex>\(M=(x_1-y_1,x_2-y_2)\)</span> 的一个增广路径！Amazing！我们将 <span class=arithmatex>\(M\)</span> 中的配对点拆分开，重新组合，得到了一个更大匹配 <span class=arithmatex>\(M'=(x_1-y_2,x_2-y_5,x_3-y_3)\)</span> 。</p> <p>此时还有一个问题，那就是上述操作中，各个顶点依次挤掉其他的顶点，最后一个顶点发现还是有归宿的。但是如果最后发现最后一个点没有其他可用的匹配了呢？例如 <span class=arithmatex>\(x_2\)</span> 没有连接 <span class=arithmatex>\(y_5\)</span> ，那就意味着增广路径寻找失败，新到来的点 <span class=arithmatex>\(x_3\)</span> 无法加入到当前匹配，将会寻找下一个顶点 <span class=arithmatex>\(x_4\)</span> 的匹配。</p> <p>最后把 <span class=arithmatex>\(x_4,x_5\)</span> 配对，得到这个图的一个完全匹配：</p> <p><a class=glightbox href=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251027220539.png data-type=image data-width=80% data-height=auto data-desc-position=bottom><img alt=20251027220539 src=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251027220539.png></a></p> <p>最后总结一下，匈牙利算法的核心，就是不断寻找原有匹配 <span class=arithmatex>\(M\)</span> 的增广路径，由此，这条增广路径减去 <span class=arithmatex>\(M\)</span> 就得到一个更大的匹配 <span class=arithmatex>\(M'\)</span> ，恰好比 <span class=arithmatex>\(M\)</span> 多一条边。对于一般的图来说，完全匹配可能不唯一，但是完全匹配的大小是唯一的。</p> <h3 id=code>Code<a class=headerlink href=#code title="Permanent link">&para;</a></h3> <p>接下来给出一个匈牙利算法的简单 Python 实现，二部图使用邻接链表（adjacency list）表示，以及一个 C++ 实现，二部图使用邻接矩阵表示（adjacency matrix）：</p> <div class="tabbed-set tabbed-alternate" data-tabs=1:2><input checked=checked id=code-python name=__tabbed_1 type=radio><input id=code-c name=__tabbed_1 type=radio><div class=tabbed-labels><label for=code-python>Python</label><label for=code-c>C++</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-py highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1></a><a href=#__codelineno-1-1><span class=linenos data-linenos=" 1 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>hungarian</span><span class=p>(</span><span class=n>adj</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>list</span><span class=p>[</span><span class=nb>int</span><span class=p>]])</span> <span class=o>-&gt;</span> <span class=nb>dict</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]:</span>
</span><span id=__span-1-2><a id=__codelineno-1-2 name=__codelineno-1-2></a><a href=#__codelineno-1-2><span class=linenos data-linenos=" 2 "></span></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;匈牙利算法 (DFS 版本)，求解二部图最大匹配</span>
</span><span id=__span-1-3><a id=__codelineno-1-3 name=__codelineno-1-3></a><a href=#__codelineno-1-3><span class=linenos data-linenos=" 3 "></span></a>
</span><span id=__span-1-4><a id=__codelineno-1-4 name=__codelineno-1-4></a><a href=#__codelineno-1-4><span class=linenos data-linenos=" 4 "></span></a><span class=sd>    本函数使用深度优先搜索 (DFS) 实现无权二部图的最大匹配算法。</span>
</span><span id=__span-1-5><a id=__codelineno-1-5 name=__codelineno-1-5></a><a href=#__codelineno-1-5><span class=linenos data-linenos=" 5 "></span></a><span class=sd>    输入为左侧顶点的邻接表，输出右侧顶点的匹配结果。</span>
</span><span id=__span-1-6><a id=__codelineno-1-6 name=__codelineno-1-6></a><a href=#__codelineno-1-6><span class=linenos data-linenos=" 6 "></span></a>
</span><span id=__span-1-7><a id=__codelineno-1-7 name=__codelineno-1-7></a><a href=#__codelineno-1-7><span class=linenos data-linenos=" 7 "></span></a><span class=sd>    Args:</span>
</span><span id=__span-1-8><a id=__codelineno-1-8 name=__codelineno-1-8></a><a href=#__codelineno-1-8><span class=linenos data-linenos=" 8 "></span></a><span class=sd>        adj (List[List[int]]):</span>
</span><span id=__span-1-9><a id=__codelineno-1-9 name=__codelineno-1-9></a><a href=#__codelineno-1-9><span class=linenos data-linenos=" 9 "></span></a><span class=sd>            二部图的邻接表。</span>
</span><span id=__span-1-10><a id=__codelineno-1-10 name=__codelineno-1-10></a><a href=#__codelineno-1-10><span class=linenos data-linenos="10 "></span></a><span class=sd>            其中 adj[u] 表示左侧顶点 u 能连接的所有右侧顶点编号列表。</span>
</span><span id=__span-1-11><a id=__codelineno-1-11 name=__codelineno-1-11></a><a href=#__codelineno-1-11><span class=linenos data-linenos="11 "></span></a><span class=sd>            顶点编号通常从 0 开始计数。</span>
</span><span id=__span-1-12><a id=__codelineno-1-12 name=__codelineno-1-12></a><a href=#__codelineno-1-12><span class=linenos data-linenos="12 "></span></a>
</span><span id=__span-1-13><a id=__codelineno-1-13 name=__codelineno-1-13></a><a href=#__codelineno-1-13><span class=linenos data-linenos="13 "></span></a><span class=sd>    Returns:</span>
</span><span id=__span-1-14><a id=__codelineno-1-14 name=__codelineno-1-14></a><a href=#__codelineno-1-14><span class=linenos data-linenos="14 "></span></a><span class=sd>        dict[int, int]:</span>
</span><span id=__span-1-15><a id=__codelineno-1-15 name=__codelineno-1-15></a><a href=#__codelineno-1-15><span class=linenos data-linenos="15 "></span></a><span class=sd>            一个字典，表示匹配结果。</span>
</span><span id=__span-1-16><a id=__codelineno-1-16 name=__codelineno-1-16></a><a href=#__codelineno-1-16><span class=linenos data-linenos="16 "></span></a><span class=sd>            键为右侧顶点编号 (v)，值为与之匹配的左侧顶点编号 (u)。</span>
</span><span id=__span-1-17><a id=__codelineno-1-17 name=__codelineno-1-17></a><a href=#__codelineno-1-17><span class=linenos data-linenos="17 "></span></a><span class=sd>            例如 {1: 0, 2: 3} 表示右顶点1匹配左顶点0，右顶点2匹配左顶点3。</span>
</span><span id=__span-1-18><a id=__codelineno-1-18 name=__codelineno-1-18></a><a href=#__codelineno-1-18><span class=linenos data-linenos="18 "></span></a>
</span><span id=__span-1-19><a id=__codelineno-1-19 name=__codelineno-1-19></a><a href=#__codelineno-1-19><span class=linenos data-linenos="19 "></span></a><span class=sd>    Example:</span>
</span><span id=__span-1-20><a id=__codelineno-1-20 name=__codelineno-1-20></a><a href=#__codelineno-1-20><span class=linenos data-linenos="20 "></span></a><span class=sd>        &gt;&gt;&gt; adj = [</span>
</span><span id=__span-1-21><a id=__codelineno-1-21 name=__codelineno-1-21></a><a href=#__codelineno-1-21><span class=linenos data-linenos="21 "></span></a><span class=sd>        ...     [1, 2],   # 左侧顶点0</span>
</span><span id=__span-1-22><a id=__codelineno-1-22 name=__codelineno-1-22></a><a href=#__codelineno-1-22><span class=linenos data-linenos="22 "></span></a><span class=sd>        ...     [1, 3],   # 左侧顶点1</span>
</span><span id=__span-1-23><a id=__codelineno-1-23 name=__codelineno-1-23></a><a href=#__codelineno-1-23><span class=linenos data-linenos="23 "></span></a><span class=sd>        ...     [2, 3],   # 左侧顶点2</span>
</span><span id=__span-1-24><a id=__codelineno-1-24 name=__codelineno-1-24></a><a href=#__codelineno-1-24><span class=linenos data-linenos="24 "></span></a><span class=sd>        ...     [2, 4]    # 左侧顶点3</span>
</span><span id=__span-1-25><a id=__codelineno-1-25 name=__codelineno-1-25></a><a href=#__codelineno-1-25><span class=linenos data-linenos="25 "></span></a><span class=sd>        ... ]</span>
</span><span id=__span-1-26><a id=__codelineno-1-26 name=__codelineno-1-26></a><a href=#__codelineno-1-26><span class=linenos data-linenos="26 "></span></a><span class=sd>        &gt;&gt;&gt; hungarian(adj)</span>
</span><span id=__span-1-27><a id=__codelineno-1-27 name=__codelineno-1-27></a><a href=#__codelineno-1-27><span class=linenos data-linenos="27 "></span></a><span class=sd>        {1: 0, 2: 2, 3: 1, 4: 3}</span>
</span><span id=__span-1-28><a id=__codelineno-1-28 name=__codelineno-1-28></a><a href=#__codelineno-1-28><span class=linenos data-linenos="28 "></span></a><span class=sd>    &quot;&quot;&quot;</span>
</span><span id=__span-1-29><a id=__codelineno-1-29 name=__codelineno-1-29></a><a href=#__codelineno-1-29><span class=linenos data-linenos="29 "></span></a>
</span><span id=__span-1-30><a id=__codelineno-1-30 name=__codelineno-1-30></a><a href=#__codelineno-1-30><span class=linenos data-linenos="30 "></span></a>    <span class=n>matched</span> <span class=o>=</span> <span class=p>{}</span>
</span><span id=__span-1-31><a id=__codelineno-1-31 name=__codelineno-1-31></a><a href=#__codelineno-1-31><span class=linenos data-linenos="31 "></span></a>
</span><span id=__span-1-32><a id=__codelineno-1-32 name=__codelineno-1-32></a><a href=#__codelineno-1-32><span class=linenos data-linenos="32 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>match</span><span class=p>(</span><span class=n>u</span><span class=p>:</span> <span class=nb>int</span><span class=p>,</span> <span class=n>visited</span><span class=p>:</span> <span class=nb>set</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span><span id=__span-1-33><a id=__codelineno-1-33 name=__codelineno-1-33></a><a href=#__codelineno-1-33><span class=linenos data-linenos="33 "></span></a>        <span class=k>for</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>adj</span><span class=p>[</span><span class=n>u</span><span class=p>]:</span>
</span><span id=__span-1-34><a id=__codelineno-1-34 name=__codelineno-1-34></a><a href=#__codelineno-1-34><span class=linenos data-linenos="34 "></span></a>            <span class=k>if</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>visited</span><span class=p>:</span>
</span><span id=__span-1-35><a id=__codelineno-1-35 name=__codelineno-1-35></a><a href=#__codelineno-1-35><span class=linenos data-linenos="35 "></span></a>                <span class=k>continue</span>
</span><span id=__span-1-36><a id=__codelineno-1-36 name=__codelineno-1-36></a><a href=#__codelineno-1-36><span class=linenos data-linenos="36 "></span></a>            <span class=n>visited</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>v</span><span class=p>)</span>
</span><span id=__span-1-37><a id=__codelineno-1-37 name=__codelineno-1-37></a><a href=#__codelineno-1-37><span class=linenos data-linenos="37 "></span></a>            <span class=k>if</span> <span class=n>v</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>matched</span> <span class=ow>or</span> <span class=n>match</span><span class=p>(</span><span class=n>matched</span><span class=p>[</span><span class=n>v</span><span class=p>],</span> <span class=n>visited</span><span class=p>):</span>
</span><span id=__span-1-38><a id=__codelineno-1-38 name=__codelineno-1-38></a><a href=#__codelineno-1-38><span class=linenos data-linenos="38 "></span></a>                <span class=c1># 如果 v 还没有匹配，或者能为 v 当前的匹配重新找一个位置</span>
</span><span id=__span-1-39><a id=__codelineno-1-39 name=__codelineno-1-39></a><a href=#__codelineno-1-39><span class=linenos data-linenos="39 "></span></a>                <span class=n>matched</span><span class=p>[</span><span class=n>v</span><span class=p>]</span> <span class=o>=</span> <span class=n>u</span>
</span><span id=__span-1-40><a id=__codelineno-1-40 name=__codelineno-1-40></a><a href=#__codelineno-1-40><span class=linenos data-linenos="40 "></span></a>                <span class=k>return</span> <span class=kc>True</span>
</span><span id=__span-1-41><a id=__codelineno-1-41 name=__codelineno-1-41></a><a href=#__codelineno-1-41><span class=linenos data-linenos="41 "></span></a>        <span class=k>return</span> <span class=kc>False</span>
</span><span id=__span-1-42><a id=__codelineno-1-42 name=__codelineno-1-42></a><a href=#__codelineno-1-42><span class=linenos data-linenos="42 "></span></a>
</span><span id=__span-1-43><a id=__codelineno-1-43 name=__codelineno-1-43></a><a href=#__codelineno-1-43><span class=linenos data-linenos="43 "></span></a>    <span class=k>for</span> <span class=n>u</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>adj</span><span class=p>)):</span>
</span><span id=__span-1-44><a id=__codelineno-1-44 name=__codelineno-1-44></a><a href=#__codelineno-1-44><span class=linenos data-linenos="44 "></span></a>        <span class=c1># 必须在外部初始化空集合，因为递归过程需要共享 visited</span>
</span><span id=__span-1-45><a id=__codelineno-1-45 name=__codelineno-1-45></a><a href=#__codelineno-1-45><span class=linenos data-linenos="45 "></span></a>        <span class=n>visited</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
</span><span id=__span-1-46><a id=__codelineno-1-46 name=__codelineno-1-46></a><a href=#__codelineno-1-46><span class=linenos data-linenos="46 "></span></a>        <span class=k>match</span><span class=p>(</span><span class=n>u</span><span class=p>,</span> <span class=n>visited</span><span class=p>)</span>
</span><span id=__span-1-47><a id=__codelineno-1-47 name=__codelineno-1-47></a><a href=#__codelineno-1-47><span class=linenos data-linenos="47 "></span></a>
</span><span id=__span-1-48><a id=__codelineno-1-48 name=__codelineno-1-48></a><a href=#__codelineno-1-48><span class=linenos data-linenos="48 "></span></a>    <span class=k>return</span> <span class=n>matched</span>
</span><span id=__span-1-49><a id=__codelineno-1-49 name=__codelineno-1-49></a><a href=#__codelineno-1-49><span class=linenos data-linenos="49 "></span></a>
</span><span id=__span-1-50><a id=__codelineno-1-50 name=__codelineno-1-50></a><a href=#__codelineno-1-50><span class=linenos data-linenos="50 "></span></a>
</span><span id=__span-1-51><a id=__codelineno-1-51 name=__codelineno-1-51></a><a href=#__codelineno-1-51><span class=linenos data-linenos="51 "></span></a><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
</span><span id=__span-1-52><a id=__codelineno-1-52 name=__codelineno-1-52></a><a href=#__codelineno-1-52><span class=linenos data-linenos="52 "></span></a>    <span class=n>adj</span> <span class=o>=</span> <span class=p>[</span>
</span><span id=__span-1-53><a id=__codelineno-1-53 name=__codelineno-1-53></a><a href=#__codelineno-1-53><span class=linenos data-linenos="53 "></span></a>        <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>],</span>  <span class=c1># 左侧顶点0</span>
</span><span id=__span-1-54><a id=__codelineno-1-54 name=__codelineno-1-54></a><a href=#__codelineno-1-54><span class=linenos data-linenos="54 "></span></a>        <span class=p>[</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>  <span class=c1># 左侧顶点1</span>
</span><span id=__span-1-55><a id=__codelineno-1-55 name=__codelineno-1-55></a><a href=#__codelineno-1-55><span class=linenos data-linenos="55 "></span></a>        <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>],</span>  <span class=c1># 左侧顶点2</span>
</span><span id=__span-1-56><a id=__codelineno-1-56 name=__codelineno-1-56></a><a href=#__codelineno-1-56><span class=linenos data-linenos="56 "></span></a>        <span class=p>[</span><span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>],</span>  <span class=c1># 左侧顶点3</span>
</span><span id=__span-1-57><a id=__codelineno-1-57 name=__codelineno-1-57></a><a href=#__codelineno-1-57><span class=linenos data-linenos="57 "></span></a>    <span class=p>]</span>
</span><span id=__span-1-58><a id=__codelineno-1-58 name=__codelineno-1-58></a><a href=#__codelineno-1-58><span class=linenos data-linenos="58 "></span></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>hungarian</span><span class=p>(</span><span class=n>adj</span><span class=p>)</span>
</span><span id=__span-1-59><a id=__codelineno-1-59 name=__codelineno-1-59></a><a href=#__codelineno-1-59><span class=linenos data-linenos="59 "></span></a>    <span class=nb>print</span><span class=p>(</span><span class=n>result</span><span class=p>)</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-cpp highlight"><span class=filename>C++</span><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1></a><a href=#__codelineno-2-1><span class=linenos data-linenos=" 1 "></span></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream&gt;</span>
</span><span id=__span-2-2><a id=__codelineno-2-2 name=__codelineno-2-2></a><a href=#__codelineno-2-2><span class=linenos data-linenos=" 2 "></span></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;vector&gt;</span>
</span><span id=__span-2-3><a id=__codelineno-2-3 name=__codelineno-2-3></a><a href=#__codelineno-2-3><span class=linenos data-linenos=" 3 "></span></a>
</span><span id=__span-2-4><a id=__codelineno-2-4 name=__codelineno-2-4></a><a href=#__codelineno-2-4><span class=linenos data-linenos=" 4 "></span></a><span class=c1>// 尝试为左侧顶点 u 寻找匹配</span>
</span><span id=__span-2-5><a id=__codelineno-2-5 name=__codelineno-2-5></a><a href=#__codelineno-2-5><span class=linenos data-linenos=" 5 "></span></a><span class=kt>bool</span><span class=w> </span><span class=nf>match</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>u</span><span class=p>,</span>
</span><span id=__span-2-6><a id=__codelineno-2-6 name=__codelineno-2-6></a><a href=#__codelineno-2-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>        </span><span class=k>const</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=o>&amp;</span><span class=n>adj</span><span class=p>,</span>
</span><span id=__span-2-7><a id=__codelineno-2-7 name=__codelineno-2-7></a><a href=#__codelineno-2-7><span class=linenos data-linenos=" 7 "></span></a><span class=w>        </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=w> </span><span class=o>&amp;</span><span class=n>matched</span><span class=p>,</span>
</span><span id=__span-2-8><a id=__codelineno-2-8 name=__codelineno-2-8></a><a href=#__codelineno-2-8><span class=linenos data-linenos=" 8 "></span></a><span class=w>        </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span><span class=w> </span><span class=o>&amp;</span><span class=n>visited</span><span class=p>)</span>
</span><span id=__span-2-9><a id=__codelineno-2-9 name=__codelineno-2-9></a><a href=#__codelineno-2-9><span class=linenos data-linenos=" 9 "></span></a><span class=p>{</span>
</span><span id=__span-2-10><a id=__codelineno-2-10 name=__codelineno-2-10></a><a href=#__codelineno-2-10><span class=linenos data-linenos="10 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>n_right</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>adj</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>();</span>
</span><span id=__span-2-11><a id=__codelineno-2-11 name=__codelineno-2-11></a><a href=#__codelineno-2-11><span class=linenos data-linenos="11 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n_right</span><span class=p>;</span><span class=w> </span><span class=n>v</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-2-12><a id=__codelineno-2-12 name=__codelineno-2-12></a><a href=#__codelineno-2-12><span class=linenos data-linenos="12 "></span></a><span class=w>    </span><span class=p>{</span>
</span><span id=__span-2-13><a id=__codelineno-2-13 name=__codelineno-2-13></a><a href=#__codelineno-2-13><span class=linenos data-linenos="13 "></span></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>adj</span><span class=p>[</span><span class=n>u</span><span class=p>][</span><span class=n>v</span><span class=p>]</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=o>!</span><span class=n>visited</span><span class=p>[</span><span class=n>v</span><span class=p>])</span>
</span><span id=__span-2-14><a id=__codelineno-2-14 name=__codelineno-2-14></a><a href=#__codelineno-2-14><span class=linenos data-linenos="14 "></span></a><span class=w>        </span><span class=p>{</span>
</span><span id=__span-2-15><a id=__codelineno-2-15 name=__codelineno-2-15></a><a href=#__codelineno-2-15><span class=linenos data-linenos="15 "></span></a><span class=w>            </span><span class=n>visited</span><span class=p>[</span><span class=n>v</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
</span><span id=__span-2-16><a id=__codelineno-2-16 name=__codelineno-2-16></a><a href=#__codelineno-2-16><span class=linenos data-linenos="16 "></span></a><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>matched</span><span class=p>[</span><span class=n>v</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>-1</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>match</span><span class=p>(</span><span class=n>matched</span><span class=p>[</span><span class=n>v</span><span class=p>],</span><span class=w> </span><span class=n>adj</span><span class=p>,</span><span class=w> </span><span class=n>matched</span><span class=p>,</span><span class=w> </span><span class=n>visited</span><span class=p>))</span>
</span><span id=__span-2-17><a id=__codelineno-2-17 name=__codelineno-2-17></a><a href=#__codelineno-2-17><span class=linenos data-linenos="17 "></span></a><span class=w>            </span><span class=p>{</span>
</span><span id=__span-2-18><a id=__codelineno-2-18 name=__codelineno-2-18></a><a href=#__codelineno-2-18><span class=linenos data-linenos="18 "></span></a><span class=w>                </span><span class=n>matched</span><span class=p>[</span><span class=n>v</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>u</span><span class=p>;</span>
</span><span id=__span-2-19><a id=__codelineno-2-19 name=__codelineno-2-19></a><a href=#__codelineno-2-19><span class=linenos data-linenos="19 "></span></a><span class=w>                </span><span class=k>return</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
</span><span id=__span-2-20><a id=__codelineno-2-20 name=__codelineno-2-20></a><a href=#__codelineno-2-20><span class=linenos data-linenos="20 "></span></a><span class=w>            </span><span class=p>}</span>
</span><span id=__span-2-21><a id=__codelineno-2-21 name=__codelineno-2-21></a><a href=#__codelineno-2-21><span class=linenos data-linenos="21 "></span></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-2-22><a id=__codelineno-2-22 name=__codelineno-2-22></a><a href=#__codelineno-2-22><span class=linenos data-linenos="22 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-2-23><a id=__codelineno-2-23 name=__codelineno-2-23></a><a href=#__codelineno-2-23><span class=linenos data-linenos="23 "></span></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=nb>false</span><span class=p>;</span>
</span><span id=__span-2-24><a id=__codelineno-2-24 name=__codelineno-2-24></a><a href=#__codelineno-2-24><span class=linenos data-linenos="24 "></span></a><span class=p>}</span>
</span><span id=__span-2-25><a id=__codelineno-2-25 name=__codelineno-2-25></a><a href=#__codelineno-2-25><span class=linenos data-linenos="25 "></span></a>
</span><span id=__span-2-26><a id=__codelineno-2-26 name=__codelineno-2-26></a><a href=#__codelineno-2-26><span class=linenos data-linenos="26 "></span></a><span class=c1>// 匈牙利算法函数</span>
</span><span id=__span-2-27><a id=__codelineno-2-27 name=__codelineno-2-27></a><a href=#__codelineno-2-27><span class=linenos data-linenos="27 "></span></a><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=w> </span><span class=n>hungarian</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=o>&amp;</span><span class=n>adj</span><span class=p>)</span>
</span><span id=__span-2-28><a id=__codelineno-2-28 name=__codelineno-2-28></a><a href=#__codelineno-2-28><span class=linenos data-linenos="28 "></span></a><span class=p>{</span>
</span><span id=__span-2-29><a id=__codelineno-2-29 name=__codelineno-2-29></a><a href=#__codelineno-2-29><span class=linenos data-linenos="29 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>n_left</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>adj</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
</span><span id=__span-2-30><a id=__codelineno-2-30 name=__codelineno-2-30></a><a href=#__codelineno-2-30><span class=linenos data-linenos="30 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>n_right</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>adj</span><span class=p>[</span><span class=mi>0</span><span class=p>].</span><span class=n>size</span><span class=p>();</span>
</span><span id=__span-2-31><a id=__codelineno-2-31 name=__codelineno-2-31></a><a href=#__codelineno-2-31><span class=linenos data-linenos="31 "></span></a><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=w> </span><span class=n>matched</span><span class=p>(</span><span class=n>n_right</span><span class=p>,</span><span class=w> </span><span class=mi>-1</span><span class=p>);</span><span class=w> </span><span class=c1>// matched[v] = 与右顶点 v 匹配的左顶点编号</span>
</span><span id=__span-2-32><a id=__codelineno-2-32 name=__codelineno-2-32></a><a href=#__codelineno-2-32><span class=linenos data-linenos="32 "></span></a>
</span><span id=__span-2-33><a id=__codelineno-2-33 name=__codelineno-2-33></a><a href=#__codelineno-2-33><span class=linenos data-linenos="33 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>u</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>u</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n_left</span><span class=p>;</span><span class=w> </span><span class=n>u</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-2-34><a id=__codelineno-2-34 name=__codelineno-2-34></a><a href=#__codelineno-2-34><span class=linenos data-linenos="34 "></span></a><span class=w>    </span><span class=p>{</span>
</span><span id=__span-2-35><a id=__codelineno-2-35 name=__codelineno-2-35></a><a href=#__codelineno-2-35><span class=linenos data-linenos="35 "></span></a><span class=w>        </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span><span class=w> </span><span class=n>visited</span><span class=p>(</span><span class=n>n_right</span><span class=p>,</span><span class=w> </span><span class=nb>false</span><span class=p>);</span>
</span><span id=__span-2-36><a id=__codelineno-2-36 name=__codelineno-2-36></a><a href=#__codelineno-2-36><span class=linenos data-linenos="36 "></span></a><span class=w>        </span><span class=n>match</span><span class=p>(</span><span class=n>u</span><span class=p>,</span><span class=w> </span><span class=n>adj</span><span class=p>,</span><span class=w> </span><span class=n>matched</span><span class=p>,</span><span class=w> </span><span class=n>visited</span><span class=p>);</span>
</span><span id=__span-2-37><a id=__codelineno-2-37 name=__codelineno-2-37></a><a href=#__codelineno-2-37><span class=linenos data-linenos="37 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-2-38><a id=__codelineno-2-38 name=__codelineno-2-38></a><a href=#__codelineno-2-38><span class=linenos data-linenos="38 "></span></a>
</span><span id=__span-2-39><a id=__codelineno-2-39 name=__codelineno-2-39></a><a href=#__codelineno-2-39><span class=linenos data-linenos="39 "></span></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>matched</span><span class=p>;</span>
</span><span id=__span-2-40><a id=__codelineno-2-40 name=__codelineno-2-40></a><a href=#__codelineno-2-40><span class=linenos data-linenos="40 "></span></a><span class=p>}</span>
</span><span id=__span-2-41><a id=__codelineno-2-41 name=__codelineno-2-41></a><a href=#__codelineno-2-41><span class=linenos data-linenos="41 "></span></a>
</span><span id=__span-2-42><a id=__codelineno-2-42 name=__codelineno-2-42></a><a href=#__codelineno-2-42><span class=linenos data-linenos="42 "></span></a><span class=kt>int</span><span class=w> </span><span class=n>main</span><span class=p>()</span>
</span><span id=__span-2-43><a id=__codelineno-2-43 name=__codelineno-2-43></a><a href=#__codelineno-2-43><span class=linenos data-linenos="43 "></span></a><span class=p>{</span>
</span><span id=__span-2-44><a id=__codelineno-2-44 name=__codelineno-2-44></a><a href=#__codelineno-2-44><span class=linenos data-linenos="44 "></span></a><span class=w>    </span><span class=c1>// 邻接矩阵（1 表示连边，0 表示无边）</span>
</span><span id=__span-2-45><a id=__codelineno-2-45 name=__codelineno-2-45></a><a href=#__codelineno-2-45><span class=linenos data-linenos="45 "></span></a><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>adj</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-2-46><a id=__codelineno-2-46 name=__codelineno-2-46></a><a href=#__codelineno-2-46><span class=linenos data-linenos="46 "></span></a><span class=w>        </span><span class=p>{</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>},</span><span class=w> </span><span class=c1>// 左0连接右1,2</span>
</span><span id=__span-2-47><a id=__codelineno-2-47 name=__codelineno-2-47></a><a href=#__codelineno-2-47><span class=linenos data-linenos="47 "></span></a><span class=w>        </span><span class=p>{</span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>},</span><span class=w> </span><span class=c1>// 左1连接右1,3</span>
</span><span id=__span-2-48><a id=__codelineno-2-48 name=__codelineno-2-48></a><a href=#__codelineno-2-48><span class=linenos data-linenos="48 "></span></a><span class=w>        </span><span class=p>{</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>},</span><span class=w> </span><span class=c1>// 左2连接右2,3</span>
</span><span id=__span-2-49><a id=__codelineno-2-49 name=__codelineno-2-49></a><a href=#__codelineno-2-49><span class=linenos data-linenos="49 "></span></a><span class=w>        </span><span class=p>{</span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>}</span><span class=w>  </span><span class=c1>// 左3连接右2,4</span>
</span><span id=__span-2-50><a id=__codelineno-2-50 name=__codelineno-2-50></a><a href=#__codelineno-2-50><span class=linenos data-linenos="50 "></span></a><span class=w>    </span><span class=p>};</span>
</span><span id=__span-2-51><a id=__codelineno-2-51 name=__codelineno-2-51></a><a href=#__codelineno-2-51><span class=linenos data-linenos="51 "></span></a>
</span><span id=__span-2-52><a id=__codelineno-2-52 name=__codelineno-2-52></a><a href=#__codelineno-2-52><span class=linenos data-linenos="52 "></span></a><span class=w>    </span><span class=c1>// 调用算法</span>
</span><span id=__span-2-53><a id=__codelineno-2-53 name=__codelineno-2-53></a><a href=#__codelineno-2-53><span class=linenos data-linenos="53 "></span></a><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=w> </span><span class=n>res</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>hungarian</span><span class=p>(</span><span class=n>adj</span><span class=p>);</span>
</span><span id=__span-2-54><a id=__codelineno-2-54 name=__codelineno-2-54></a><a href=#__codelineno-2-54><span class=linenos data-linenos="54 "></span></a>
</span><span id=__span-2-55><a id=__codelineno-2-55 name=__codelineno-2-55></a><a href=#__codelineno-2-55><span class=linenos data-linenos="55 "></span></a><span class=w>    </span><span class=c1>// 输出结果</span>
</span><span id=__span-2-56><a id=__codelineno-2-56 name=__codelineno-2-56></a><a href=#__codelineno-2-56><span class=linenos data-linenos="56 "></span></a><span class=w>    </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;匹配结果 (右 -&gt; 左):</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>;</span>
</span><span id=__span-2-57><a id=__codelineno-2-57 name=__codelineno-2-57></a><a href=#__codelineno-2-57><span class=linenos data-linenos="57 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=n>res</span><span class=p>.</span><span class=n>size</span><span class=p>();</span><span class=w> </span><span class=o>++</span><span class=n>v</span><span class=p>)</span>
</span><span id=__span-2-58><a id=__codelineno-2-58 name=__codelineno-2-58></a><a href=#__codelineno-2-58><span class=linenos data-linenos="58 "></span></a><span class=w>    </span><span class=p>{</span>
</span><span id=__span-2-59><a id=__codelineno-2-59 name=__codelineno-2-59></a><a href=#__codelineno-2-59><span class=linenos data-linenos="59 "></span></a><span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>res</span><span class=p>[</span><span class=n>v</span><span class=p>]</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>-1</span><span class=p>)</span>
</span><span id=__span-2-60><a id=__codelineno-2-60 name=__codelineno-2-60></a><a href=#__codelineno-2-60><span class=linenos data-linenos="60 "></span></a><span class=w>            </span><span class=n>std</span><span class=o>::</span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;右 &quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>v</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot; ← 左 &quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>res</span><span class=p>[</span><span class=n>v</span><span class=p>]</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=sc>&#39;\n&#39;</span><span class=p>;</span>
</span><span id=__span-2-61><a id=__codelineno-2-61 name=__codelineno-2-61></a><a href=#__codelineno-2-61><span class=linenos data-linenos="61 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-2-62><a id=__codelineno-2-62 name=__codelineno-2-62></a><a href=#__codelineno-2-62><span class=linenos data-linenos="62 "></span></a>
</span><span id=__span-2-63><a id=__codelineno-2-63 name=__codelineno-2-63></a><a href=#__codelineno-2-63><span class=linenos data-linenos="63 "></span></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-2-64><a id=__codelineno-2-64 name=__codelineno-2-64></a><a href=#__codelineno-2-64><span class=linenos data-linenos="64 "></span></a><span class=p>}</span>
</span></code></pre></div> </div> </div> </div> <h2 id=kuhn-munkres-algorithm-weighted-hungarian>Kuhn-Munkres Algorithm (weighted Hungarian)<a class=headerlink href=#kuhn-munkres-algorithm-weighted-hungarian title="Permanent link">&para;</a></h2> <blockquote> <p>以下部分内容参考自：</p> <p><a href=https://piggerzzm.github.io/2020/03/28/Kuhn-Munkres/ >Kuhn-Munkres 算法 - Safe House</a></p> <p><a href=https://blog.sengxian.com/algorithms/km>Kuhn-Munkres 算法详细解析 - Sengxian's Blog</a></p> </blockquote> <p>上述讨论的简单情形的 Kuhn Algorithm 只能判断能否匹配，求解最大匹配，不关心代价，也无法求“最小代价匹配”。而真正需要最小化匹配代价的，是带有权重的匈牙利算法 Kuhn-Munkres Algorithm。它使用的是有权无向图，等价于一个代价矩阵。例如工人任务分配问题中，工人集合和任务集合组成一个二部分图，某个工人完成某项任务的代价即为连接该工人和该任务的边的权值。</p> <p>KM 算法的目标是在带权二部图中寻找最佳一一匹配，也就是：</p> <div class=arithmatex>\[ \min_\pi \sum_{i=1}^n c_{i,\pi(i)} \]</div> <p>其中：</p> <ul> <li><span class=arithmatex>\(c_{i,j}\)</span> ：左顶点 <span class=arithmatex>\(i\)</span> 到右顶点 <span class=arithmatex>\(j\)</span> 的代价；</li> <li><span class=arithmatex>\(\pi(i)\)</span> ：表示 <span class=arithmatex>\(i\)</span> 被分配到的右顶点；</li> <li><span class=arithmatex>\(n\)</span> ：左、右两侧顶点数量相等（若不等可补零）。</li> </ul> <p>这就是<strong>最小代价匹配</strong>（minimum-cost perfect matching），也叫<strong>任务分配问题（Assignment Problem）</strong>。</p> <p>但如果要最大化权重问题，只需做简单变换：</p> <div class=arithmatex>\[ \max_{\pi} \sum_{i=1}^n w_{i,\pi(i)} \iff \min_{\pi} \sum_{i=1}^n (-w_{i,\pi(i)}) \]</div> <p>只要把代价矩阵 <code>cost = -weight</code>，再调用最小化版本的 KM 即可。</p> <p>因为很多 KM 实现（包括 <code>scipy</code>）不支持负权，因此通常加一个偏移量保证代价为正：</p> <div class=arithmatex>\[ c'_{i,j} = \max_w\{w_{i,j}\} \]</div> <p>这样一来，越大的权重对应越小的代价，KM 算法仍然能正确求出最大权匹配，且不会产生负数问题。</p> <h3 id=definition_1>Definition<a class=headerlink href=#definition_1 title="Permanent link">&para;</a></h3> <ul> <li>顶标：是一个节点函数 <span class=arithmatex>\(l:V\to\mathbb{R}\)</span> ，就是给每个顶点一个标号，可以简单理解为节点的值。</li> <li>可行顶标：对所有顶标都满足 <span class=arithmatex>\(l(x)+l(y)\geqslant w(x,y),\forall x\in X,y\in Y\)</span> ，也就是边的权值不能超过两个端点的顶标之和。KM 算法的顶标必须满足这一条件。</li> <li>相等子图：图 <span class=arithmatex>\(G=(V,E)\)</span> 的相等子图 <span class=arithmatex>\(G_l=(V,E_l)\)</span> ，包含 <span class=arithmatex>\(G\)</span> 的所有顶点，但是只包含边权值等于两个端点顶标之和的边，即 <span class=arithmatex>\(E_l=\{(x,y):l(x)+l(y)=w(x,y)\}\)</span> .</li> </ul> <blockquote> <p>Kuhn-Munkres 定理</p> <p>如果 <span class=arithmatex>\(l\)</span> 是可行顶标， <span class=arithmatex>\(M\)</span> 是相等子图 <span class=arithmatex>\(E_l\)</span> 的完美匹配，那么 <span class=arithmatex>\(M\)</span> 是 <span class=arithmatex>\(G\)</span> 的最大权匹配</p> </blockquote> <p>证明：任取 <span class=arithmatex>\(G\)</span> 的一个完美匹配 <span class=arithmatex>\(M'\)</span> 都有不等式</p> <div class=arithmatex>\[ w(M')=\sum_{e\in M'}w(e)\leqslant \sum_{e\in M'}l(e_x)+l(e_y)=\sum_{v\in V}l(v) \]</div> <p>说明任何一个完美匹配的边权值之和的上界就是所有顶标和，也等于完美匹配 <span class=arithmatex>\(M\)</span> 的边权和，因此 <span class=arithmatex>\(M\)</span> 是 <span class=arithmatex>\(G\)</span> 的最大权值匹配。KM 定理将求最大权匹配问题转化成了求完美匹配问题。KM 算法的核心就在于寻找可行顶标，使得相等子图有完美匹配。可行顶标的修改过程中，每一步都运用了<strong>贪心</strong>的思想，这样我们的最终结果一定是最优的。</p> <h3 id=algorithm_1>Algorithm<a class=headerlink href=#algorithm_1 title="Permanent link">&para;</a></h3> <p>算法的大概框架为：</p> <ol> <li>给定初始的可行顶标 <span class=arithmatex>\(l\)</span> 和匹配 <span class=arithmatex>\(M\)</span> .</li> <li>当 <span class=arithmatex>\(M\)</span> 不是相等子图 <span class=arithmatex>\(E_l\)</span> 的完美匹配时，重复以下操作：<ul> <li>在 <span class=arithmatex>\(E_l\)</span> 中搜索增广路径，如果存在，取反使得匹配数增加1。</li> <li>如果搜索增广路径失败，将可行顶标 <span class=arithmatex>\(l\)</span> 改进为 <span class=arithmatex>\(l'\)</span> 使得 <span class=arithmatex>\(E_l\subset E_{l'}\)</span> ，然后再重新搜索。</li> </ul> </li> </ol> <p>如果 <span class=arithmatex>\(G\)</span> 存在完美匹配，那么每次迭代过程中，要么匹配数增加1，要么相等子图扩大，最终算法一定会停止，停止时的 <span class=arithmatex>\(M\)</span> 就是 <span class=arithmatex>\(E_l\)</span> 的完美匹配，也是 <span class=arithmatex>\(G\)</span> 的最大权匹配。</p> <hr> <p>初始时刻，我们构造一个简单的可行顶标： <span class=arithmatex>\(Y\)</span> 的顶标全部取0， <span class=arithmatex>\(X\)</span> 的顶标取每个点所连的边的最大权值</p> <div class=arithmatex>\[ \forall y\in Y,l(y)=0,\quad \forall x\in X,l(x)=\max_{y\in Y}\{w(x,y)\} \]</div> <p>这样显然满足可行顶标的要求。如果把这些最大权重对应的边找出来，其实就得到了相等子图。</p> <p>初始匹配可设置为空集 <span class=arithmatex>\(M=\varnothing\)</span> .</p> <p>改进可行顶标时，如果当前 <span class=arithmatex>\(M\)</span> 不是相等子图 <span class=arithmatex>\(E_l\)</span> 的完美匹配，是因为当前某个未匹配顶点（自由顶点） <span class=arithmatex>\(u\)</span> 出发，我们找不到它出发的一条增广路径，只能找到一个交替路径（以匹配的边和未匹配的边交替，但两端不都是自由顶点。至于为什么一定能找到交替路，稍后会解释）。我们定义 <span class=arithmatex>\(X\)</span> 中在交替路 <span class=arithmatex>\(P\)</span> 中的点集称为 <span class=arithmatex>\(S=\{x\mid x\in P\cap X\}\)</span> 、不在交替路中的点集为 <span class=arithmatex>\(S'=X\backslash S\)</span> ， <span class=arithmatex>\(Y\)</span> 中在交替路 <span class=arithmatex>\(P\)</span> 中的点集称为 <span class=arithmatex>\(T=\{y\mid y\in P\cap Y\}\)</span> 、不在交替路中的点集为 <span class=arithmatex>\(T'=Y\backslash T\)</span> .</p> <p>如果我们把交替路中 <span class=arithmatex>\(X\)</span> 集顶点的顶标全都减小某个值 <span class=arithmatex>\(\alpha_l\)</span> ，同时 <span class=arithmatex>\(Y\)</span> 集的顶标全都增加同一个值 <span class=arithmatex>\(\alpha_l\)</span> ，那么我们会发现：</p> <ul> <li>两端都在交替路中的边 <span class=arithmatex>\(e_{i \to j}\)</span> ， <span class=arithmatex>\(l(i)+l(j)\)</span> 的值不变。也就是说，它原来属于相等子图，现在仍属于相等子图。</li> <li>两端都不在交替路中的边 <span class=arithmatex>\(e_{i \to j}\)</span> ， <span class=arithmatex>\(l(i)+l(j)\)</span> 的值不变。也就是说，它原来属于（或不属于）相等子图，现在仍属于（或不属于）相等子图。</li> <li><span class=arithmatex>\(X\)</span> 端在 <span class=arithmatex>\(S'\)</span> 中， <span class=arithmatex>\(Y\)</span> 端在 <span class=arithmatex>\(T\)</span> 中的边 <span class=arithmatex>\(e_{i \to j}\)</span> ，它的 <span class=arithmatex>\(l(i)+l(j)\)</span> 的值增大。也就是说，它原来不属于相等子图，现在仍不可能属于相等子图。</li> <li><span class=arithmatex>\(X\)</span> 端在 <span class=arithmatex>\(S\)</span> 中， <span class=arithmatex>\(Y\)</span> 端在 <span class=arithmatex>\(T'\)</span> 中的边 <span class=arithmatex>\(e_{i \to j}\)</span> ，它的 <span class=arithmatex>\(l(i)+l(j)\)</span> 的值减小。也就是说，它原来不属于相等子图，现在可能进入了相等子图，因而使相等子图得扩大。</li> </ul> <p>也就是说，只有 <span class=arithmatex>\(X\)</span> 集一端在 <span class=arithmatex>\(S\)</span> 中， <span class=arithmatex>\(Y\)</span> 端在 <span class=arithmatex>\(T'\)</span> 中的边才有可能被选中。继续贪心，我们只选择满足条件的边权最大的边被选中，即满足 <span class=arithmatex>\(l(x)+ l(y) = w(x,y)\)</span> ，那么就应该取 <span class=arithmatex>\(\alpha_l= \min\{l(x) + l(y) - w(x,y) \mid x \in S, y \in T'\}\)</span> .</p> <p>然后给所有顶点赋新的顶标：</p> <div class=arithmatex>\[ l'(v)=\begin{cases} l(v)-\alpha_l, &amp;v\in S \\ l(v)+\alpha_l,&amp; v\in T \\ l(v),&amp;\text{else} \end{cases} \]</div> <p><span class=arithmatex>\(l'\)</span> 也是一个可行顶标。于是有新的边加入相等子图，我们可以继续对未匹配顶点 <span class=arithmatex>\(u\)</span> 寻找增广路。这样的修改最多进行 <span class=arithmatex>\(O(n)\)</span> 次，而一共有 <span class=arithmatex>\(n\)</span> 个点，所以除去修改顶标的时间，复杂度已经达到 <span class=arithmatex>\(O(n^2)\)</span> 。因此，算法的复杂度主要取决于修改顶标的时间。</p> <p>思路一：枚举所有 <span class=arithmatex>\(n^2\)</span> 条边，看是否满足条件，满足条件就更新 <span class=arithmatex>\(\alpha_l\)</span> 值。该方法最直观清晰，然而总的复杂度高达至 <span class=arithmatex>\(O(|V|^4)\)</span> 。</p> <p>思路二：对于 <span class=arithmatex>\(T'\)</span> 的每个点 <span class=arithmatex>\(v\)</span> ，定义松弛变量 <span class=arithmatex>\(slack(v)=\min\{l(x) + l(y) - w(x,y)\mid x \in S \}\)</span>，这个松弛变量在匹配的过程中就可以更新，修改顶标的过程中 <span class=arithmatex>\(\alpha_l=\min\{ slack(v) \mid v \in T' \}\)</span> ，总复杂度 <span class=arithmatex>\(O(|V|^3)\)</span> 。这样做但不是严格的，但实际上已经够用。</p> <p><br></p> <p>最终的伪代码如下：</p> <ol> <li> <p>初始化可行顶标 <span class=arithmatex>\(l\)</span> 和相等子图 <span class=arithmatex>\(E_l\)</span> 的初始匹配 <span class=arithmatex>\(M\)</span> ：</p> <div class=arithmatex>\[ \forall y\in Y,\;l(y)=0,\quad \forall x\in X,\;l(x)=\max_{y\in Y}\{w(x,y)\},\quad M=\varnothing \]</div> </li> <li> <p>若 <span class=arithmatex>\(M\)</span> 是 <span class=arithmatex>\(E_l\)</span> 的完美匹配，终止算法。否则选取自由顶点 <span class=arithmatex>\(u\in X\)</span> ，令 <span class=arithmatex>\(S=\{u\},\;T=\varnothing\)</span> .</p> </li> <li> <p>若 <span class=arithmatex>\(N_l(S)=T\)</span> ，更新可行顶标：</p> <div class=arithmatex>\[ \alpha_l= \min_{x \in S, y \in Y\backslash T} \{l(x) + l(y) - w(x,y)\},\quad l'(v)=\begin{cases} l(v)-\alpha_l, &amp;v\in S \\ l(v)+\alpha_l,&amp; v\in T \\ l(v),&amp;\text{else} \end{cases} \]</div> </li> <li> <p>若 <span class=arithmatex>\(N_l(S)\neq T\)</span> ，取 <span class=arithmatex>\(v\in Y\backslash T\)</span> ：</p> <ul> <li>若 <span class=arithmatex>\(v\)</span> 是自由顶点，那么找到了一条 <span class=arithmatex>\(u\to v\)</span> 的增广路径，取反使匹配数增加1，跳转至 Step 2。</li> <li>若 <span class=arithmatex>\(v\)</span> 不是自由顶点，设当前 <span class=arithmatex>\(v\)</span> 已经和 <span class=arithmatex>\(z\)</span> 匹配，则令 <span class=arithmatex>\(S=S\cup\{z\},\;T=T\cup\{v\}\)</span> ，跳转至 Step 3。</li> </ul> </li> </ol> <h3 id=code_1>Code<a class=headerlink href=#code_1 title="Permanent link">&para;</a></h3> <p>TODO</p> <h2 id=munkres-algorithm-assignment-problem>Munkres Algorithm (Assignment Problem)<a class=headerlink href=#munkres-algorithm-assignment-problem title="Permanent link">&para;</a></h2> <p>之前的 Kuhn-Munkres Algorithm 中，是以图论的方法，解决最大权重/最小代价问题。而一般考虑 Assignment Problem 时，常使用矩阵下的匈牙利算法，也就是 Munkres Algorithm（matrix reduction）。</p> <blockquote> <p>以下部分内容跟参考自：</p> <p><a href=https://zhuanlan.zhihu.com/p/668517725>二分图匹配---Munkres算法 - 知乎 Zhihu</a></p> <p><a href=https://www.jarvis73.com/2022/05/23/Hungarian/ >匈牙利算法 (Hungarian Algorithm) - Jarvis's Blog</a></p> <p><a href=https://zhuanlan.zhihu.com/p/571623539>多目标跟踪数据关联之匈牙利算法 - 知乎 Zhihu</a></p> </blockquote> <h3 id=description>Description<a class=headerlink href=#description title="Permanent link">&para;</a></h3> <p>在任务指派问题（如 n 项工作由 n 个人承担，每个人完成不同工作所花时间不同，那如何分配使得花费的时间最少）以及一些多目标检测任务中的数据关联部分（如一个目标有多个特征点，有多个目标时检测到的特征点属于哪一个目标的问题）常常会看到 Munkres 算法，二分图匹配同样可以转换为指派问题，即将一侧的图看成工人，将另一侧的图看成任务，图与图之间的相似度可以转换成矩阵系数。</p> <p>Munkres 算法的条件为：</p> <ul> <li>系数矩阵（代价矩阵） <span class=arithmatex>\(C\in \mathbb{R}^{n\times n}\)</span> 为 <span class=arithmatex>\(n\)</span> 阶方阵，这样才可能存在完美匹配。</li> <li>每一个系数为非负数 <span class=arithmatex>\(c_{ij}&gt;0\)</span> .</li> <li>求解目标为总代价的最小值。</li> </ul> <p>定义变量：</p> <div class=arithmatex>\[ x_{ij}=\begin{cases} 1, &amp;\text{指派第 i 个人完成第 j 项任务} \\ 0, &amp;\text{不指派第 i 个人完成第 j 项任务} \end{cases} \]</div> <p>问题转化为：</p> <div class=arithmatex>\[ \min\sum_{i=1}^n\sum_{j=1}^n c_{ij}x_{ij}, \quad \begin{cases} \sum_{i=1}^n x_{ij}=1 \\ \sum_{j=1}^n x_{ij}=1 \\ x_{ij}=0 \text{ or } 1 \end{cases} \]</div> <p>也就是每一个人只能完成一项任务，每一项任务只能有一个任务完成，保证一一对应、完美匹配，体现在 <span class=arithmatex>\(X=(x_{ij})\)</span> 上就是每一行、每一列有且仅有 1 个 1，其余全为 0。</p> <h3 id=algorithm_2>Algorithm<a class=headerlink href=#algorithm_2 title="Permanent link">&para;</a></h3> <p>首先我们介绍图论中的柯尼希定理（注意，与运动学中多质点系统的柯尼希定理不同）：</p> <blockquote> <p>König's theorem：在二部分图中，最大匹配数等于最小顶点覆盖数。</p> <p>所谓一个顶点覆盖，是指顶点集的一个子集，图中每一条边都至少有一个顶点在这个子集中。</p> <p><a class=glightbox href=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251028202214.png data-type=image data-width=80% data-height=auto data-desc-position=bottom><img alt=20251028202214 src=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251028202214.png></a></p> <p>例如，在图中的二部图中，最大匹配（蓝边）和最小顶点覆盖（红点）数均为6。</p> <p>如果用矩阵的语言描述，就是：在一个 0-1 矩阵中，“互不在同一行同一列的0元素的最多个数”等于“能够覆盖所有 0 元素的最小直线（行或列）数”。</p> <p>匈牙利算法会对矩阵进行行列减法，使得部分元素变成 0。实际上，这些变成 0 的位置，就可以看作相等子图的一条边。而矩阵中一行或者一列所覆盖的零元素，就代表某个顶点所有的连接数。</p> </blockquote> <p>Mubkres 算法的具体步骤。</p> <ol> <li>代价矩阵初始化：<ul> <li>Row reduction：代价矩阵的每一行减去该行的最小值。</li> <li>Column reduction：代价矩阵的每一列减去该列的最小值。</li> <li> <blockquote> <p>这里用到的性质是，代价矩阵每一行或每一列减去一个相同的元素，最优解不变，因为最优解只关心如何分配指标和索引，不关心总代价的绝对大小。</p> </blockquote> </li> </ul> </li> <li>尝试分配寻找可行解：用最少的直线（横、竖）覆盖矩阵中所有0元素，如果直线个数等于矩阵的阶数 <span class=arithmatex>\(n\)</span> ，结束，否则执行 Step 3。</li> <li>找到未被覆盖元素中的最小值 <span class=arithmatex>\(k\)</span> ，所有未被覆盖的元素减去 <span class=arithmatex>\(k\)</span> ，被覆盖两次的元素加上 <span class=arithmatex>\(k\)</span> ，然后跳转至 Step 2。</li> </ol> <p>下面看一个示例。我们有一个航迹测量代价矩阵，矩阵中元素表示航迹测量的匹配距离。</p> <p><a class=glightbox href=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251028211155.png data-type=image data-width=80% data-height=auto data-desc-position=bottom><img alt=20251028211155 src=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251028211155.png></a></p> <p>按照上述步骤，求解最小代价匹配的过程为：</p> <p><a class=glightbox href=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251028211711.png data-type=image data-width=80% data-height=auto data-desc-position=bottom><img alt=20251028211711 src=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251028211711.png></a></p> <hr> <p>上述过程比较直观易懂，但是问题在于，虽然人眼可以看出哪些直线可以覆盖所有的0，但是体现在代码上，如何找出覆盖所有0的最小的直线？</p> <p>1957 年 James Munkres 引入了“标星 0（starred zeros）”和“标撇 0（primed zeros）”的概念以改进匈牙利算法原始流程中的划线法，在算法执行过程中会选择性地对代价矩阵中产生的 0 元素标记星号（*）或标记撇号（’）来辅助搜索增广路，标星 0 表示增广路中的匹配边，标撇 0 表示增广路中的未匹配边。</p> <p>改进后的 Munkres 算法流程为：</p> <ol> <li>代价矩阵初始化：<ul> <li>Row reduction：代价矩阵的每一行减去该行的最小值。</li> <li>Column reduction：代价矩阵的每一列减去该列的最小值。</li> </ul> </li> <li>Star zeros（目标：在每一行放置互不冲突的 star，作为匹配的雏形）<ul> <li>逐行扫描矩阵，在每一行中，找到“不在 star 占用的列中的0”，找到的第一个对它标记 star，并标记这个 star 所在行和列都被覆盖，继续下一行。</li> <li>扫描完成后，如果所有 star 占用的列数等于矩阵的阶数 <span class=arithmatex>\(n\)</span> ，说明每一列都有一个 star，已经完成一一配对，终止算法。</li> <li>如果 star 没有覆盖全部的列，进入 Step 3。</li> </ul> </li> <li>Priming &amp; Augmentation：循环进行以下操作：<ul> <li>在未被之前行和列覆盖的元素中，找到一个0并标记 prime，并查看这一行后是否有 star。如果没找到 0，直接进入 Step 4。</li> <li>如果这一行没有 star，意味着找到了一条增广路径。构建增广路径：该 prime 为路径的首条边，若 prime 所在的列存在 star 则把 star 加入路径，若 star 所在的行存在 prime 则把 prime 加入路径，直到找不到 star 为止。把<strong>路径中</strong>所有 prime 变为 star，取消<strong>路径中</strong>所有 star 标记，然后清除<strong>所有</strong> prime，取消所有行覆盖。最后，检查所有 star 覆盖的列数是否等于矩阵阶数 <span class=arithmatex>\(n\)</span> ，如果等于，则找到完美匹配，终止算法，否则重新 Priming。</li> <li> <blockquote> <p>实际上，star 代表着暂时处于匹配中，prime 代表可能称为新的匹配，如果此时新加的 prime 的这一行没有 star，代表 prime 恰好比 star 多一个，也就构成了一条增广路径。这条增广路径从一个 prime 开始，找到同一列的 star，再从这个 star 找同一行的 prime，如此交替，知道遇到一个 prime 它所在的列没有 star。</p> </blockquote> </li> <li>如果这一行已有 star，就盖住这一行（行覆盖），把那个已有 star 所在的列取消列覆盖，重新回到这一步的开始“寻找未覆盖元素中的 0 标记 prime”。</li> </ul> </li> <li>生成新 0：找出未覆盖元素的最小值 <span class=arithmatex>\(d\)</span> ，当前所有未覆盖元素都减去 <span class=arithmatex>\(d\)</span> ，所有交叉覆盖（同时被行覆盖和列覆盖）的元素都加上 <span class=arithmatex>\(d\)</span> ，其余元素不变。这样就能在未覆盖区域生成新的 0，然后开始 Step 3 的 Priming。</li> </ol> <p>接着上面的例子，使用改进算法的流程为（第一步进行了膨胀补 0，保证代价矩阵为方阵） ：</p> <p><a class=glightbox href=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251028223755.png data-type=image data-width=80% data-height=auto data-desc-position=bottom><img alt=20251028223755 src=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251028223755.png></a></p> <h3 id=follow-up-problems>Follow-up problems<a class=headerlink href=#follow-up-problems title="Permanent link">&para;</a></h3> <p>（1）如果不是求最小代价，是求最大代价，如何处理？</p> <p>找出代价矩阵中的最大值 max，然后令代价矩阵变为“max-代价矩阵各元素值”，得到新代价矩阵，再按照正常匈牙利法求解。</p> <p>（2）如果系数矩阵不是方阵？</p> <ul> <li>人数 &gt; 工作：增加虚拟工作，虚拟工作对应的代价全设为0。</li> <li>人数 &lt; 工作：增加虚拟工人，虚拟工人对应的代价全设为0。</li> </ul> <p>（3）如果某个人可以做多项工作？</p> <p>如果一个工人可以做 <span class=arithmatex>\(k\)</span> 件事，那就把这个工人的代价复制 <span class=arithmatex>\(k\)</span> 份，相当于增加了虚拟人数。如果不是方阵，再添加虚拟工作。</p> <p>（4）如果某个人不能做某项工作？</p> <p>将问题转换为求最小值后，如果第 <span class=arithmatex>\(i\)</span> 个人不能做第 <span class=arithmatex>\(j\)</span> 项工作，可将代价 <span class=arithmatex>\(c_{ij}\)</span> 设置为一个比代价矩阵最大值更大的数。</p> <h3 id=code_2>Code<a class=headerlink href=#code_2 title="Permanent link">&para;</a></h3> <p>下面分别给出 Munkres 算法的 Python 和 C++ 实现。其中 Python SciPy 库提供了 <code>scipy.optimize.linear_sum_assignment()</code> 函数可以直接调用，最为简单。</p> <p>其中，C++ 的实现还可以参考 <a href=https://brc2.com/the-algorithm-workshop/ >Munkres’ Assignment Algorithm - The Algorithm Workshop - Bevilacqua</a></p> <div class="tabbed-set tabbed-alternate" data-tabs=2:3><input checked=checked id=code_2-python name=__tabbed_2 type=radio><input id=code_2-pythonusing-scipy name=__tabbed_2 type=radio><input id=code_2-c name=__tabbed_2 type=radio><div class=tabbed-labels><label for=code_2-python>Python</label><label for=code_2-pythonusing-scipy>Python(using SciPy)</label><label for=code_2-c>C++</label></div> <div class=tabbed-content> <div class=tabbed-block> <div class="language-py highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1></a><a href=#__codelineno-3-1><span class=linenos data-linenos="  1 "></span></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2></a><a href=#__codelineno-3-2><span class=linenos data-linenos="  2 "></span></a>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3></a><a href=#__codelineno-3-3><span class=linenos data-linenos="  3 "></span></a>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4></a><a href=#__codelineno-3-4><span class=linenos data-linenos="  4 "></span></a><span class=k>def</span><span class=w> </span><span class=nf>hungarian</span><span class=p>(</span><span class=n>cost</span><span class=p>):</span>
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5></a><a href=#__codelineno-3-5><span class=linenos data-linenos="  5 "></span></a>    <span class=n>cost</span> <span class=o>=</span> <span class=n>cost</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=nb>float</span><span class=p>)</span>
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6></a><a href=#__codelineno-3-6><span class=linenos data-linenos="  6 "></span></a>    <span class=n>n</span> <span class=o>=</span> <span class=n>cost</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7></a><a href=#__codelineno-3-7><span class=linenos data-linenos="  7 "></span></a>
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8></a><a href=#__codelineno-3-8><span class=linenos data-linenos="  8 "></span></a>    <span class=c1># Step 1: 行列减法</span>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9></a><a href=#__codelineno-3-9><span class=linenos data-linenos="  9 "></span></a>    <span class=n>cost</span> <span class=o>-=</span> <span class=n>cost</span><span class=o>.</span><span class=n>min</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span> <span class=n>keepdims</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-3-10><a id=__codelineno-3-10 name=__codelineno-3-10></a><a href=#__codelineno-3-10><span class=linenos data-linenos=" 10 "></span></a>    <span class=n>cost</span> <span class=o>-=</span> <span class=n>cost</span><span class=o>.</span><span class=n>min</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>keepdims</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span><span id=__span-3-11><a id=__codelineno-3-11 name=__codelineno-3-11></a><a href=#__codelineno-3-11><span class=linenos data-linenos=" 11 "></span></a>
</span><span id=__span-3-12><a id=__codelineno-3-12 name=__codelineno-3-12></a><a href=#__codelineno-3-12><span class=linenos data-linenos=" 12 "></span></a>    <span class=c1># 初始化标记矩阵：0=无标记, 1=star, 2=prime</span>
</span><span id=__span-3-13><a id=__codelineno-3-13 name=__codelineno-3-13></a><a href=#__codelineno-3-13><span class=linenos data-linenos=" 13 "></span></a>    <span class=n>mark</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>cost</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
</span><span id=__span-3-14><a id=__codelineno-3-14 name=__codelineno-3-14></a><a href=#__codelineno-3-14><span class=linenos data-linenos=" 14 "></span></a>    <span class=n>row_cover</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>bool</span><span class=p>)</span>
</span><span id=__span-3-15><a id=__codelineno-3-15 name=__codelineno-3-15></a><a href=#__codelineno-3-15><span class=linenos data-linenos=" 15 "></span></a>    <span class=n>col_cover</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>bool</span><span class=p>)</span>
</span><span id=__span-3-16><a id=__codelineno-3-16 name=__codelineno-3-16></a><a href=#__codelineno-3-16><span class=linenos data-linenos=" 16 "></span></a>
</span><span id=__span-3-17><a id=__codelineno-3-17 name=__codelineno-3-17></a><a href=#__codelineno-3-17><span class=linenos data-linenos=" 17 "></span></a>    <span class=c1># Step 2: 初始打星</span>
</span><span id=__span-3-18><a id=__codelineno-3-18 name=__codelineno-3-18></a><a href=#__codelineno-3-18><span class=linenos data-linenos=" 18 "></span></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span><span id=__span-3-19><a id=__codelineno-3-19 name=__codelineno-3-19></a><a href=#__codelineno-3-19><span class=linenos data-linenos=" 19 "></span></a>        <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span><span id=__span-3-20><a id=__codelineno-3-20 name=__codelineno-3-20></a><a href=#__codelineno-3-20><span class=linenos data-linenos=" 20 "></span></a>            <span class=k>if</span> <span class=n>cost</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>row_cover</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>col_cover</span><span class=p>[</span><span class=n>j</span><span class=p>]:</span>
</span><span id=__span-3-21><a id=__codelineno-3-21 name=__codelineno-3-21></a><a href=#__codelineno-3-21><span class=linenos data-linenos=" 21 "></span></a>                <span class=n>mark</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span>  <span class=c1># star</span>
</span><span id=__span-3-22><a id=__codelineno-3-22 name=__codelineno-3-22></a><a href=#__codelineno-3-22><span class=linenos data-linenos=" 22 "></span></a>                <span class=n>row_cover</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>col_cover</span><span class=p>[</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-3-23><a id=__codelineno-3-23 name=__codelineno-3-23></a><a href=#__codelineno-3-23><span class=linenos data-linenos=" 23 "></span></a>                <span class=k>break</span>
</span><span id=__span-3-24><a id=__codelineno-3-24 name=__codelineno-3-24></a><a href=#__codelineno-3-24><span class=linenos data-linenos=" 24 "></span></a>    <span class=n>row_cover</span><span class=p>[:]</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-3-25><a id=__codelineno-3-25 name=__codelineno-3-25></a><a href=#__codelineno-3-25><span class=linenos data-linenos=" 25 "></span></a>    <span class=n>col_cover</span><span class=p>[:]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>mark</span> <span class=o>==</span> <span class=mi>1</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-3-26><a id=__codelineno-3-26 name=__codelineno-3-26></a><a href=#__codelineno-3-26><span class=linenos data-linenos=" 26 "></span></a>
</span><span id=__span-3-27><a id=__codelineno-3-27 name=__codelineno-3-27></a><a href=#__codelineno-3-27><span class=linenos data-linenos=" 27 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>find_zero</span><span class=p>():</span>
</span><span id=__span-3-28><a id=__codelineno-3-28 name=__codelineno-3-28></a><a href=#__codelineno-3-28><span class=linenos data-linenos=" 28 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;未覆盖区域内搜索0，返回矩阵索引&quot;&quot;&quot;</span>
</span><span id=__span-3-29><a id=__codelineno-3-29 name=__codelineno-3-29></a><a href=#__codelineno-3-29><span class=linenos data-linenos=" 29 "></span></a>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span><span id=__span-3-30><a id=__codelineno-3-30 name=__codelineno-3-30></a><a href=#__codelineno-3-30><span class=linenos data-linenos=" 30 "></span></a>            <span class=k>if</span> <span class=ow>not</span> <span class=n>row_cover</span><span class=p>[</span><span class=n>i</span><span class=p>]:</span>
</span><span id=__span-3-31><a id=__codelineno-3-31 name=__codelineno-3-31></a><a href=#__codelineno-3-31><span class=linenos data-linenos=" 31 "></span></a>                <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span><span id=__span-3-32><a id=__codelineno-3-32 name=__codelineno-3-32></a><a href=#__codelineno-3-32><span class=linenos data-linenos=" 32 "></span></a>                    <span class=k>if</span> <span class=n>cost</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>and</span> <span class=ow>not</span> <span class=n>col_cover</span><span class=p>[</span><span class=n>j</span><span class=p>]:</span>
</span><span id=__span-3-33><a id=__codelineno-3-33 name=__codelineno-3-33></a><a href=#__codelineno-3-33><span class=linenos data-linenos=" 33 "></span></a>                        <span class=k>return</span> <span class=n>i</span><span class=p>,</span> <span class=n>j</span>
</span><span id=__span-3-34><a id=__codelineno-3-34 name=__codelineno-3-34></a><a href=#__codelineno-3-34><span class=linenos data-linenos=" 34 "></span></a>        <span class=k>return</span> <span class=kc>None</span><span class=p>,</span> <span class=kc>None</span>
</span><span id=__span-3-35><a id=__codelineno-3-35 name=__codelineno-3-35></a><a href=#__codelineno-3-35><span class=linenos data-linenos=" 35 "></span></a>
</span><span id=__span-3-36><a id=__codelineno-3-36 name=__codelineno-3-36></a><a href=#__codelineno-3-36><span class=linenos data-linenos=" 36 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>find_star_in_row</span><span class=p>(</span><span class=n>r</span><span class=p>):</span>
</span><span id=__span-3-37><a id=__codelineno-3-37 name=__codelineno-3-37></a><a href=#__codelineno-3-37><span class=linenos data-linenos=" 37 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;某一行中搜素第一个 star zero&quot;&quot;&quot;</span>
</span><span id=__span-3-38><a id=__codelineno-3-38 name=__codelineno-3-38></a><a href=#__codelineno-3-38><span class=linenos data-linenos=" 38 "></span></a>        <span class=n>c</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>mark</span><span class=p>[</span><span class=n>r</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-3-39><a id=__codelineno-3-39 name=__codelineno-3-39></a><a href=#__codelineno-3-39><span class=linenos data-linenos=" 39 "></span></a>        <span class=k>return</span> <span class=n>c</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=k>if</span> <span class=n>c</span><span class=o>.</span><span class=n>size</span> <span class=k>else</span> <span class=kc>None</span>
</span><span id=__span-3-40><a id=__codelineno-3-40 name=__codelineno-3-40></a><a href=#__codelineno-3-40><span class=linenos data-linenos=" 40 "></span></a>
</span><span id=__span-3-41><a id=__codelineno-3-41 name=__codelineno-3-41></a><a href=#__codelineno-3-41><span class=linenos data-linenos=" 41 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>find_star_in_col</span><span class=p>(</span><span class=n>c</span><span class=p>):</span>
</span><span id=__span-3-42><a id=__codelineno-3-42 name=__codelineno-3-42></a><a href=#__codelineno-3-42><span class=linenos data-linenos=" 42 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;某一列中搜索第一个 star zero&quot;&quot;&quot;</span>
</span><span id=__span-3-43><a id=__codelineno-3-43 name=__codelineno-3-43></a><a href=#__codelineno-3-43><span class=linenos data-linenos=" 43 "></span></a>        <span class=n>r</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>mark</span><span class=p>[:,</span> <span class=n>c</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-3-44><a id=__codelineno-3-44 name=__codelineno-3-44></a><a href=#__codelineno-3-44><span class=linenos data-linenos=" 44 "></span></a>        <span class=k>return</span> <span class=n>r</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=k>if</span> <span class=n>r</span><span class=o>.</span><span class=n>size</span> <span class=k>else</span> <span class=kc>None</span>
</span><span id=__span-3-45><a id=__codelineno-3-45 name=__codelineno-3-45></a><a href=#__codelineno-3-45><span class=linenos data-linenos=" 45 "></span></a>
</span><span id=__span-3-46><a id=__codelineno-3-46 name=__codelineno-3-46></a><a href=#__codelineno-3-46><span class=linenos data-linenos=" 46 "></span></a>    <span class=k>def</span><span class=w> </span><span class=nf>find_prime_in_row</span><span class=p>(</span><span class=n>r</span><span class=p>):</span>
</span><span id=__span-3-47><a id=__codelineno-3-47 name=__codelineno-3-47></a><a href=#__codelineno-3-47><span class=linenos data-linenos=" 47 "></span></a><span class=w>        </span><span class=sd>&quot;&quot;&quot;某一行中搜索第一个 prime zero&quot;&quot;&quot;</span>
</span><span id=__span-3-48><a id=__codelineno-3-48 name=__codelineno-3-48></a><a href=#__codelineno-3-48><span class=linenos data-linenos=" 48 "></span></a>        <span class=n>c</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>mark</span><span class=p>[</span><span class=n>r</span><span class=p>]</span> <span class=o>==</span> <span class=mi>2</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-3-49><a id=__codelineno-3-49 name=__codelineno-3-49></a><a href=#__codelineno-3-49><span class=linenos data-linenos=" 49 "></span></a>        <span class=k>return</span> <span class=n>c</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=k>if</span> <span class=n>c</span><span class=o>.</span><span class=n>size</span> <span class=k>else</span> <span class=kc>None</span>
</span><span id=__span-3-50><a id=__codelineno-3-50 name=__codelineno-3-50></a><a href=#__codelineno-3-50><span class=linenos data-linenos=" 50 "></span></a>
</span><span id=__span-3-51><a id=__codelineno-3-51 name=__codelineno-3-51></a><a href=#__codelineno-3-51><span class=linenos data-linenos=" 51 "></span></a>    <span class=c1># Step 3 + Step 4 主循环</span>
</span><span id=__span-3-52><a id=__codelineno-3-52 name=__codelineno-3-52></a><a href=#__codelineno-3-52><span class=linenos data-linenos=" 52 "></span></a>    <span class=k>while</span> <span class=n>col_cover</span><span class=o>.</span><span class=n>sum</span><span class=p>()</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>:</span>
</span><span id=__span-3-53><a id=__codelineno-3-53 name=__codelineno-3-53></a><a href=#__codelineno-3-53><span class=linenos data-linenos=" 53 "></span></a>        <span class=c1># 寻找未覆盖的0</span>
</span><span id=__span-3-54><a id=__codelineno-3-54 name=__codelineno-3-54></a><a href=#__codelineno-3-54><span class=linenos data-linenos=" 54 "></span></a>        <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span><span id=__span-3-55><a id=__codelineno-3-55 name=__codelineno-3-55></a><a href=#__codelineno-3-55><span class=linenos data-linenos=" 55 "></span></a>            <span class=n>r</span><span class=p>,</span> <span class=n>c</span> <span class=o>=</span> <span class=n>find_zero</span><span class=p>()</span>
</span><span id=__span-3-56><a id=__codelineno-3-56 name=__codelineno-3-56></a><a href=#__codelineno-3-56><span class=linenos data-linenos=" 56 "></span></a>            <span class=k>if</span> <span class=n>r</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-3-57><a id=__codelineno-3-57 name=__codelineno-3-57></a><a href=#__codelineno-3-57><span class=linenos data-linenos=" 57 "></span></a>                <span class=c1># Step 4: 生成新0</span>
</span><span id=__span-3-58><a id=__codelineno-3-58 name=__codelineno-3-58></a><a href=#__codelineno-3-58><span class=linenos data-linenos=" 58 "></span></a>                <span class=n>d</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>min</span><span class=p>(</span><span class=n>cost</span><span class=p>[</span><span class=o>~</span><span class=n>row_cover</span><span class=p>][:,</span> <span class=o>~</span><span class=n>col_cover</span><span class=p>])</span>
</span><span id=__span-3-59><a id=__codelineno-3-59 name=__codelineno-3-59></a><a href=#__codelineno-3-59><span class=linenos data-linenos=" 59 "></span></a>                <span class=n>cost</span><span class=p>[</span><span class=o>~</span><span class=n>row_cover</span><span class=p>,</span> <span class=p>:]</span> <span class=o>-=</span> <span class=n>d</span>
</span><span id=__span-3-60><a id=__codelineno-3-60 name=__codelineno-3-60></a><a href=#__codelineno-3-60><span class=linenos data-linenos=" 60 "></span></a>                <span class=n>cost</span><span class=p>[:,</span> <span class=n>col_cover</span><span class=p>]</span> <span class=o>+=</span> <span class=n>d</span>
</span><span id=__span-3-61><a id=__codelineno-3-61 name=__codelineno-3-61></a><a href=#__codelineno-3-61><span class=linenos data-linenos=" 61 "></span></a>            <span class=k>else</span><span class=p>:</span>
</span><span id=__span-3-62><a id=__codelineno-3-62 name=__codelineno-3-62></a><a href=#__codelineno-3-62><span class=linenos data-linenos=" 62 "></span></a>                <span class=n>mark</span><span class=p>[</span><span class=n>r</span><span class=p>,</span> <span class=n>c</span><span class=p>]</span> <span class=o>=</span> <span class=mi>2</span>  <span class=c1># prime</span>
</span><span id=__span-3-63><a id=__codelineno-3-63 name=__codelineno-3-63></a><a href=#__codelineno-3-63><span class=linenos data-linenos=" 63 "></span></a>                <span class=n>star_c</span> <span class=o>=</span> <span class=n>find_star_in_row</span><span class=p>(</span><span class=n>r</span><span class=p>)</span>
</span><span id=__span-3-64><a id=__codelineno-3-64 name=__codelineno-3-64></a><a href=#__codelineno-3-64><span class=linenos data-linenos=" 64 "></span></a>                <span class=k>if</span> <span class=n>star_c</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-3-65><a id=__codelineno-3-65 name=__codelineno-3-65></a><a href=#__codelineno-3-65><span class=linenos data-linenos=" 65 "></span></a>                    <span class=c1># 构建增广路径</span>
</span><span id=__span-3-66><a id=__codelineno-3-66 name=__codelineno-3-66></a><a href=#__codelineno-3-66><span class=linenos data-linenos=" 66 "></span></a>                    <span class=n>path</span> <span class=o>=</span> <span class=p>[(</span><span class=n>r</span><span class=p>,</span> <span class=n>c</span><span class=p>)]</span>
</span><span id=__span-3-67><a id=__codelineno-3-67 name=__codelineno-3-67></a><a href=#__codelineno-3-67><span class=linenos data-linenos=" 67 "></span></a>                    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span><span id=__span-3-68><a id=__codelineno-3-68 name=__codelineno-3-68></a><a href=#__codelineno-3-68><span class=linenos data-linenos=" 68 "></span></a>                        <span class=n>star_r</span> <span class=o>=</span> <span class=n>find_star_in_col</span><span class=p>(</span><span class=n>path</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>])</span>
</span><span id=__span-3-69><a id=__codelineno-3-69 name=__codelineno-3-69></a><a href=#__codelineno-3-69><span class=linenos data-linenos=" 69 "></span></a>                        <span class=k>if</span> <span class=n>star_r</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span><span id=__span-3-70><a id=__codelineno-3-70 name=__codelineno-3-70></a><a href=#__codelineno-3-70><span class=linenos data-linenos=" 70 "></span></a>                            <span class=k>break</span>
</span><span id=__span-3-71><a id=__codelineno-3-71 name=__codelineno-3-71></a><a href=#__codelineno-3-71><span class=linenos data-linenos=" 71 "></span></a>                        <span class=n>path</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>star_r</span><span class=p>,</span> <span class=n>path</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>1</span><span class=p>]))</span>
</span><span id=__span-3-72><a id=__codelineno-3-72 name=__codelineno-3-72></a><a href=#__codelineno-3-72><span class=linenos data-linenos=" 72 "></span></a>                        <span class=n>prime_c</span> <span class=o>=</span> <span class=n>find_prime_in_row</span><span class=p>(</span><span class=n>path</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>])</span>
</span><span id=__span-3-73><a id=__codelineno-3-73 name=__codelineno-3-73></a><a href=#__codelineno-3-73><span class=linenos data-linenos=" 73 "></span></a>                        <span class=n>path</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>path</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=mi>0</span><span class=p>],</span> <span class=n>prime_c</span><span class=p>))</span>
</span><span id=__span-3-74><a id=__codelineno-3-74 name=__codelineno-3-74></a><a href=#__codelineno-3-74><span class=linenos data-linenos=" 74 "></span></a>                    <span class=c1># 翻转路径</span>
</span><span id=__span-3-75><a id=__codelineno-3-75 name=__codelineno-3-75></a><a href=#__codelineno-3-75><span class=linenos data-linenos=" 75 "></span></a>                    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>j</span> <span class=ow>in</span> <span class=n>path</span><span class=p>:</span>
</span><span id=__span-3-76><a id=__codelineno-3-76 name=__codelineno-3-76></a><a href=#__codelineno-3-76><span class=linenos data-linenos=" 76 "></span></a>                        <span class=n>mark</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span> <span class=k>if</span> <span class=n>mark</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>1</span> <span class=k>else</span> <span class=mi>0</span>
</span><span id=__span-3-77><a id=__codelineno-3-77 name=__codelineno-3-77></a><a href=#__codelineno-3-77><span class=linenos data-linenos=" 77 "></span></a>                    <span class=n>mark</span><span class=p>[</span><span class=n>mark</span> <span class=o>==</span> <span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span><span id=__span-3-78><a id=__codelineno-3-78 name=__codelineno-3-78></a><a href=#__codelineno-3-78><span class=linenos data-linenos=" 78 "></span></a>                    <span class=n>row_cover</span><span class=p>[:]</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-3-79><a id=__codelineno-3-79 name=__codelineno-3-79></a><a href=#__codelineno-3-79><span class=linenos data-linenos=" 79 "></span></a>                    <span class=n>col_cover</span><span class=p>[:]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>any</span><span class=p>(</span><span class=n>mark</span> <span class=o>==</span> <span class=mi>1</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-3-80><a id=__codelineno-3-80 name=__codelineno-3-80></a><a href=#__codelineno-3-80><span class=linenos data-linenos=" 80 "></span></a>                    <span class=k>break</span>
</span><span id=__span-3-81><a id=__codelineno-3-81 name=__codelineno-3-81></a><a href=#__codelineno-3-81><span class=linenos data-linenos=" 81 "></span></a>                <span class=k>else</span><span class=p>:</span>
</span><span id=__span-3-82><a id=__codelineno-3-82 name=__codelineno-3-82></a><a href=#__codelineno-3-82><span class=linenos data-linenos=" 82 "></span></a>                    <span class=n>row_cover</span><span class=p>[</span><span class=n>r</span><span class=p>]</span> <span class=o>=</span> <span class=kc>True</span>
</span><span id=__span-3-83><a id=__codelineno-3-83 name=__codelineno-3-83></a><a href=#__codelineno-3-83><span class=linenos data-linenos=" 83 "></span></a>                    <span class=n>col_cover</span><span class=p>[</span><span class=n>star_c</span><span class=p>]</span> <span class=o>=</span> <span class=kc>False</span>
</span><span id=__span-3-84><a id=__codelineno-3-84 name=__codelineno-3-84></a><a href=#__codelineno-3-84><span class=linenos data-linenos=" 84 "></span></a>
</span><span id=__span-3-85><a id=__codelineno-3-85 name=__codelineno-3-85></a><a href=#__codelineno-3-85><span class=linenos data-linenos=" 85 "></span></a>    <span class=c1># 输出结果</span>
</span><span id=__span-3-86><a id=__codelineno-3-86 name=__codelineno-3-86></a><a href=#__codelineno-3-86><span class=linenos data-linenos=" 86 "></span></a>    <span class=n>result</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros</span><span class=p>(</span><span class=n>n</span><span class=p>,</span> <span class=n>dtype</span><span class=o>=</span><span class=nb>int</span><span class=p>)</span>
</span><span id=__span-3-87><a id=__codelineno-3-87 name=__codelineno-3-87></a><a href=#__codelineno-3-87><span class=linenos data-linenos=" 87 "></span></a>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span><span id=__span-3-88><a id=__codelineno-3-88 name=__codelineno-3-88></a><a href=#__codelineno-3-88><span class=linenos data-linenos=" 88 "></span></a>        <span class=n>j</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>mark</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)[</span><span class=mi>0</span><span class=p>][</span><span class=mi>0</span><span class=p>]</span>
</span><span id=__span-3-89><a id=__codelineno-3-89 name=__codelineno-3-89></a><a href=#__codelineno-3-89><span class=linenos data-linenos=" 89 "></span></a>        <span class=n>result</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>=</span> <span class=n>j</span>
</span><span id=__span-3-90><a id=__codelineno-3-90 name=__codelineno-3-90></a><a href=#__codelineno-3-90><span class=linenos data-linenos=" 90 "></span></a>    <span class=k>return</span> <span class=n>result</span>
</span><span id=__span-3-91><a id=__codelineno-3-91 name=__codelineno-3-91></a><a href=#__codelineno-3-91><span class=linenos data-linenos=" 91 "></span></a>
</span><span id=__span-3-92><a id=__codelineno-3-92 name=__codelineno-3-92></a><a href=#__codelineno-3-92><span class=linenos data-linenos=" 92 "></span></a>
</span><span id=__span-3-93><a id=__codelineno-3-93 name=__codelineno-3-93></a><a href=#__codelineno-3-93><span class=linenos data-linenos=" 93 "></span></a><span class=c1># 示例</span>
</span><span id=__span-3-94><a id=__codelineno-3-94 name=__codelineno-3-94></a><a href=#__codelineno-3-94><span class=linenos data-linenos=" 94 "></span></a><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
</span><span id=__span-3-95><a id=__codelineno-3-95 name=__codelineno-3-95></a><a href=#__codelineno-3-95><span class=linenos data-linenos=" 95 "></span></a>    <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-3-96><a id=__codelineno-3-96 name=__codelineno-3-96></a><a href=#__codelineno-3-96><span class=linenos data-linenos=" 96 "></span></a>    <span class=n>cost</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>))</span>
</span><span id=__span-3-97><a id=__codelineno-3-97 name=__codelineno-3-97></a><a href=#__codelineno-3-97><span class=linenos data-linenos=" 97 "></span></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;代价矩阵：</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>cost</span><span class=p>)</span>
</span><span id=__span-3-98><a id=__codelineno-3-98 name=__codelineno-3-98></a><a href=#__codelineno-3-98><span class=linenos data-linenos=" 98 "></span></a>    <span class=n>assign</span> <span class=o>=</span> <span class=n>hungarian</span><span class=p>(</span><span class=n>cost</span><span class=p>)</span>
</span><span id=__span-3-99><a id=__codelineno-3-99 name=__codelineno-3-99></a><a href=#__codelineno-3-99><span class=linenos data-linenos=" 99 "></span></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;最优匹配结果：&quot;</span><span class=p>)</span>
</span><span id=__span-3-100><a id=__codelineno-3-100 name=__codelineno-3-100></a><a href=#__codelineno-3-100><span class=linenos data-linenos="100 "></span></a>    <span class=k>for</span> <span class=n>i</span><span class=p>,</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>assign</span><span class=p>):</span>
</span><span id=__span-3-101><a id=__codelineno-3-101 name=__codelineno-3-101></a><a href=#__codelineno-3-101><span class=linenos data-linenos="101 "></span></a>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;行 </span><span class=si>{</span><span class=n>i</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=si>}</span><span class=s2> → 列 </span><span class=si>{</span><span class=n>j</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=si>}</span><span class=s2>, 代价 = </span><span class=si>{</span><span class=n>cost</span><span class=p>[</span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=n>j</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-3-102><a id=__codelineno-3-102 name=__codelineno-3-102></a><a href=#__codelineno-3-102><span class=linenos data-linenos="102 "></span></a>    <span class=nb>print</span><span class=p>(</span><span class=s2>&quot;总代价 =&quot;</span><span class=p>,</span> <span class=n>cost</span><span class=p>[</span><span class=nb>range</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=n>assign</span><span class=p>)),</span> <span class=n>assign</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>())</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-py highlight"><span class=filename>Python</span><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1></a><a href=#__codelineno-4-1><span class=linenos data-linenos=" 1 "></span></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2></a><a href=#__codelineno-4-2><span class=linenos data-linenos=" 2 "></span></a><span class=kn>from</span><span class=w> </span><span class=nn>scipy.optimize</span><span class=w> </span><span class=kn>import</span> <span class=n>linear_sum_assignment</span>
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3></a><a href=#__codelineno-4-3><span class=linenos data-linenos=" 3 "></span></a>
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4></a><a href=#__codelineno-4-4><span class=linenos data-linenos=" 4 "></span></a><span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5></a><a href=#__codelineno-4-5><span class=linenos data-linenos=" 5 "></span></a><span class=n>cost</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>21</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>10</span><span class=p>))</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6></a><a href=#__codelineno-4-6><span class=linenos data-linenos=" 6 "></span></a>
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7></a><a href=#__codelineno-4-7><span class=linenos data-linenos=" 7 "></span></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;代价矩阵：</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>,</span> <span class=n>cost</span><span class=p>)</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8></a><a href=#__codelineno-4-8><span class=linenos data-linenos=" 8 "></span></a>
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9></a><a href=#__codelineno-4-9><span class=linenos data-linenos=" 9 "></span></a>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10></a><a href=#__codelineno-4-10><span class=linenos data-linenos="10 "></span></a><span class=c1># 默认求最小代价，若求最大代价使用 -cost</span>
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11></a><a href=#__codelineno-4-11><span class=linenos data-linenos="11 "></span></a><span class=n>row_ind</span><span class=p>,</span> <span class=n>col_ind</span> <span class=o>=</span> <span class=n>linear_sum_assignment</span><span class=p>(</span><span class=n>cost</span><span class=p>)</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12></a><a href=#__codelineno-4-12><span class=linenos data-linenos="12 "></span></a>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13></a><a href=#__codelineno-4-13><span class=linenos data-linenos="13 "></span></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>最优匹配结果：&quot;</span><span class=p>)</span>
</span><span id=__span-4-14><a id=__codelineno-4-14 name=__codelineno-4-14></a><a href=#__codelineno-4-14><span class=linenos data-linenos="14 "></span></a><span class=k>for</span> <span class=n>r</span><span class=p>,</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>row_ind</span><span class=p>,</span> <span class=n>col_ind</span><span class=p>):</span>
</span><span id=__span-4-15><a id=__codelineno-4-15 name=__codelineno-4-15></a><a href=#__codelineno-4-15><span class=linenos data-linenos="15 "></span></a>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;行 </span><span class=si>{</span><span class=n>r</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=si>}</span><span class=s2> → 列 </span><span class=si>{</span><span class=n>c</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=si>}</span><span class=s2>, 代价 = </span><span class=si>{</span><span class=n>cost</span><span class=p>[</span><span class=n>r</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>]</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</span><span id=__span-4-16><a id=__codelineno-4-16 name=__codelineno-4-16></a><a href=#__codelineno-4-16><span class=linenos data-linenos="16 "></span></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;总代价 =&quot;</span><span class=p>,</span> <span class=n>cost</span><span class=p>[</span><span class=n>row_ind</span><span class=p>,</span> <span class=n>col_ind</span><span class=p>]</span><span class=o>.</span><span class=n>sum</span><span class=p>())</span>
</span></code></pre></div> </div> <div class=tabbed-block> <div class="language-cpp highlight"><span class=filename>C++</span><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1></a><a href=#__codelineno-5-1><span class=linenos data-linenos="  1 "></span></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iostream&gt;</span>
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2></a><a href=#__codelineno-5-2><span class=linenos data-linenos="  2 "></span></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;vector&gt;</span>
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3></a><a href=#__codelineno-5-3><span class=linenos data-linenos="  3 "></span></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;utility&gt;</span>
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4></a><a href=#__codelineno-5-4><span class=linenos data-linenos="  4 "></span></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;cstdlib&gt;</span>
</span><span id=__span-5-5><a id=__codelineno-5-5 name=__codelineno-5-5></a><a href=#__codelineno-5-5><span class=linenos data-linenos="  5 "></span></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;iomanip&gt;</span>
</span><span id=__span-5-6><a id=__codelineno-5-6 name=__codelineno-5-6></a><a href=#__codelineno-5-6><span class=linenos data-linenos="  6 "></span></a><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;cmath&gt;</span>
</span><span id=__span-5-7><a id=__codelineno-5-7 name=__codelineno-5-7></a><a href=#__codelineno-5-7><span class=linenos data-linenos="  7 "></span></a><span class=k>using</span><span class=w> </span><span class=k>namespace</span><span class=w> </span><span class=nn>std</span><span class=p>;</span>
</span><span id=__span-5-8><a id=__codelineno-5-8 name=__codelineno-5-8></a><a href=#__codelineno-5-8><span class=linenos data-linenos="  8 "></span></a>
</span><span id=__span-5-9><a id=__codelineno-5-9 name=__codelineno-5-9></a><a href=#__codelineno-5-9><span class=linenos data-linenos="  9 "></span></a><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=w> </span><span class=n>hungarian</span><span class=p>(</span><span class=k>const</span><span class=w> </span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=o>&amp;</span><span class=n>cost_matrix</span><span class=p>)</span>
</span><span id=__span-5-10><a id=__codelineno-5-10 name=__codelineno-5-10></a><a href=#__codelineno-5-10><span class=linenos data-linenos=" 10 "></span></a><span class=p>{</span>
</span><span id=__span-5-11><a id=__codelineno-5-11 name=__codelineno-5-11></a><a href=#__codelineno-5-11><span class=linenos data-linenos=" 11 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cost_matrix</span><span class=p>.</span><span class=n>size</span><span class=p>();</span>
</span><span id=__span-5-12><a id=__codelineno-5-12 name=__codelineno-5-12></a><a href=#__codelineno-5-12><span class=linenos data-linenos=" 12 "></span></a><span class=w>    </span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>cost</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>cost_matrix</span><span class=p>;</span>
</span><span id=__span-5-13><a id=__codelineno-5-13 name=__codelineno-5-13></a><a href=#__codelineno-5-13><span class=linenos data-linenos=" 13 "></span></a><span class=w>    </span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>mark</span><span class=p>(</span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=mi>0</span><span class=p>));</span><span class=w> </span><span class=c1>// 0=none, 1=star, 2=prime</span>
</span><span id=__span-5-14><a id=__codelineno-5-14 name=__codelineno-5-14></a><a href=#__codelineno-5-14><span class=linenos data-linenos=" 14 "></span></a><span class=w>    </span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>bool</span><span class=o>&gt;</span><span class=w> </span><span class=n>row_cover</span><span class=p>(</span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=nb>false</span><span class=p>),</span><span class=w> </span><span class=n>col_cover</span><span class=p>(</span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=nb>false</span><span class=p>);</span>
</span><span id=__span-5-15><a id=__codelineno-5-15 name=__codelineno-5-15></a><a href=#__codelineno-5-15><span class=linenos data-linenos=" 15 "></span></a>
</span><span id=__span-5-16><a id=__codelineno-5-16 name=__codelineno-5-16></a><a href=#__codelineno-5-16><span class=linenos data-linenos=" 16 "></span></a><span class=w>    </span><span class=c1>// ---- Step 1: Row &amp; Column reduction ----</span>
</span><span id=__span-5-17><a id=__codelineno-5-17 name=__codelineno-5-17></a><a href=#__codelineno-5-17><span class=linenos data-linenos=" 17 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-18><a id=__codelineno-5-18 name=__codelineno-5-18></a><a href=#__codelineno-5-18><span class=linenos data-linenos=" 18 "></span></a><span class=w>        </span><span class=kt>double</span><span class=w> </span><span class=n>minval</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>*</span><span class=n>min_element</span><span class=p>(</span><span class=n>cost</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>cost</span><span class=p>[</span><span class=n>i</span><span class=p>].</span><span class=n>end</span><span class=p>());</span>
</span><span id=__span-5-19><a id=__codelineno-5-19 name=__codelineno-5-19></a><a href=#__codelineno-5-19><span class=linenos data-linenos=" 19 "></span></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=n>cost</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>-=</span><span class=w> </span><span class=n>minval</span><span class=p>;</span>
</span><span id=__span-5-20><a id=__codelineno-5-20 name=__codelineno-5-20></a><a href=#__codelineno-5-20><span class=linenos data-linenos=" 20 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-5-21><a id=__codelineno-5-21 name=__codelineno-5-21></a><a href=#__codelineno-5-21><span class=linenos data-linenos=" 21 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-22><a id=__codelineno-5-22 name=__codelineno-5-22></a><a href=#__codelineno-5-22><span class=linenos data-linenos=" 22 "></span></a><span class=w>        </span><span class=kt>double</span><span class=w> </span><span class=n>minval</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>1e18</span><span class=p>;</span>
</span><span id=__span-5-23><a id=__codelineno-5-23 name=__codelineno-5-23></a><a href=#__codelineno-5-23><span class=linenos data-linenos=" 23 "></span></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=n>minval</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>min</span><span class=p>(</span><span class=n>minval</span><span class=p>,</span><span class=w> </span><span class=n>cost</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]);</span>
</span><span id=__span-5-24><a id=__codelineno-5-24 name=__codelineno-5-24></a><a href=#__codelineno-5-24><span class=linenos data-linenos=" 24 "></span></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=n>cost</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>-=</span><span class=w> </span><span class=n>minval</span><span class=p>;</span>
</span><span id=__span-5-25><a id=__codelineno-5-25 name=__codelineno-5-25></a><a href=#__codelineno-5-25><span class=linenos data-linenos=" 25 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-5-26><a id=__codelineno-5-26 name=__codelineno-5-26></a><a href=#__codelineno-5-26><span class=linenos data-linenos=" 26 "></span></a>
</span><span id=__span-5-27><a id=__codelineno-5-27 name=__codelineno-5-27></a><a href=#__codelineno-5-27><span class=linenos data-linenos=" 27 "></span></a><span class=w>    </span><span class=c1>// ---- Step 2: Star zeros ----</span>
</span><span id=__span-5-28><a id=__codelineno-5-28 name=__codelineno-5-28></a><a href=#__codelineno-5-28><span class=linenos data-linenos=" 28 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-5-29><a id=__codelineno-5-29 name=__codelineno-5-29></a><a href=#__codelineno-5-29><span class=linenos data-linenos=" 29 "></span></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-5-30><a id=__codelineno-5-30 name=__codelineno-5-30></a><a href=#__codelineno-5-30><span class=linenos data-linenos=" 30 "></span></a><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>fabs</span><span class=p>(</span><span class=n>cost</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>])</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mf>1e-9</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=o>!</span><span class=n>row_cover</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=o>!</span><span class=n>col_cover</span><span class=p>[</span><span class=n>j</span><span class=p>])</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-31><a id=__codelineno-5-31 name=__codelineno-5-31></a><a href=#__codelineno-5-31><span class=linenos data-linenos=" 31 "></span></a><span class=w>                </span><span class=n>mark</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=c1>// star</span>
</span><span id=__span-5-32><a id=__codelineno-5-32 name=__codelineno-5-32></a><a href=#__codelineno-5-32><span class=linenos data-linenos=" 32 "></span></a><span class=w>                </span><span class=n>row_cover</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>col_cover</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
</span><span id=__span-5-33><a id=__codelineno-5-33 name=__codelineno-5-33></a><a href=#__codelineno-5-33><span class=linenos data-linenos=" 33 "></span></a><span class=w>                </span><span class=k>break</span><span class=p>;</span>
</span><span id=__span-5-34><a id=__codelineno-5-34 name=__codelineno-5-34></a><a href=#__codelineno-5-34><span class=linenos data-linenos=" 34 "></span></a><span class=w>            </span><span class=p>}</span>
</span><span id=__span-5-35><a id=__codelineno-5-35 name=__codelineno-5-35></a><a href=#__codelineno-5-35><span class=linenos data-linenos=" 35 "></span></a>
</span><span id=__span-5-36><a id=__codelineno-5-36 name=__codelineno-5-36></a><a href=#__codelineno-5-36><span class=linenos data-linenos=" 36 "></span></a><span class=w>    </span><span class=n>fill</span><span class=p>(</span><span class=n>row_cover</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>row_cover</span><span class=p>.</span><span class=n>end</span><span class=p>(),</span><span class=w> </span><span class=nb>false</span><span class=p>);</span>
</span><span id=__span-5-37><a id=__codelineno-5-37 name=__codelineno-5-37></a><a href=#__codelineno-5-37><span class=linenos data-linenos=" 37 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-5-38><a id=__codelineno-5-38 name=__codelineno-5-38></a><a href=#__codelineno-5-38><span class=linenos data-linenos=" 38 "></span></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-5-39><a id=__codelineno-5-39 name=__codelineno-5-39></a><a href=#__codelineno-5-39><span class=linenos data-linenos=" 39 "></span></a><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>mark</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-5-40><a id=__codelineno-5-40 name=__codelineno-5-40></a><a href=#__codelineno-5-40><span class=linenos data-linenos=" 40 "></span></a><span class=w>                </span><span class=n>col_cover</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
</span><span id=__span-5-41><a id=__codelineno-5-41 name=__codelineno-5-41></a><a href=#__codelineno-5-41><span class=linenos data-linenos=" 41 "></span></a>
</span><span id=__span-5-42><a id=__codelineno-5-42 name=__codelineno-5-42></a><a href=#__codelineno-5-42><span class=linenos data-linenos=" 42 "></span></a><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>find_zero</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>&amp;</span><span class=p>]()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span><span class=kt>int</span><span class=o>&gt;</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-43><a id=__codelineno-5-43 name=__codelineno-5-43></a><a href=#__codelineno-5-43><span class=linenos data-linenos=" 43 "></span></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-5-44><a id=__codelineno-5-44 name=__codelineno-5-44></a><a href=#__codelineno-5-44><span class=linenos data-linenos=" 44 "></span></a><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>row_cover</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span><span id=__span-5-45><a id=__codelineno-5-45 name=__codelineno-5-45></a><a href=#__codelineno-5-45><span class=linenos data-linenos=" 45 "></span></a><span class=w>                </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-5-46><a id=__codelineno-5-46 name=__codelineno-5-46></a><a href=#__codelineno-5-46><span class=linenos data-linenos=" 46 "></span></a><span class=w>                    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>col_cover</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>fabs</span><span class=p>(</span><span class=n>cost</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>])</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=mf>1e-9</span><span class=p>)</span>
</span><span id=__span-5-47><a id=__codelineno-5-47 name=__codelineno-5-47></a><a href=#__codelineno-5-47><span class=linenos data-linenos=" 47 "></span></a><span class=w>                        </span><span class=k>return</span><span class=w> </span><span class=n>make_pair</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=n>j</span><span class=p>);</span>
</span><span id=__span-5-48><a id=__codelineno-5-48 name=__codelineno-5-48></a><a href=#__codelineno-5-48><span class=linenos data-linenos=" 48 "></span></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>make_pair</span><span class=p>(</span><span class=mi>-1</span><span class=p>,</span><span class=w> </span><span class=mi>-1</span><span class=p>);</span>
</span><span id=__span-5-49><a id=__codelineno-5-49 name=__codelineno-5-49></a><a href=#__codelineno-5-49><span class=linenos data-linenos=" 49 "></span></a><span class=w>    </span><span class=p>};</span>
</span><span id=__span-5-50><a id=__codelineno-5-50 name=__codelineno-5-50></a><a href=#__codelineno-5-50><span class=linenos data-linenos=" 50 "></span></a>
</span><span id=__span-5-51><a id=__codelineno-5-51 name=__codelineno-5-51></a><a href=#__codelineno-5-51><span class=linenos data-linenos=" 51 "></span></a><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>find_star_in_row</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>&amp;</span><span class=p>](</span><span class=kt>int</span><span class=w> </span><span class=n>r</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-52><a id=__codelineno-5-52 name=__codelineno-5-52></a><a href=#__codelineno-5-52><span class=linenos data-linenos=" 52 "></span></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>mark</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>j</span><span class=p>;</span>
</span><span id=__span-5-53><a id=__codelineno-5-53 name=__codelineno-5-53></a><a href=#__codelineno-5-53><span class=linenos data-linenos=" 53 "></span></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=mi>-1</span><span class=p>;</span>
</span><span id=__span-5-54><a id=__codelineno-5-54 name=__codelineno-5-54></a><a href=#__codelineno-5-54><span class=linenos data-linenos=" 54 "></span></a><span class=w>    </span><span class=p>};</span>
</span><span id=__span-5-55><a id=__codelineno-5-55 name=__codelineno-5-55></a><a href=#__codelineno-5-55><span class=linenos data-linenos=" 55 "></span></a><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>find_star_in_col</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>&amp;</span><span class=p>](</span><span class=kt>int</span><span class=w> </span><span class=n>c</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-56><a id=__codelineno-5-56 name=__codelineno-5-56></a><a href=#__codelineno-5-56><span class=linenos data-linenos=" 56 "></span></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>mark</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>c</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>1</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>i</span><span class=p>;</span>
</span><span id=__span-5-57><a id=__codelineno-5-57 name=__codelineno-5-57></a><a href=#__codelineno-5-57><span class=linenos data-linenos=" 57 "></span></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=mi>-1</span><span class=p>;</span>
</span><span id=__span-5-58><a id=__codelineno-5-58 name=__codelineno-5-58></a><a href=#__codelineno-5-58><span class=linenos data-linenos=" 58 "></span></a><span class=w>    </span><span class=p>};</span>
</span><span id=__span-5-59><a id=__codelineno-5-59 name=__codelineno-5-59></a><a href=#__codelineno-5-59><span class=linenos data-linenos=" 59 "></span></a><span class=w>    </span><span class=k>auto</span><span class=w> </span><span class=n>find_prime_in_row</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>[</span><span class=o>&amp;</span><span class=p>](</span><span class=kt>int</span><span class=w> </span><span class=n>r</span><span class=p>)</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-60><a id=__codelineno-5-60 name=__codelineno-5-60></a><a href=#__codelineno-5-60><span class=linenos data-linenos=" 60 "></span></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>mark</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=k>return</span><span class=w> </span><span class=n>j</span><span class=p>;</span>
</span><span id=__span-5-61><a id=__codelineno-5-61 name=__codelineno-5-61></a><a href=#__codelineno-5-61><span class=linenos data-linenos=" 61 "></span></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=mi>-1</span><span class=p>;</span>
</span><span id=__span-5-62><a id=__codelineno-5-62 name=__codelineno-5-62></a><a href=#__codelineno-5-62><span class=linenos data-linenos=" 62 "></span></a><span class=w>    </span><span class=p>};</span>
</span><span id=__span-5-63><a id=__codelineno-5-63 name=__codelineno-5-63></a><a href=#__codelineno-5-63><span class=linenos data-linenos=" 63 "></span></a>
</span><span id=__span-5-64><a id=__codelineno-5-64 name=__codelineno-5-64></a><a href=#__codelineno-5-64><span class=linenos data-linenos=" 64 "></span></a><span class=w>    </span><span class=c1>// ---- Step 3 + 4 loop ----</span>
</span><span id=__span-5-65><a id=__codelineno-5-65 name=__codelineno-5-65></a><a href=#__codelineno-5-65><span class=linenos data-linenos=" 65 "></span></a><span class=w>    </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>count</span><span class=p>(</span><span class=n>col_cover</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>col_cover</span><span class=p>.</span><span class=n>end</span><span class=p>(),</span><span class=w> </span><span class=nb>true</span><span class=p>)</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>)</span>
</span><span id=__span-5-66><a id=__codelineno-5-66 name=__codelineno-5-66></a><a href=#__codelineno-5-66><span class=linenos data-linenos=" 66 "></span></a><span class=w>    </span><span class=p>{</span>
</span><span id=__span-5-67><a id=__codelineno-5-67 name=__codelineno-5-67></a><a href=#__codelineno-5-67><span class=linenos data-linenos=" 67 "></span></a><span class=w>        </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=nb>true</span><span class=p>)</span>
</span><span id=__span-5-68><a id=__codelineno-5-68 name=__codelineno-5-68></a><a href=#__codelineno-5-68><span class=linenos data-linenos=" 68 "></span></a><span class=w>        </span><span class=p>{</span>
</span><span id=__span-5-69><a id=__codelineno-5-69 name=__codelineno-5-69></a><a href=#__codelineno-5-69><span class=linenos data-linenos=" 69 "></span></a><span class=w>            </span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span><span class=kt>int</span><span class=o>&gt;</span><span class=w> </span><span class=n>p</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>find_zero</span><span class=p>();</span>
</span><span id=__span-5-70><a id=__codelineno-5-70 name=__codelineno-5-70></a><a href=#__codelineno-5-70><span class=linenos data-linenos=" 70 "></span></a><span class=w>            </span><span class=kt>int</span><span class=w> </span><span class=n>r</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>first</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>p</span><span class=p>.</span><span class=n>second</span><span class=p>;</span>
</span><span id=__span-5-71><a id=__codelineno-5-71 name=__codelineno-5-71></a><a href=#__codelineno-5-71><span class=linenos data-linenos=" 71 "></span></a><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>r</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>-1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-72><a id=__codelineno-5-72 name=__codelineno-5-72></a><a href=#__codelineno-5-72><span class=linenos data-linenos=" 72 "></span></a><span class=w>                </span><span class=c1>// Step 4: generate new zeros</span>
</span><span id=__span-5-73><a id=__codelineno-5-73 name=__codelineno-5-73></a><a href=#__codelineno-5-73><span class=linenos data-linenos=" 73 "></span></a><span class=w>                </span><span class=kt>double</span><span class=w> </span><span class=n>d</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mf>1e18</span><span class=p>;</span>
</span><span id=__span-5-74><a id=__codelineno-5-74 name=__codelineno-5-74></a><a href=#__codelineno-5-74><span class=linenos data-linenos=" 74 "></span></a><span class=w>                </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>row_cover</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span><span id=__span-5-75><a id=__codelineno-5-75 name=__codelineno-5-75></a><a href=#__codelineno-5-75><span class=linenos data-linenos=" 75 "></span></a><span class=w>                    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>col_cover</span><span class=p>[</span><span class=n>j</span><span class=p>])</span>
</span><span id=__span-5-76><a id=__codelineno-5-76 name=__codelineno-5-76></a><a href=#__codelineno-5-76><span class=linenos data-linenos=" 76 "></span></a><span class=w>                        </span><span class=n>d</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>min</span><span class=p>(</span><span class=n>d</span><span class=p>,</span><span class=w> </span><span class=n>cost</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]);</span>
</span><span id=__span-5-77><a id=__codelineno-5-77 name=__codelineno-5-77></a><a href=#__codelineno-5-77><span class=linenos data-linenos=" 77 "></span></a>
</span><span id=__span-5-78><a id=__codelineno-5-78 name=__codelineno-5-78></a><a href=#__codelineno-5-78><span class=linenos data-linenos=" 78 "></span></a><span class=w>                </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-79><a id=__codelineno-5-79 name=__codelineno-5-79></a><a href=#__codelineno-5-79><span class=linenos data-linenos=" 79 "></span></a><span class=w>                    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>row_cover</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span><span id=__span-5-80><a id=__codelineno-5-80 name=__codelineno-5-80></a><a href=#__codelineno-5-80><span class=linenos data-linenos=" 80 "></span></a><span class=w>                        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-5-81><a id=__codelineno-5-81 name=__codelineno-5-81></a><a href=#__codelineno-5-81><span class=linenos data-linenos=" 81 "></span></a><span class=w>                            </span><span class=n>cost</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>-=</span><span class=w> </span><span class=n>d</span><span class=p>;</span>
</span><span id=__span-5-82><a id=__codelineno-5-82 name=__codelineno-5-82></a><a href=#__codelineno-5-82><span class=linenos data-linenos=" 82 "></span></a><span class=w>                    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-5-83><a id=__codelineno-5-83 name=__codelineno-5-83></a><a href=#__codelineno-5-83><span class=linenos data-linenos=" 83 "></span></a><span class=w>                        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>col_cover</span><span class=p>[</span><span class=n>j</span><span class=p>])</span>
</span><span id=__span-5-84><a id=__codelineno-5-84 name=__codelineno-5-84></a><a href=#__codelineno-5-84><span class=linenos data-linenos=" 84 "></span></a><span class=w>                            </span><span class=n>cost</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>d</span><span class=p>;</span>
</span><span id=__span-5-85><a id=__codelineno-5-85 name=__codelineno-5-85></a><a href=#__codelineno-5-85><span class=linenos data-linenos=" 85 "></span></a><span class=w>                </span><span class=p>}</span>
</span><span id=__span-5-86><a id=__codelineno-5-86 name=__codelineno-5-86></a><a href=#__codelineno-5-86><span class=linenos data-linenos=" 86 "></span></a><span class=w>            </span><span class=p>}</span>
</span><span id=__span-5-87><a id=__codelineno-5-87 name=__codelineno-5-87></a><a href=#__codelineno-5-87><span class=linenos data-linenos=" 87 "></span></a><span class=w>            </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-88><a id=__codelineno-5-88 name=__codelineno-5-88></a><a href=#__codelineno-5-88><span class=linenos data-linenos=" 88 "></span></a><span class=w>                </span><span class=n>mark</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>c</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>2</span><span class=p>;</span><span class=w> </span><span class=c1>// prime</span>
</span><span id=__span-5-89><a id=__codelineno-5-89 name=__codelineno-5-89></a><a href=#__codelineno-5-89><span class=linenos data-linenos=" 89 "></span></a><span class=w>                </span><span class=kt>int</span><span class=w> </span><span class=n>star_col</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>find_star_in_row</span><span class=p>(</span><span class=n>r</span><span class=p>);</span>
</span><span id=__span-5-90><a id=__codelineno-5-90 name=__codelineno-5-90></a><a href=#__codelineno-5-90><span class=linenos data-linenos=" 90 "></span></a><span class=w>                </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>star_col</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>-1</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-91><a id=__codelineno-5-91 name=__codelineno-5-91></a><a href=#__codelineno-5-91><span class=linenos data-linenos=" 91 "></span></a><span class=w>                    </span><span class=c1>// augment path</span>
</span><span id=__span-5-92><a id=__codelineno-5-92 name=__codelineno-5-92></a><a href=#__codelineno-5-92><span class=linenos data-linenos=" 92 "></span></a><span class=w>                    </span><span class=n>vector</span><span class=o>&lt;</span><span class=n>pair</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span><span class=kt>int</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>path</span><span class=p>;</span>
</span><span id=__span-5-93><a id=__codelineno-5-93 name=__codelineno-5-93></a><a href=#__codelineno-5-93><span class=linenos data-linenos=" 93 "></span></a><span class=w>                    </span><span class=n>path</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>make_pair</span><span class=p>(</span><span class=n>r</span><span class=p>,</span><span class=w> </span><span class=n>c</span><span class=p>));</span>
</span><span id=__span-5-94><a id=__codelineno-5-94 name=__codelineno-5-94></a><a href=#__codelineno-5-94><span class=linenos data-linenos=" 94 "></span></a><span class=w>                    </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=nb>true</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-95><a id=__codelineno-5-95 name=__codelineno-5-95></a><a href=#__codelineno-5-95><span class=linenos data-linenos=" 95 "></span></a><span class=w>                        </span><span class=kt>int</span><span class=w> </span><span class=n>star_row</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>find_star_in_col</span><span class=p>(</span><span class=n>path</span><span class=p>.</span><span class=n>back</span><span class=p>().</span><span class=n>second</span><span class=p>);</span>
</span><span id=__span-5-96><a id=__codelineno-5-96 name=__codelineno-5-96></a><a href=#__codelineno-5-96><span class=linenos data-linenos=" 96 "></span></a><span class=w>                        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>star_row</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>-1</span><span class=p>)</span><span class=w> </span><span class=k>break</span><span class=p>;</span>
</span><span id=__span-5-97><a id=__codelineno-5-97 name=__codelineno-5-97></a><a href=#__codelineno-5-97><span class=linenos data-linenos=" 97 "></span></a><span class=w>                        </span><span class=n>path</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>make_pair</span><span class=p>(</span><span class=n>star_row</span><span class=p>,</span><span class=w> </span><span class=n>path</span><span class=p>.</span><span class=n>back</span><span class=p>().</span><span class=n>second</span><span class=p>));</span>
</span><span id=__span-5-98><a id=__codelineno-5-98 name=__codelineno-5-98></a><a href=#__codelineno-5-98><span class=linenos data-linenos=" 98 "></span></a><span class=w>                        </span><span class=kt>int</span><span class=w> </span><span class=n>prime_col</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>find_prime_in_row</span><span class=p>(</span><span class=n>path</span><span class=p>.</span><span class=n>back</span><span class=p>().</span><span class=n>first</span><span class=p>);</span>
</span><span id=__span-5-99><a id=__codelineno-5-99 name=__codelineno-5-99></a><a href=#__codelineno-5-99><span class=linenos data-linenos=" 99 "></span></a><span class=w>                        </span><span class=n>path</span><span class=p>.</span><span class=n>push_back</span><span class=p>(</span><span class=n>make_pair</span><span class=p>(</span><span class=n>path</span><span class=p>.</span><span class=n>back</span><span class=p>().</span><span class=n>first</span><span class=p>,</span><span class=w> </span><span class=n>prime_col</span><span class=p>));</span>
</span><span id=__span-5-100><a id=__codelineno-5-100 name=__codelineno-5-100></a><a href=#__codelineno-5-100><span class=linenos data-linenos="100 "></span></a><span class=w>                    </span><span class=p>}</span>
</span><span id=__span-5-101><a id=__codelineno-5-101 name=__codelineno-5-101></a><a href=#__codelineno-5-101><span class=linenos data-linenos="101 "></span></a><span class=w>                    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=k>auto</span><span class=w> </span><span class=o>&amp;</span><span class=n>pp</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>path</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-102><a id=__codelineno-5-102 name=__codelineno-5-102></a><a href=#__codelineno-5-102><span class=linenos data-linenos="102 "></span></a><span class=w>                        </span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>pp</span><span class=p>.</span><span class=n>first</span><span class=p>,</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>pp</span><span class=p>.</span><span class=n>second</span><span class=p>;</span>
</span><span id=__span-5-103><a id=__codelineno-5-103 name=__codelineno-5-103></a><a href=#__codelineno-5-103><span class=linenos data-linenos="103 "></span></a><span class=w>                        </span><span class=n>mark</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=n>mark</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=mi>1</span><span class=p>);</span>
</span><span id=__span-5-104><a id=__codelineno-5-104 name=__codelineno-5-104></a><a href=#__codelineno-5-104><span class=linenos data-linenos="104 "></span></a><span class=w>                    </span><span class=p>}</span>
</span><span id=__span-5-105><a id=__codelineno-5-105 name=__codelineno-5-105></a><a href=#__codelineno-5-105><span class=linenos data-linenos="105 "></span></a><span class=w>                    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-5-106><a id=__codelineno-5-106 name=__codelineno-5-106></a><a href=#__codelineno-5-106><span class=linenos data-linenos="106 "></span></a><span class=w>                        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-5-107><a id=__codelineno-5-107 name=__codelineno-5-107></a><a href=#__codelineno-5-107><span class=linenos data-linenos="107 "></span></a><span class=w>                            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>mark</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w> </span><span class=n>mark</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-5-108><a id=__codelineno-5-108 name=__codelineno-5-108></a><a href=#__codelineno-5-108><span class=linenos data-linenos="108 "></span></a><span class=w>                    </span><span class=n>fill</span><span class=p>(</span><span class=n>row_cover</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>row_cover</span><span class=p>.</span><span class=n>end</span><span class=p>(),</span><span class=w> </span><span class=nb>false</span><span class=p>);</span>
</span><span id=__span-5-109><a id=__codelineno-5-109 name=__codelineno-5-109></a><a href=#__codelineno-5-109><span class=linenos data-linenos="109 "></span></a><span class=w>                    </span><span class=n>fill</span><span class=p>(</span><span class=n>col_cover</span><span class=p>.</span><span class=n>begin</span><span class=p>(),</span><span class=w> </span><span class=n>col_cover</span><span class=p>.</span><span class=n>end</span><span class=p>(),</span><span class=w> </span><span class=nb>false</span><span class=p>);</span>
</span><span id=__span-5-110><a id=__codelineno-5-110 name=__codelineno-5-110></a><a href=#__codelineno-5-110><span class=linenos data-linenos="110 "></span></a><span class=w>                    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-5-111><a id=__codelineno-5-111 name=__codelineno-5-111></a><a href=#__codelineno-5-111><span class=linenos data-linenos="111 "></span></a><span class=w>                        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-5-112><a id=__codelineno-5-112 name=__codelineno-5-112></a><a href=#__codelineno-5-112><span class=linenos data-linenos="112 "></span></a><span class=w>                            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>mark</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-5-113><a id=__codelineno-5-113 name=__codelineno-5-113></a><a href=#__codelineno-5-113><span class=linenos data-linenos="113 "></span></a><span class=w>                                </span><span class=n>col_cover</span><span class=p>[</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
</span><span id=__span-5-114><a id=__codelineno-5-114 name=__codelineno-5-114></a><a href=#__codelineno-5-114><span class=linenos data-linenos="114 "></span></a><span class=w>                    </span><span class=k>break</span><span class=p>;</span>
</span><span id=__span-5-115><a id=__codelineno-5-115 name=__codelineno-5-115></a><a href=#__codelineno-5-115><span class=linenos data-linenos="115 "></span></a><span class=w>                </span><span class=p>}</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-116><a id=__codelineno-5-116 name=__codelineno-5-116></a><a href=#__codelineno-5-116><span class=linenos data-linenos="116 "></span></a><span class=w>                    </span><span class=n>row_cover</span><span class=p>[</span><span class=n>r</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>true</span><span class=p>;</span>
</span><span id=__span-5-117><a id=__codelineno-5-117 name=__codelineno-5-117></a><a href=#__codelineno-5-117><span class=linenos data-linenos="117 "></span></a><span class=w>                    </span><span class=n>col_cover</span><span class=p>[</span><span class=n>star_col</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>false</span><span class=p>;</span>
</span><span id=__span-5-118><a id=__codelineno-5-118 name=__codelineno-5-118></a><a href=#__codelineno-5-118><span class=linenos data-linenos="118 "></span></a><span class=w>                </span><span class=p>}</span>
</span><span id=__span-5-119><a id=__codelineno-5-119 name=__codelineno-5-119></a><a href=#__codelineno-5-119><span class=linenos data-linenos="119 "></span></a><span class=w>            </span><span class=p>}</span>
</span><span id=__span-5-120><a id=__codelineno-5-120 name=__codelineno-5-120></a><a href=#__codelineno-5-120><span class=linenos data-linenos="120 "></span></a><span class=w>        </span><span class=p>}</span>
</span><span id=__span-5-121><a id=__codelineno-5-121 name=__codelineno-5-121></a><a href=#__codelineno-5-121><span class=linenos data-linenos="121 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-5-122><a id=__codelineno-5-122 name=__codelineno-5-122></a><a href=#__codelineno-5-122><span class=linenos data-linenos="122 "></span></a>
</span><span id=__span-5-123><a id=__codelineno-5-123 name=__codelineno-5-123></a><a href=#__codelineno-5-123><span class=linenos data-linenos="123 "></span></a><span class=w>    </span><span class=c1>// 输出匹配结果</span>
</span><span id=__span-5-124><a id=__codelineno-5-124 name=__codelineno-5-124></a><a href=#__codelineno-5-124><span class=linenos data-linenos="124 "></span></a><span class=w>    </span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=w> </span><span class=n>assign</span><span class=p>(</span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=mi>-1</span><span class=p>);</span>
</span><span id=__span-5-125><a id=__codelineno-5-125 name=__codelineno-5-125></a><a href=#__codelineno-5-125><span class=linenos data-linenos="125 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-5-126><a id=__codelineno-5-126 name=__codelineno-5-126></a><a href=#__codelineno-5-126><span class=linenos data-linenos="126 "></span></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-5-127><a id=__codelineno-5-127 name=__codelineno-5-127></a><a href=#__codelineno-5-127><span class=linenos data-linenos="127 "></span></a><span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>mark</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mi>1</span><span class=p>)</span>
</span><span id=__span-5-128><a id=__codelineno-5-128 name=__codelineno-5-128></a><a href=#__codelineno-5-128><span class=linenos data-linenos="128 "></span></a><span class=w>                </span><span class=n>assign</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>j</span><span class=p>;</span>
</span><span id=__span-5-129><a id=__codelineno-5-129 name=__codelineno-5-129></a><a href=#__codelineno-5-129><span class=linenos data-linenos="129 "></span></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>assign</span><span class=p>;</span>
</span><span id=__span-5-130><a id=__codelineno-5-130 name=__codelineno-5-130></a><a href=#__codelineno-5-130><span class=linenos data-linenos="130 "></span></a><span class=p>}</span>
</span><span id=__span-5-131><a id=__codelineno-5-131 name=__codelineno-5-131></a><a href=#__codelineno-5-131><span class=linenos data-linenos="131 "></span></a>
</span><span id=__span-5-132><a id=__codelineno-5-132 name=__codelineno-5-132></a><a href=#__codelineno-5-132><span class=linenos data-linenos="132 "></span></a><span class=kt>int</span><span class=w> </span><span class=n>main</span><span class=p>()</span>
</span><span id=__span-5-133><a id=__codelineno-5-133 name=__codelineno-5-133></a><a href=#__codelineno-5-133><span class=linenos data-linenos="133 "></span></a><span class=p>{</span>
</span><span id=__span-5-134><a id=__codelineno-5-134 name=__codelineno-5-134></a><a href=#__codelineno-5-134><span class=linenos data-linenos="134 "></span></a><span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>n</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>10</span><span class=p>;</span>
</span><span id=__span-5-135><a id=__codelineno-5-135 name=__codelineno-5-135></a><a href=#__codelineno-5-135><span class=linenos data-linenos="135 "></span></a><span class=w>    </span><span class=n>srand</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span><span id=__span-5-136><a id=__codelineno-5-136 name=__codelineno-5-136></a><a href=#__codelineno-5-136><span class=linenos data-linenos="136 "></span></a><span class=w>    </span><span class=n>vector</span><span class=o>&lt;</span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>cost</span><span class=p>(</span><span class=n>n</span><span class=p>,</span><span class=w> </span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>double</span><span class=o>&gt;</span><span class=p>(</span><span class=n>n</span><span class=p>));</span>
</span><span id=__span-5-137><a id=__codelineno-5-137 name=__codelineno-5-137></a><a href=#__codelineno-5-137><span class=linenos data-linenos="137 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-5-138><a id=__codelineno-5-138 name=__codelineno-5-138></a><a href=#__codelineno-5-138><span class=linenos data-linenos="138 "></span></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-5-139><a id=__codelineno-5-139 name=__codelineno-5-139></a><a href=#__codelineno-5-139><span class=linenos data-linenos="139 "></span></a><span class=w>            </span><span class=n>cost</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rand</span><span class=p>()</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>20</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>;</span>
</span><span id=__span-5-140><a id=__codelineno-5-140 name=__codelineno-5-140></a><a href=#__codelineno-5-140><span class=linenos data-linenos="140 "></span></a>
</span><span id=__span-5-141><a id=__codelineno-5-141 name=__codelineno-5-141></a><a href=#__codelineno-5-141><span class=linenos data-linenos="141 "></span></a><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;代价矩阵：&quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-5-142><a id=__codelineno-5-142 name=__codelineno-5-142></a><a href=#__codelineno-5-142><span class=linenos data-linenos="142 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-143><a id=__codelineno-5-143 name=__codelineno-5-143></a><a href=#__codelineno-5-143><span class=linenos data-linenos="143 "></span></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span>
</span><span id=__span-5-144><a id=__codelineno-5-144 name=__codelineno-5-144></a><a href=#__codelineno-5-144><span class=linenos data-linenos="144 "></span></a><span class=w>            </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>setw</span><span class=p>(</span><span class=mi>3</span><span class=p>)</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>cost</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot; &quot;</span><span class=p>;</span>
</span><span id=__span-5-145><a id=__codelineno-5-145 name=__codelineno-5-145></a><a href=#__codelineno-5-145><span class=linenos data-linenos="145 "></span></a><span class=w>        </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-5-146><a id=__codelineno-5-146 name=__codelineno-5-146></a><a href=#__codelineno-5-146><span class=linenos data-linenos="146 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-5-147><a id=__codelineno-5-147 name=__codelineno-5-147></a><a href=#__codelineno-5-147><span class=linenos data-linenos="147 "></span></a>
</span><span id=__span-5-148><a id=__codelineno-5-148 name=__codelineno-5-148></a><a href=#__codelineno-5-148><span class=linenos data-linenos="148 "></span></a><span class=w>    </span><span class=n>vector</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span><span class=w> </span><span class=n>assign</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>hungarian</span><span class=p>(</span><span class=n>cost</span><span class=p>);</span>
</span><span id=__span-5-149><a id=__codelineno-5-149 name=__codelineno-5-149></a><a href=#__codelineno-5-149><span class=linenos data-linenos="149 "></span></a>
</span><span id=__span-5-150><a id=__codelineno-5-150 name=__codelineno-5-150></a><a href=#__codelineno-5-150><span class=linenos data-linenos="150 "></span></a><span class=w>    </span><span class=kt>double</span><span class=w> </span><span class=n>total</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-5-151><a id=__codelineno-5-151 name=__codelineno-5-151></a><a href=#__codelineno-5-151><span class=linenos data-linenos="151 "></span></a><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;</span><span class=se>\n</span><span class=s>最优匹配结果：&quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-5-152><a id=__codelineno-5-152 name=__codelineno-5-152></a><a href=#__codelineno-5-152><span class=linenos data-linenos="152 "></span></a><span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>n</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
</span><span id=__span-5-153><a id=__codelineno-5-153 name=__codelineno-5-153></a><a href=#__codelineno-5-153><span class=linenos data-linenos="153 "></span></a><span class=w>        </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;行 &quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot; → 列 &quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>assign</span><span class=p>[</span><span class=n>i</span><span class=p>]</span><span class=o>+</span><span class=mi>1</span>
</span><span id=__span-5-154><a id=__codelineno-5-154 name=__codelineno-5-154></a><a href=#__codelineno-5-154><span class=linenos data-linenos="154 "></span></a><span class=w>            </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot; , 代价 = &quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>cost</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>assign</span><span class=p>[</span><span class=n>i</span><span class=p>]]</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-5-155><a id=__codelineno-5-155 name=__codelineno-5-155></a><a href=#__codelineno-5-155><span class=linenos data-linenos="155 "></span></a><span class=w>        </span><span class=n>total</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>cost</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>assign</span><span class=p>[</span><span class=n>i</span><span class=p>]];</span>
</span><span id=__span-5-156><a id=__codelineno-5-156 name=__codelineno-5-156></a><a href=#__codelineno-5-156><span class=linenos data-linenos="156 "></span></a><span class=w>    </span><span class=p>}</span>
</span><span id=__span-5-157><a id=__codelineno-5-157 name=__codelineno-5-157></a><a href=#__codelineno-5-157><span class=linenos data-linenos="157 "></span></a><span class=w>    </span><span class=n>cout</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=s>&quot;总代价 = &quot;</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>total</span><span class=w> </span><span class=o>&lt;&lt;</span><span class=w> </span><span class=n>endl</span><span class=p>;</span>
</span><span id=__span-5-158><a id=__codelineno-5-158 name=__codelineno-5-158></a><a href=#__codelineno-5-158><span class=linenos data-linenos="158 "></span></a><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span>
</span><span id=__span-5-159><a id=__codelineno-5-159 name=__codelineno-5-159></a><a href=#__codelineno-5-159><span class=linenos data-linenos="159 "></span></a><span class=p>}</span>
</span></code></pre></div> </div> </div> </div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>上面介绍的三种匈牙利算法：</p> <ul> <li>Kuhn 算法</li> <li>KM 算法（Kuhn-Munkres）</li> <li>Munkres 算法（矩阵匈牙利）</li> </ul> <p>本质上是相同的，都是为了解决最大权重/最小代价的匹配问题。其中，Kuhn 算法（<strong>无权</strong>图）是 KM 算法（<strong>有权</strong>图）的一种特殊情形，只需将 KM 算法中权重设置为0、1两个值，就退化为 Kuhn 算法。而 KM 算法和 Munkres 算法等价，是同一个问题的两种实现，前者使用<strong>图论</strong>方法（顶标、相等子图、松弛），后者使用<strong>矩阵</strong>方法（行列相减、最小子图覆盖0）。</p> </div> <hr> <p>接下来，介绍完了匈牙利算法这一基本思想，让我们正式进入目标跟踪领域常用的算法框架。</p> <h2 id=sort>SORT<a class=headerlink href=#sort title="Permanent link">&para;</a></h2> <blockquote> <p>[ICIP 2016] Simple Online and Realtime Tracking</p> <p>Paper: <a href=https://arxiv.org/abs/1602.00763>https://arxiv.org/abs/1602.00763</a></p> <p>Code: <a href=https://github.com/abewley/sort>https://github.com/abewley/sort</a></p> </blockquote> <p>SORT 是多目标跟踪中最经典、最简洁的算法之一，常用在目标检测器（如 YOLO）之后的跟踪层（tracking layer），在检测器输入的的基础上，实时地为每个目标分配持续的身份 ID，实现帧间关联。</p> <p>SORT 算法的整体流程是“卡尔曼滤波预测 + 匈牙利算法匹配 + ID 管理”：</p> <ol> <li>用卡尔曼滤波器预测上一帧目标的新位置。</li> <li>以 IoU 为代价运用匈牙利算法，将新检测框与预测框匹配。</li> <li>匹配成功的检测框更新状态，匹配失败的重新分配 ID 或删除 ID。</li> </ol> <h3 id=estimantion-model>Estimantion Model<a class=headerlink href=#estimantion-model title="Permanent link">&para;</a></h3> <p>卡尔曼滤波中，设定的状态变量为 <span class=arithmatex>\(\mathbf{x}=[u,v,s,r,\dot{u},\dot{v},\dot{s}]^T\)</span> ，其中：</p> <ul> <li><span class=arithmatex>\(u,v\)</span> 为目标边界框的横纵坐标。</li> <li><span class=arithmatex>\(s\)</span> 为边界框的尺寸/面积。</li> <li><span class=arithmatex>\(r\)</span> 为边界框的宽高比 width/height，保持不变。</li> </ul> <p>一般在短时间内，目标匀速运动，那么使用匀速运动模型：</p> <div class=arithmatex>\[ \mathbf{x}_{k|k-1} = \mathbf{F} \mathbf{x}_{k-1|k-1},\quad \mathbf{F} = \begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\ 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\ \end{pmatrix} \]</div> <h3 id=data-association>Data Association<a class=headerlink href=#data-association title="Permanent link">&para;</a></h3> <p>卡尔曼滤波的预测阶段结束后，需要对预测框和检测框进行匹配。计算每一对预测框和检测框的交并比 IoU（intersection-over-union）：</p> <div class=arithmatex>\[ \mathrm{IoU}(A,B)=\frac{\mathrm{area}(A\cap B)}{\mathrm{area}(A\cup B)} \]</div> <p>IoU 越大，两个框越接近重合，越有可能对应同一个目标。我们希望匹配的每一对的 IoU 尽可能大，即最大化总 IoU，而匈牙利算法求解的是最小代价，因此可以设置代价为 <span class=arithmatex>\(c_{ij}=1-\mathrm{IoU}(A_i,B_j)\)</span> .</p> <p>同时，为避免匹配中某一对 IoU 过小，还需要进行下界阈值 <span class=arithmatex>\(\mathrm{IoU}_{\min}\)</span> 进行过滤，宁愿不分配，也要避免分配错误的一对边界框。</p> <p>轨迹生命周期管理（ID 管理）中，每个目标有 3 种可能状态：</p> <ul> <li>Active 跟踪中：匹配成功，正常更新。</li> <li>Lost 暂时丢失：本帧未匹配到检测框，但仍进行预测。</li> <li>Deleted 已删除：连续多帧未匹配到，认为目标丢失。</li> </ul> <p>可以设置参数：</p> <ul> <li><code>max_age</code> ：允许连续多少帧匹配失败就删除，也就是原文的 <span class=arithmatex>\(T_{lost}\)</span> 参数。</li> <li><code>min_hits</code> ：最少连续命中多少次认为是真实目标，避免误检测。</li> </ul> <p>SORT 的局限性在于：存在遮挡时会导致跟踪中断；IoU 对尺度变化较为敏感。</p> <h2 id=deepsort>DeepSORT<a class=headerlink href=#deepsort title="Permanent link">&para;</a></h2> <p>前述的 SORT 只用几何信息（预测框与检测框的 IoU/位置）做关联，而没有用到目标的特征，在遮挡和交会时容易发生 ID switch。因此 DeepSORT 增加了外观特征（ReID embedding），使得相似目标在遮挡后仍保持 ID，并使用匹配级联（matching cascade）和门控马氏距离使得数据关联更加稳定。</p> <blockquote> <p>[ICIP 2017] Simple Online and Realtime Tracking with a Deep Association Metric</p> <p>Paper: <a href=https://arxiv.org/abs/1703.07402>https://arxiv.org/abs/1703.07402</a></p> <p>Code: <a href=https://github.com/nwojke/deep_sort>https://github.com/nwojke/deep_sort</a></p> </blockquote> <h3 id=track-handling-and-state-estimation>Track Handling and State Estimation<a class=headerlink href=#track-handling-and-state-estimation title="Permanent link">&para;</a></h3> <p>与 SORT 类似，构建常速度、线性观测的标准卡尔曼滤波模型。检测框的状态变量为 <span class=arithmatex>\(\mathbf{x}=[u,v,\gamma,h,\dot{x},\dot{y},\dot{\gamma},\dot{h}]^T\)</span> ，观测变量为 <span class=arithmatex>\(\mathbf{z}=[u,v,\gamma,h]^T\)</span> 。其中，此处使用宽高比 <span class=arithmatex>\(\gamma\)</span> 和高度 <span class=arithmatex>\(h\)</span> ，而非 SORT 使用的面积 <span class=arithmatex>\(s\)</span> .</p> <p>对于每一个目标的跟踪轨迹 <span class=arithmatex>\(k\)</span> ，我们需要计数它从成功关联以来的帧数，也就是它连续关联失败的帧数，如果超过预设阈值 <span class=arithmatex>\(A_{\max}\)</span> ，认为它已经离开场景，终止该目标的跟踪。</p> <p>对于无法与现有目标跟踪轨迹关联的检测，尝试分配新的 ID，如果连续 3 帧都能关联成功，就保留此目标。</p> <h3 id=assignment-problem>Assignment Problem<a class=headerlink href=#assignment-problem title="Permanent link">&para;</a></h3> <p>为了构建分配问题的代价、运用匈牙利算法，我们结合目标的<strong>运行</strong>信息和<strong>外观</strong>信息进行分析。</p> <p>对于运动信息，使用卡尔曼预测状态和新到来的测量之间的平方马氏距离（Mahalanobis distance）：</p> <div class=arithmatex>\[ d^{(1)}(i,j)=(\mathbf{d}_j-\mathbf{y}_i)^T\mathbf{S}_i^{-1}(\mathbf{d}_j-\mathbf{y}_i)^T \]</div> <p>原文中是这么说的：</p> <blockquote> <p>... where we denote the projection of the <span class=arithmatex>\(i\)</span>-th track distribution into measurement space by <span class=arithmatex>\((\boldsymbol{y}_i,\boldsymbol{S}_i)\)</span> and the <span class=arithmatex>\(j\)</span>-th bounding box detection by <span class=arithmatex>\(\boldsymbol{d}_j\)</span> . The Mahalanobis distance takes state estimation uncertainty into account by measuring how many standard deviations the detection is away from the mean track location.</p> </blockquote> <p>这里具体解释一下 <span class=arithmatex>\(\mathbf{y}_i,\;\mathbf{S}_i\)</span> 的含义。由于卡尔曼滤波中的状态变量是在状态空间中，我们需要通过观测矩阵 <span class=arithmatex>\(\mathbf{H}\)</span> 将预测的状态分布从状态空间映射到测量空间 <span class=arithmatex>\((\mathbf{x}_i,\mathbf{P}_i)\to(\mathbf{y}_i,\mathbf{S}_i)\)</span> ，也就是：</p> <div class=arithmatex>\[ \mathbf{y}_i=\mathbf{H}\mathbf{x}_i,\quad \mathbf{S}_i=\mathbf{H}\mathbf{P}_i\mathbf{H}^T+\mathbf{R} \]</div> <p>因此， <span class=arithmatex>\(\mathbf{y}_i\)</span> 代表第 <span class=arithmatex>\(i\)</span> 个轨迹预测观测均值（即卡尔曼滤波预测的测量输出）， <span class=arithmatex>\(\mathbf{S}_i\)</span> 代表第 <span class=arithmatex>\(i\)</span> 个轨迹预测在测量空间中的协方差矩阵（即卡尔曼滤波的不确定性）。</p> <p>这个马氏距离衡量了检测框距离预测分布的中心有多少个标准差。马氏距离在计算预测与检测之间差距时，会考虑状态估计的不确定性，比欧氏距离更加合理，能够动态适应“预测置信度”：</p> <ul> <li>若某个预测位置很确定（协方差小），即预测框范围很“窄”，那么偏离一点点就意味着很大的马氏距离。</li> <li>若某个预测位置很不确定（协方差大），允许更大误差。</li> </ul> <p>为了排除不太可能的匹配，在 95% 置信度区间内，对马氏距离进行阈值处理：</p> <div class=arithmatex>\[ b^{(1)}(i,j)=\mathbb{I}[d^{(1)}(i,j)\leqslant t^{(1)}],\quad t^{(1)}=\chi_4^2(0.95)=9.4877 \]</div> <blockquote> <p>While the Mahalanobis distance is a suitable association metric when motion uncertainty is low, in our image-space problem formulation the predicted state distribution obtained from the Kalman filtering framework provides only a rough estimate of the object location. In particular, unaccounted camera motion can introduce rapid displacements in the image plane, making the Mahalanobis distance a rather uninformed metric for tracking through occlusions. Therefore, we integrate a second metric into the assignment problem.</p> </blockquote> <p>这段话的意思是，目标运动的不确定性较低时，使用马氏距离较为合适。但是在图像坐标系中，卡尔曼滤波预测的状态往往知识一个粗略估计，当存在相机抖动、不规则运动时，目标会在图像上出现大幅度漂移，此时马氏距离的区分程度变差，难以在遮挡或者快速移动场景中有效工作。</p> <p>因此我们引入外观度量（appearance metric）：</p> <ul> <li>对每一个检测到的边界框 <span class=arithmatex>\(\mathbf{d}_j\)</span> ，经过一个预训练 CNN（ReID 网络）提取特征向量 <span class=arithmatex>\(\mathbf{r}_j\)</span> ，保证 L2 归一化 <span class=arithmatex>\(\|\mathbf{r}_j\|=1\)</span> .</li> <li>对每条轨迹（track） <span class=arithmatex>\(k\)</span> 维护一个特征库 <span class=arithmatex>\(\mathcal{R}_k=\{\mathbf{r}_k^{(i)}\}_{k=1}^{L_k}\)</span> 保存最近的 <span class=arithmatex>\(L_k=100\)</span> 帧该目标的特征。保存多帧是为了即使目标被短暂遮挡，也能用旧特征重新识别回来。</li> <li>对于第 <span class=arithmatex>\(i\)</span> 条轨迹、第 <span class=arithmatex>\(j\)</span> 条观测，计算特征 <span class=arithmatex>\(\mathbf{r}_j\)</span> 与轨迹历史特征集 <span class=arithmatex>\(\mathcal{R}_i\)</span> 中所有特征的余弦距离最小值，作为该匹配对的外观距离 <span class=arithmatex>\(d^{(2)}(i,j)=\min\{1-\mathbf{r}_j^T\mathbf{r}_k^{(i)} \mid \mathbf{r}_k^{(i)}\in\mathcal{R}_i \}\)</span> . （余弦距离越小，代表两个特征越相似。这里用1减去，是因为要求最小代价）</li> <li>再使用阈值判断 <span class=arithmatex>\(b^{(2)}(i,j)=\mathbb{I}[d^{(2)}(i,j)\leqslant t^{(2)}]\)</span> .</li> </ul> <p><br></p> <p>马氏距离反映了运动位置信息，适合短期预测；余弦距离提供外观特征，适合长期保持、应对遮挡问题。最后使用它们的加权求和来构建一个配对的最终代价：</p> <div class=arithmatex>\[ c_{ij}=\lambda d^{(1)}(i,j)+(1-\lambda)d^{(2)}(i,j) \]</div> <p>同时，这两个距离必须<strong>同时</strong>在门控范围内 <span class=arithmatex>\(b_{ij}=b_{ij}^{(1)}b_{ij}^{(2)}\)</span> ，这个代价 <span class=arithmatex>\(c_{ij}\)</span> 才有效。</p> <p>在实际测试中，如果存在明显的相机运动，设置 <span class=arithmatex>\(\lambda=0\)</span> 较为合适，虽然最终代价只用到了外观距离，但是马氏距离仍然用于排除不太可能的分配，仍然在起作用。</p> <h3 id=matching-cascade>Matching Cascade<a class=headerlink href=#matching-cascade title="Permanent link">&para;</a></h3> <blockquote> <p>Instead of solving for measurement-to-track associations in a global assignment problem, we introduce a cascade that solves a series of subproblems. To motivate this approach, consider the following situation: When an object is occluded for a longer period of time, subsequent Kalman filter predictions increase the uncertainty associated with the object location. Consequently, probability mass spreads out in state space and the observation likelihood becomes less peaked. Intuitively, the association metric should account for this spread of probability mass by increasing the measurement-to-track distance. Counterintuitively, when two tracks compete for the same detection, the Mahalanobis distance favors larger uncertainty, because it effectively reduces the distance in standard deviations of any detection towards the projected track mean. This is an undesired behavior as it can lead to increased track fragmentations and unstable tracks. Therefore, we introduce a matching cascade that gives priority to more frequently seen objects to encode our notion of probability spread in the association likelihood.</p> </blockquote> <p>文中指出这样一个问题：当一个目标被遮挡时间越来越长时，卡尔曼滤波预测的位置越来越不准确，预测误差会不断积累，协方差（不确定性）变大。也就是 <span class=arithmatex>\(\mathbf{S}_i\)</span> 变大、 <span class=arithmatex>\(\mathbf{S}_i^{-1}\)</span> 变小、马氏距离“虚假地”变小，算法产生“错觉”，误以为当前的检测框和旧的轨迹很匹配。</p> <p>DeepSORT 提出的思路是，与其像 SORT 那样一次性在所有轨迹上做全局匹配，不如优先考虑最近更新过的轨迹（预测较准的），然后再考虑比较老的轨迹（预测不准的）。</p> <p>伪代码为：</p> <div class="language-yaml highlight"><span class=filename>YAML</span><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1></a><a href=#__codelineno-6-1><span class=linenos data-linenos=" 1 "></span></a><span class=nt>Listing 1</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Matching Cascade</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2></a><a href=#__codelineno-6-2><span class=linenos data-linenos=" 2 "></span></a>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3></a><a href=#__codelineno-6-3><span class=linenos data-linenos=" 3 "></span></a><span class=nt>Input</span><span class=p>:</span>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4></a><a href=#__codelineno-6-4><span class=linenos data-linenos=" 4 "></span></a><span class=w>  </span><span class="l l-Scalar l-Scalar-Plain">Track indices T = {1,...,N}</span>
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5></a><a href=#__codelineno-6-5><span class=linenos data-linenos=" 5 "></span></a><span class=w>  </span><span class="l l-Scalar l-Scalar-Plain">Detection indices D = {1,...,M}</span>
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6></a><a href=#__codelineno-6-6><span class=linenos data-linenos=" 6 "></span></a><span class=w>  </span><span class="l l-Scalar l-Scalar-Plain">Maximum age Amax</span>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7></a><a href=#__codelineno-6-7><span class=linenos data-linenos=" 7 "></span></a>
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8></a><a href=#__codelineno-6-8><span class=linenos data-linenos=" 8 "></span></a><span class=nt>1</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Compute cost matrix C = [c_ij] using Eq.5</span><span class=w>        </span><span class=c1># 综合代价矩阵</span>
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9></a><a href=#__codelineno-6-9><span class=linenos data-linenos=" 9 "></span></a><span class=nt>2</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Compute gate matrix B = [b_ij] using Eq.6</span><span class=w>        </span><span class=c1># 可行匹配（门控）</span>
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10></a><a href=#__codelineno-6-10><span class=linenos data-linenos="10 "></span></a><span class=nt>3</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Initialize set of matches M ← ∅</span>
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11></a><a href=#__codelineno-6-11><span class=linenos data-linenos="11 "></span></a><span class=nt>4</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Initialize unmatched detections U ← D</span>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12></a><a href=#__codelineno-6-12><span class=linenos data-linenos="12 "></span></a><span class=nt>5</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">for n ∈ {1,...,Amax} do</span>
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13></a><a href=#__codelineno-6-13><span class=linenos data-linenos="13 "></span></a><span class=nt>6</span><span class=p>:</span><span class=w>     </span><span class="l l-Scalar l-Scalar-Plain">Select tracks by age Tn ← {i ∈ T | a_i = n}</span>
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14></a><a href=#__codelineno-6-14><span class=linenos data-linenos="14 "></span></a><span class=nt>7</span><span class=p>:</span><span class=w>     </span><span class="p p-Indicator">[</span><span class=nv>x_i</span><span class="p p-Indicator">,</span><span class=w> </span><span class=nv>y_i</span><span class="p p-Indicator">]</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">← min_cost_matching(C, Tn, U)</span><span class=w>     </span><span class=c1># 对这些轨迹局部匈牙利匹配</span>
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15></a><a href=#__codelineno-6-15><span class=linenos data-linenos="15 "></span></a><span class=nt>8</span><span class=p>:</span><span class=w>     </span><span class="l l-Scalar l-Scalar-Plain">M ← M ∪ {(i,j)} | b_ij ≠ 0</span>
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16></a><a href=#__codelineno-6-16><span class=linenos data-linenos="16 "></span></a><span class=nt>9</span><span class=p>:</span><span class=w>     </span><span class="l l-Scalar l-Scalar-Plain">U ← U \ {j | ∃ i, (i,j) ∈ M}</span><span class=w>                 </span><span class=c1># 移除已匹配检测</span>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17></a><a href=#__codelineno-6-17><span class=linenos data-linenos="17 "></span></a><span class=nt>10</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">end for</span>
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18></a><a href=#__codelineno-6-18><span class=linenos data-linenos="18 "></span></a><span class=nt>11</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">return M, U</span>
</span></code></pre></div> <p>具体的流程为：</p> <ol> <li>准备代价矩阵 <span class=arithmatex>\(\mathbf{C}=(c_{ij})\)</span> 和门控矩阵 <span class=arithmatex>\(\mathbf{B}=(b_{ij})\)</span> ， <span class=arithmatex>\(b_{ij}=1\)</span> 才表示该配对满足阈值条件。</li> <li><span class=arithmatex>\(\mathcal{M}\)</span> 保存已经配对的“轨迹预测框-检测框”， <span class=arithmatex>\(\mathcal{U}\)</span> 保存还未匹配的检测框索引。</li> <li>按轨迹的年龄 <span class=arithmatex>\(n\)</span> （距离上次匹配成功的帧数）从小到大逐级匹配<ul> <li>取出轨迹中的“同龄者” <span class=arithmatex>\(\mathcal{T}_n=\{i\in\mathcal{T}\mid a_i=n\}\)</span> .</li> <li>局部匈牙利算法：最小化代价矩阵的子集 <span class=arithmatex>\(\mathbf{C}[\mathcal{T}_n,\mathcal{U}]\)</span> .</li> <li>把得到的匹配对加入集合 <span class=arithmatex>\(\mathcal{M}\)</span> ，把本次匹配到的检测框从 <span class=arithmatex>\(\mathcal{U}\)</span> 中移除。</li> </ul> </li> <li>级联匹配后，再做一次 IoU 匹配，用于还未匹配的、“年龄=1”的轨迹，</li> </ol> <p>级联匹配策略按轨迹“新鲜度”分层，从最新匹配的轨迹开始逐步匹配，避免被遮挡时间长、预测不准的轨迹抢占检测框。这一机制显著减少了 ID Switch，是 DeepSORT 的关键稳定性来源。</p> <h3 id=deep-appearance-descriptor>Deep Appearance Descriptor<a class=headerlink href=#deep-appearance-descriptor title="Permanent link">&para;</a></h3> <p>本方法的在线跟踪使用最近邻查询（nearest neighbor queries），无需额外的度量学习。使用 MARS 数据训练一个 CNN，得到具有较好区分度的特征嵌入。</p> <p>网络的最后一层做 BatchNorm + L2 Norm，输出一个 128 维向量，将向量投影到单位超球面，消除尺度影响，且此时余弦距离=点积。</p> <h2 id=bytetrack>ByteTrack<a class=headerlink href=#bytetrack title="Permanent link">&para;</a></h2> <blockquote> <p>[ECCV 2022] ByteTrack: Multi-Object Tracking by Associating Every Detection Box</p> <p>Paper: <a href=https://arxiv.org/abs/2110.06864>https://arxiv.org/abs/2110.06864</a></p> <p>Code: <a href=https://github.com/FoundationVision/ByteTrack>https://github.com/FoundationVision/ByteTrack</a></p> <p>Translation: <a href=https://zhuanlan.zhihu.com/p/645645269>https://zhuanlan.zhihu.com/p/645645269</a></p> </blockquote> <p>大多数的 MOT 算法，只关心置信度（分数）大于阈值的检测框来获取 ID，置信度较低的目标（例如被遮挡的）被丢弃，可能造成真值目标丢失或轨迹碎片化。本文提出，通过关联几乎每个检测框进行跟踪，对于低置信度目标，利用它和轨迹的相似度来恢复真值目标、过滤对背景的检测。</p> <blockquote> <p>消除所有低置信度检测框的做法是正确的吗？本文答案是否定的。正如黑格尔所说，“存在即合理”。低置信度检测框有时表明目标是存在的，例如被遮挡的目标。</p> </blockquote> <p>如果一个目标在跟踪过程中发生短暂遮挡，它的边界框置信度会发生短暂下降。但是通过降低置信度阈值并不能解决这个问题，因为仅仅降低置信度阈值又会导致非目标被错误地“框出来”，也就是 false positives。</p> <h3 id=byte>BYTE<a class=headerlink href=#byte title="Permanent link">&para;</a></h3> <blockquote> <p>主流方法都专注于设计更好的数据关联方式。然而本文认为检测框的使用方式决定了数据关联的上限，并且专注于在匹配过程中充分利用从高分到低分的检测框。</p> </blockquote> <p>几乎保留所有检测的边界框，分为高分和低分两类。首先将高分检测框与现有轨迹做关联匹配。发生遮挡、运动模糊或者尺寸改变时，某些轨迹可能找不到对应的匹配。</p> <p>将低分检测框与剩余未匹配的轨迹做匹配。如果低分检测框中有真实目标，则匹配到对应的轨迹，如果没有真实目标，则因为未匹配到轨迹而丢弃。这样就能恢复低分检测框中的目标，同时过滤掉背景。</p> <p>算法框架为：</p> <ol> <li>检测框分组：按置信度阈值 <span class=arithmatex>\(\tau\)</span> 将检测框分为高分组 <span class=arithmatex>\(\mathcal{D}_{high}\)</span> 和低分组 <span class=arithmatex>\(\mathcal{D}_{low}\)</span> .</li> <li>轨迹预测：对每一条轨迹使用卡尔曼滤波预测，得到当前帧的预测框位置。</li> <li>Fisrt Association：对轨迹集合 <span class=arithmatex>\(\mathcal{T}\)</span> 和高分组检测框 <span class=arithmatex>\(\mathcal{D}_{high}\)</span> 做匈牙利算法最优匹配，相似度使用 IoU 距离或者 IoU + ReID。未匹配的轨迹记为 <span class=arithmatex>\(\mathcal{T}_{remain}\)</span> ，未匹配的检测框记为 <span class=arithmatex>\(\mathcal{D}_{remain}\)</span> .</li> <li>Second Association：对 <span class=arithmatex>\(\mathcal{T}_{remain}\)</span> 和 <span class=arithmatex>\(\mathcal{D}_{low}\)</span> 做最优匹配，仅使用 IoU 距离计算代价（因为低置信度框通常外观特征不可靠）。仍未匹配的轨迹记为 <span class=arithmatex>\(\mathcal{T}_{re-remain}\)</span> .</li> <li>删除长期未匹配的轨迹 <span class=arithmatex>\(\mathcal{T}\gets \mathcal{T}\backslash\mathcal{T}_{re-remain}\)</span> ，然后建立新的轨迹 <span class=arithmatex>\(\mathcal{T}\gets \mathcal{T}\cup \mathcal{D}_{remain}\)</span> .</li> <li>为了保留可能临时丢失的目标，将 <span class=arithmatex>\(\mathcal{T}_{re-remain}\)</span> 中的轨迹放入 <span class=arithmatex>\(\mathcal{T}_{lost}\)</span> ，而 <span class=arithmatex>\(\mathcal{T}_{lost}\)</span> 中的每个轨迹存留 30 帧以上才删除它。</li> <li>每一帧的输出是 <span class=arithmatex>\(\mathcal{T}\)</span> 中轨迹的边界框和 ID。</li> </ol> <p><a class=glightbox href=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251030215650.png data-type=image data-width=80% data-height=auto data-desc-position=bottom><img alt=20251030215650 src=https://cdn.jsdelivr.net/gh/DerrickMarcus/picgo-image/images/20251030215650.png></a></p> <p>基于 BYTE 设计出跟踪器：ByteTrack = YOLOX(detector) + BYTE(association)</p> <h3 id=bounding-box-annotations>Bounding Box Annotations<a class=headerlink href=#bounding-box-annotations title="Permanent link">&para;</a></h3> <p>MOT17 数据集中，每个人的边界框覆盖了整个身体，即使他被遮挡或者有部分到了图像之外（边界框也会延伸到图像之外）。但是 YOLOX 默认会把边界框裁剪到图像之内，为避免检测出错，本文修改了 YOLOX 的数据预处理和标签分配策略：</p> <ol> <li>在预处理和数据增强阶段，不在裁剪超出图像的检测框，只删除完全在图像之外的检测框。</li> <li>MOT17 数据集标注中，人的中心点可能在图像之外。YOLOX 的标签分配策略 SimOTA 要求正样本围绕目标中心分布，因此在分配正样本时可能因为中心点超出图像而失效。这种情况下，只把中心点裁到图像内，不裁剪边界框。</li> </ol> <p>MOT20、HiEve 和 BDD100K 数据集的标注，已经将标注的边界框裁剪到图像内，因此无需改动 YOLOX。</p> <h3 id=tracklet-interpolation>Tracklet Interpolation<a class=headerlink href=#tracklet-interpolation title="Permanent link">&para;</a></h3> <p>MOT17 数据集中，有一些被完全遮挡的行人，YOLOX 无法输出他们的检测框。如果某个目标在被检测到的两帧之间被遮挡，可以使用线性插值“找回”中间的几帧。</p> <p>假设某轨迹 <span class=arithmatex>\(T\)</span> 在第 <span class=arithmatex>\(t_1\)</span> 帧的检测框为 <span class=arithmatex>\(B_{t1}\)</span> ，第 <span class=arithmatex>\(t_2\)</span> 帧的检测框为 <span class=arithmatex>\(B_{t2}\)</span> ，插入中间帧：</p> <div class=arithmatex>\[ B_t=B_{t1}+(B_{t2}-B_{t1})\frac{t-t_1}{t_2-t_1}, \quad t_1&lt;t&lt;t_2 \]</div> <p>其中检测框 <span class=arithmatex>\(B_t=[x_{tl},y_{tl},x_{br},y_{br}]\in\mathbb{R}^4\)</span> 代表左上和右下坐标，同时还应该限制遮挡时间不超过最大间隔才进行插值补帧 <span class=arithmatex>\(t_2-t_1&lt;\sigma\)</span> .</p> <h2 id=bot-sort>BoT-SORT<a class=headerlink href=#bot-sort title="Permanent link">&para;</a></h2> <blockquote> <p>[CVPR 2023] BoT-SORT: Robust Associations Multi-Pedestrian Tracking</p> <p>Paper: <a href=https://arxiv.org/abs/2206.14651>https://arxiv.org/abs/2206.14651</a></p> <p>Code: <a href=https://github.com/NirAharon/BoT-SORT>https://github.com/NirAharon/BoT-SORT</a></p> </blockquote> <p>BoT-SORT 把运动信息（Kalman 预测 + IoU）与外观信息（ReID 特征）融合，同时显式做相机运动补偿（CMC），并把 Kalman Filter 的状态向量从传统的“中心+面积+纵横比”改为“中心 + 宽高”，集成到 ByteTrack 中，提出了 BoT-SORT 和 BoT-SORT-ReID 两种跟踪器。两者的主干相同：</p> <ol> <li>基于 ByteTrack 的两阶段匹配（高置信 + 低置信检测）。</li> <li>Kalman Filter 预测更新。</li> <li>相机运动补偿。</li> <li>IoU 匹配 / 门控 / 匈牙利算法</li> <li>轨迹生命周期管理</li> </ol> <p>区别是，在匹配时是否引入 ReID 外观特征。</p> <h3 id=kalman-filter>Kalman Filter<a class=headerlink href=#kalman-filter title="Permanent link">&para;</a></h3> <p>与 SORT、DeepSORT 都不同，BoT-SORT 选定的状态变量为 <span class=arithmatex>\(\boldsymbol{x}=[x,y,w,h,\dot{x},\dot{y},\dot{w},\dot{h}]^T\)</span> ，即二维坐标、宽度高度及其变化量。观测变量为 <span class=arithmatex>\(\boldsymbol{z}=[x,y,w,h]\)</span> .</p> <p>状态转移矩阵和观测矩阵分别为：</p> <div class=arithmatex>\[ \boldsymbol{F}=\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\ \end{pmatrix},\quad \boldsymbol{H}=\begin{pmatrix} 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ \end{pmatrix} \]</div> <p>采用与时间相关的过程噪声和测量噪声：</p> <div class=arithmatex>\[ \begin{align*} \boldsymbol{Q}_k = \text{diag}(&amp;(\sigma_p \hat{w}_{k-1|k-1})^2, (\sigma_p \hat{h}_{k-1|k-1})^2,\\ &amp;(\sigma_p \hat{w}_{k-1|k-1})^2, (\sigma_p \hat{h}_{k-1|k-1})^2,\\ &amp;(\sigma_v \hat{w}_{k-1|k-1})^2, (\sigma_v \hat{h}_{k-1|k-1})^2,\\ &amp;(\sigma_v \hat{w}_{k-1|k-1})^2, (\sigma_v \hat{h}_{k-1|k-1})^2) \\ \boldsymbol{R}_k = \text{diag}(&amp;(\sigma_m \hat{w}_{k|k-1})^2, (\sigma_m \hat{h}_{k|k-1})^2,\\ &amp;(\sigma_m \hat{w}_{k|k-1})^2, (\sigma_m \hat{h}_{k|k-1})^2) \end{align*} \]</div> <p>过程噪声 <span class=arithmatex>\(\boldsymbol{Q}_k\)</span> 和测量噪声 <span class=arithmatex>\(\boldsymbol{R}_k\)</span> 是随边界框尺寸动态变化的对角阵， <span class=arithmatex>\(\sigma_p,\sigma_v,\sigma_m\)</span> 是需要设定的参数。</p> <h3 id=camera-motion-compensation>Camera Motion Compensation<a class=headerlink href=#camera-motion-compensation title="Permanent link">&para;</a></h3> <p>相机本身会运动的场景中，图像中的边界框可能发生显著变化。相机静止时，也可能受到风引起的振动或漂移。在未知相机运动数据（导航、IMU）或者相机内参矩阵时，可以使用相邻帧之间图像配准，近似看作相机运动在图像上的投影。</p> <p>使用 OpenCV 中的全局运动估计（GMC，global motion compensation），这种稀疏配准技术允许忽略场景中动态物体，从而更好地估计背景的运动：</p> <ol> <li>提取图像关键点（keypoints）。</li> <li>使用稀疏光流（sparse optical flow）进行特征跟踪，并对平移分量做阈值处理。</li> <li>使用 RANSAC（Random Sample Consensus 随机抽样一致）估计相邻帧之间的仿射变换 <span class=arithmatex>\(\boldsymbol{A}_{k-1}^k\in\mathbb{R}^{2\times 3}\)</span> .</li> </ol> <div class=arithmatex>\[ \boldsymbol{A}_{k-1}^k=[\boldsymbol{M}_{2\times 2}\mid \boldsymbol{T}_{2\times 1}]= \begin{pmatrix} a_{11} &amp; a_{12} &amp; a_{13} \\ a_{21} &amp; a_{22} &amp; a_{23} \end{pmatrix} \]</div> <p>使用该仿射变换可以预测第 <span class=arithmatex>\(k-1\)</span> 帧的边界框在第 <span class=arithmatex>\(k\)</span> 帧中的位置。其中平移部分 <span class=arithmatex>\(\boldsymbol{T}\)</span> 只影响边界框的中心坐标，不影响宽度、高度和其变化率。而旋转部分 <span class=arithmatex>\(\boldsymbol{M}\)</span> 对状态变量和噪声都有影响，但由于是线性变换，该仿射矩阵也可以同时同等地作用于整个状态变量，因此我们构造矩阵：</p> <div class=arithmatex>\[ \tilde{\boldsymbol{M}}_{k-1}^k=\begin{pmatrix} \boldsymbol{M} &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; \boldsymbol{M} &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; \boldsymbol{M} &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; \boldsymbol{M} \\ \end{pmatrix}\in\mathbb{R}^{8\times 8},\quad \tilde{\boldsymbol{T}}_{k-1}^k=\begin{pmatrix} a_{12} \\ a_{13} \\ 0 \\ \vdots \\ 0 \end{pmatrix}\in\mathbb{R}^8 \]</div> <p>假设我们有了原始 KF 预测的状态变量和协方差 <span class=arithmatex>\(\hat{\boldsymbol{x}}_{k|k-1},\;\boldsymbol{P}_{k|k-1}\)</span> ，补偿后的预测应该修正为：</p> <div class=arithmatex>\[ \begin{align*} \hat{\boldsymbol{x}}'_{k|k-1}&amp;=\tilde{\boldsymbol{M}}_{k-1}^k \hat{\boldsymbol{x}}_{k|k-1}+\tilde{\boldsymbol{T}}_{k-1}^k \\ \boldsymbol{P}'_{k|k-1}&amp;=\tilde{\boldsymbol{M}}_{k-1}^k \boldsymbol{P}_{k|k-1} \left(\tilde{\boldsymbol{M}}_{k-1}^{k}\right)^T \end{align*} \]</div> <p>此结果作为最终的预测值，再与当前检测/观测 <span class=arithmatex>\(\boldsymbol{z}\)</span> 做更新：</p> <div class=arithmatex>\[ \begin{align*} \boldsymbol{K}_k &amp;= \boldsymbol{P}'_{k|k-1} \boldsymbol{H}_k^T \left(\boldsymbol{H}_k \boldsymbol{P}'_{k|k-1} \boldsymbol{H}_k^T + \boldsymbol{R}_k\right)^{-1} \\ \hat{\boldsymbol{x}}_{k|k} &amp;= \hat{\boldsymbol{x}}'_{k|k-1} + \boldsymbol{K}_k \left(\boldsymbol{z}_k - \boldsymbol{H}_k \hat{\boldsymbol{x}}'_{k|k-1}\right) \\ \boldsymbol{P}_{k|k} &amp;= \left(\boldsymbol{I} - \boldsymbol{K}_k \boldsymbol{H}_k\right) \boldsymbol{P}'_{k|k-1} \end{align*} \]</div> <p>相机高速运动场景下，上述运动补偿至关重要。相机缓慢运动时，可忽略对 <span class=arithmatex>\(\boldsymbol{P}_{k|k-1}\)</span> 的补偿。</p> <h3 id=iou-reid-fusion>IoU-ReID Fusion<a class=headerlink href=#iou-reid-fusion title="Permanent link">&para;</a></h3> <p>类似于 DeepSORT，首先采用 FastReID 库的 BoT-SBS 模型（以 ResNeSt-50 主干），提取 128-D 或 256-D 的 embedding 特征嵌入。</p> <p>每一条轨迹（tracklet）维护一个<strong>外观状态</strong> <span class=arithmatex>\(e_i^k\)</span> ，表示第 <span class=arithmatex>\(i\)</span> 条轨迹在第 <span class=arithmatex>\(k\)</span> 帧的平均外观特征，并使用指数滑动平均（EMA，exponential moving average）进行更新：</p> <div class=arithmatex>\[ e_i^k=\alpha e_i^{k-1} +(1-\alpha)f_i^k \]</div> <p>其中 <span class=arithmatex>\(f_i^k\)</span> 为当前帧检测到的边界框对应的 embedding， <span class=arithmatex>\(\alpha=0.9\)</span> 为动量，表示新特征只占 10% 的权重。这样可以平滑 ReID 特征。</p> <p>对每一条轨迹 <span class=arithmatex>\(i\)</span> 的平均外观特征 <span class=arithmatex>\(e_i^k\)</span> 和检测 <span class=arithmatex>\(j\)</span> 的特征 <span class=arithmatex>\(f_j^k\)</span> 计算余弦相似度 <span class=arithmatex>\(d_{i,j}^{\cos}=1-e_i^k\cdot f_j^k\)</span> .</p> <blockquote> <p>不同于 DeepSORT 把 IoU 距离和特征的余弦距离的加权平均作为最终代价，BoT-SORT 采用了更保守的方法：取最小值。</p> </blockquote> <p>首先进行两次阈值处理，得到新的余弦距离：</p> <div class=arithmatex>\[ \hat{d}_{i,j}^{\cos}=\begin{cases} 0.5 \cdot d_{i,j}^{\cos}, &amp; \text{if } (d_{i,j}^{\cos}&lt;\theta_{emb})\wedge (d_{i,j}^{iou}&lt;\theta_{iou})\\ 1, &amp; \text{else} \end{cases} \]</div> <p>若 IoU 和余弦距离都在阈值内，说明重合程度较高，赋予一个更小的距离 <span class=arithmatex>\(0.5 \cdot d_{i,j}^{\cos}\)</span> ，否则直接设为 1，表示不可能匹配。原文中设置参数 <span class=arithmatex>\(\theta_{emb}=0.25,\;\theta_{iou}=0.5\)</span> .</p> <p>最终的代价取最小值 <span class=arithmatex>\(c_{ij}=\min\{d_{i,j}^{iou},\hat{d}_{i,j}^{\cos}\}\)</span> ，这样一来：</p> <ul> <li>如果外观相似且位置相近，则使用更小的那个距离。</li> <li>如果外观和位置有任何一个不可信，则把外观代价设为 1，相当于使用 IoU 位置距离，退化为纯 IoU 匹配。</li> </ul> <h2 id=jde>JDE<a class=headerlink href=#jde title="Permanent link">&para;</a></h2> <h2 id=fairmot>FairMOT<a class=headerlink href=#fairmot title="Permanent link">&para;</a></h2> <div class=footnote> <hr> <ol> <li id=fn:1> <p>[1]吴楚峥.基于深度学习的单目摄像头人员跟踪定位方法研究[D].西安科技大学,2022.DOI:10.27397/d.cnki.gxaku.2022.001665.&#160;<a class=footnote-backref href=#fnref:1 title="Jump back to footnote 1 in the text">&#8617;</a></p> </li> </ol> </div> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_datetime" title="October 31, 2025 15:33:47">2025-10-31 15:33:47</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Created> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_datetime" title="October 30, 2025 17:00:16">2025-10-30 17:00:16</span> </span> <span class=md-source-file__fact> <span class=md-icon title=Contributors> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg> </span> <span>GitHub</span> <nav> <a href=https://github.com/DerrickMarcus class=md-author title=@DerrickMarcus> <img src="https://avatars.githubusercontent.com/u/126176648?v=4&size=72" alt=DerrickMarcus> </a> </nav> </span> </aside> <form class=md-feedback name=feedback hidden> <fieldset> <legend class=md-feedback__title> Was this page helpful? </legend> <div class=md-feedback__inner> <div class=md-feedback__list> <button class="md-feedback__icon md-icon" type=submit title="This page was helpful" data-md-value=1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M5 9v12H1V9zm4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21zm0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03z"/></svg> </button> <button class="md-feedback__icon md-icon" type=submit title="This page could be improved" data-md-value=0> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 15V3h4v12zM15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3zm0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97z"/></svg> </button> </div> <div class=md-feedback__note> <div data-md-value=1 hidden> Thanks for your feedback! </div> <div data-md-value=0 hidden> Thanks for your feedback! </div> </div> </div> </fieldset> </form> <h2 id=__comments>Comments</h2> <script src=https://giscus.app/client.js data-repo=DerrickMarcus/DerrickMarcus.github.io data-repo-id=R_kgDONJUcMw data-category=Announcements data-category-id=DIC_kwDONJUcM84CoUCs data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=1 data-input-position=top data-theme=preferred_color_scheme data-lang=en crossorigin=anonymous async>
    </script> <script>
    var giscus = document.querySelector("script[src*=giscus]")

    // Set palette on initial load
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
        var theme = palette.color.scheme === "slate"
            ? "transparent_dark"
            : "light"

        // Instruct Giscus to set theme
        giscus.setAttribute("data-theme", theme)
    }

    // Register event handlers after documented loaded
    document.addEventListener("DOMContentLoaded", function () {
        var ref = document.querySelector("[data-md-component=palette]")
        ref.addEventListener("change", function () {
            var palette = __md_get("__palette")
            if (palette && typeof palette.color === "object") {
                var theme = palette.color.scheme === "slate"
                    ? "transparent_dark"
                    : "light"

                // Instruct Giscus to change theme
                var frame = document.querySelector(".giscus-frame")
                frame.contentWindow.postMessage(
                    { giscus: { setConfig: { theme } } },
                    "https://giscus.app"
                )
            }
        })
    })
</script> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=object_detection.html class="md-footer__link md-footer__link--prev" aria-label="Previous: Object Detection"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis>Object Detection</div> </div> </a> <a href=gaussian_splatting.html class="md-footer__link md-footer__link--next" aria-label="Next: Gaussian Splatting"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis>Gaussian Splatting</div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024 - 2025 Derrick Marcus </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=footer-visit-count> <span>Site Visits: </span> <script async src=//finicounter.eu.org/finicounter.js></script> <span id=finicount_views></span> <span class=runtime-info> <span>; Site Running for </span> <span id=runtime-in-footer></span> </span> </div> <style>
                .footer-visit-count {
                    display: flex;
                    flex-wrap: wrap;
                    justify-content: center;
                    align-items: center;
                    min-height: 40px;
                    gap: 0.5em;
                }

                @media (max-width: 768px) {
                    .runtime-info {
                        display: none;
                    }

                    .icp-link {
                        display: block;
                        text-align: center;
                    }
                }
            </style> <div class=md-social> <a href=https://github.com/DerrickMarcus target=_blank rel=noopener title="Yanxu Chen on Github" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://space.bilibili.com/627449965 target=_blank rel=noopener title="Yanxu Chen on Bilibili" class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M488.6 104.1c16.7 18.1 24.4 39.7 23.3 65.7v202.4c-.4 26.4-9.2 48.1-26.5 65.1-17.2 17-39.1 25.9-65.5 26.7H92.02c-26.45-.8-48.21-9.8-65.28-27.2C9.682 419.4.767 396.5 0 368.2V169.8c.767-26 9.682-47.6 26.74-65.7C43.81 87.75 65.57 78.77 92.02 78h29.38L96.05 52.19c-5.75-5.73-8.63-13-8.63-21.79 0-8.8 2.88-16.06 8.63-21.797C101.8 2.868 109.1 0 117.9 0q13.2 0 21.9 8.603L213.1 78h88l74.5-69.397C381.7 2.868 389.2 0 398 0q13.2 0 21.9 8.603c5.7 5.737 8.6 12.997 8.6 21.797 0 8.79-2.9 16.06-8.6 21.79L394.6 78h29.3c26.4.77 48 9.75 64.7 26.1m-38.8 69.7c-.4-9.6-3.7-17.4-10.7-23.5-5.2-6.1-14-9.4-22.7-9.8H96.05c-9.59.4-17.45 3.7-23.58 9.8-6.14 6.1-9.4 13.9-9.78 23.5v194.4c0 9.2 3.26 17 9.78 23.5s14.38 9.8 23.58 9.8H416.4c9.2 0 17-3.3 23.3-9.8s9.7-14.3 10.1-23.5zm-264.3 42.7c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2-6.2 6.3-14 9.5-23.6 9.5s-17.5-3.2-23.6-9.5-9.4-14-9.8-23.2v-33.3c.4-9.1 3.8-16.9 10.1-23.2s13.2-9.6 23.3-10c9.2.4 17 3.7 23.3 10m191.5 0c6.3 6.3 9.7 14.1 10.1 23.2V273c-.4 9.2-3.7 16.9-9.8 23.2s-14 9.5-23.6 9.5-17.4-3.2-23.6-9.5c-7-6.3-9.4-14-9.7-23.2v-33.3c.3-9.1 3.7-16.9 10-23.2s14.1-9.6 23.3-10c9.2.4 17 3.7 23.3 10"/></svg> </a> <a href="mailto:<blog@yanxuchen.com>" target=_blank rel=noopener title class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M64 112c-8.8 0-16 7.2-16 16v22.1l172.5 141.6c20.7 17 50.4 17 71.1 0L464 150.1V128c0-8.8-7.2-16-16-16zM48 212.2V384c0 8.8 7.2 16 16 16h384c8.8 0 16-7.2 16-16V212.2L322 328.8c-38.4 31.5-93.7 31.5-132 0zM0 128c0-35.3 28.7-64 64-64h384c35.3 0 64 28.7 64 64v256c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["announce.dismiss", "search.suggest", "search.highlight", "search.share", "navigation.indexes", "navigation.instant", "navigation.instant.progress", "navigation.path", "navigation.tracking", "navigation.top", "navigation.tabs", "navigation.footer", "content.code.annotate", "content.code.copy", "content.code.select", "content.action.view", "content.action.edit", "content.tooltips", "content.footnote.tooltips", "content.tabs.link", "toc.follow"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.c8b220af.min.js></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src=../../javascripts/mathjax.js></script> <script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script> <script src=https://cdn.jsdelivr.net/npm/animejs@latest/lib/anime.min.js></script> <script src=../../javascripts/toc.js></script> <script src=../../javascripts/time.js></script> <script src=../../javascripts/anime.js></script> <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": true, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body> </html>